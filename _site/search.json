{
  "articles": [
    {
      "path": "about.html",
      "title": "MATH 463 Topics In Biomathematics",
      "description": "Course Syllabus\n",
      "author": [],
      "contents": "\n\nContents\nInstructor Information\nCourse Materials:\nRequired Textbook\nAdditional Resources\n\nCourse Information:\nCourse Description\nPrerequisites\nCourse Goals\nStudent\nLearning Objectives and Assessment\n\nCourse Policies and\nProcedures:\nCoronavirus\nDisease Safety Pertaining to the Course\nAttendance\nAssignments and Grading\n\nCourse Timeline:\nImportant Dates\nWeekly Schedule\n\nUniversity Resources\nfor Students:\nStudents with\nDisabilities\nWriting Center Services\nMy\nReporting Obligation as a Responsible Employee\nNon-discrimination\nStatement\n\nAcademic Honesty and\nIntegrity\nFinal Note\n\nInstructor Information\nInstructor: Dr. Jason M. Graham\nOffice: LSC 319A\nOffice Hours: Mondays 10:00 - 11:00 AM and 2:00\n- 3:00 PM, and Wednesdays 10:00 - 11:00 AM (You may also make an\nappointment to meet with me outside of scheduled office hours.\nAppointments are not necessary for regularly scheduled office\nhours.)\nDr. Graham’s Schedule: Link\n\nEmail: jason.graham@scranton.edu\nPhone: (570) 941-7491\nCourse Materials:\nCourse Webpage: Link\nRequired Textbook\nThere is no required text for this course. Students will be provided\nwith detailed notes, handouts, or other references.\nAdditional Resources\nThree very good general references are:\nNonlinear\nDynamics and Chaos 2nd ed. by Steven H. Strogatz, ISBN:\n9780813349107. This book covers most of the mathematical techniques we\nwill use throughout the course.\nLecture\nNotes on Mathematical Systems Biology by Eduardo Sontag.\nMathematical\nModelling in Systems Biology: An Introduction by Brian\nIngalls.\nCourse Information:\nCourse Description\nA study of discrete and continuous mathematical models in biology.\nTopics include: population dynamics of single species and interacting\nspecies, infectious diseases, population genetics, and cell populations\nwith tumor modeling.\nPrerequisites\nThe prerequisites for this course is MATH 341 Differential\nEquations and MATH 351 Linear Algebra. Specifically, the\nstudent is expected to have a knowledge of the theory and applications\nof elementary linear algebra and basic ordinary differential equations\n(ODEs).\nCourse Goals\nStudents will gain college level knowledge in applied\nmathematics.\nStudents will be able to apply mathematics to address real world\nproblems.\nStudents will gain competency in analytical and critical\nreasoning.\nStudents will gain experience in utilizing R to create programs\nand solve problems as appropriate to the discipline of\nBiomathematics.\nStudents will gain experience using \\(\\LaTeX\\) to prepare and revise written\ndocuments as appropriate to the discipline of Biomathematics.\nStudent Learning\nObjectives and Assessment\n\n\nAfter taking this course, the student should be able to:\n\n\nMethods of assessment\n\n\nUse mathematical tools from calculus, differential equations, and linear\nalgebra to analyze foundational mathematical models arising in the life\nsciences.\n\n\nHomework assignments and in-class written exams.\n\n\nInterpret the meaning of mathematical equations or models representing\nvarious biological processes.\n\n\nHomework assignments, model reports, and final project.\n\n\nUtilize computing tools such as R to analyze and interpret data-driven\nmathematical models.\n\n\nHomework assignments, model reports, and final project.\n\n\nCommunicate effectively in writing their work in applying the techniques\nof applied mathematics to problems arising in the life sciences.\n\n\nHomework, model reports, and final project consisting of a written\npaper.\n\n\nLink with\nMathematics Program Learning Outcomes\nThe student learning objectives of this course are linked with the\nMathematics Program Learning Outcome\n“Demonstrate competence in analytical and critical\nreasoning.”\n“Demonstrate college-level knowledge in applied\nmathematics.”\nLink with\nGeneral Education Goals and Objectives\nMATH 463 has been designated an EPW Level II course. In order to\nfulfill the learning objectives for EPW Level II students will be asked\nto complete two writing intensive assignments. These are\na model report assignment,\nand a final project.\nDetails for these assignments are described below and additional\nguidelines are posted on thee course learning management system.\nCourse Policies and\nProcedures:\nCoronavirus\nDisease Safety Pertaining to the Course\nIn consideration of the care and concern for one another and members\nof our community, unless you are reasonably unable to do so, please take\nthe following steps as a student in this course to mitigate the spread\nof coronavirus:\nFollow the Royals\nBack Together protocols for isolation if you have a confirmed case\nof coronavirus disease (COVID-19) .\nDo not attend class if you are experiencing any COVID-19 related\nsymptoms as described at this\nlink.\nFollow the Royals\nBack Together protocols if you believe that you have been exposed to\nthe coronavirus. Please visit this\nlink for more information on the transmission of the\ncoronavirus.\nWear appropriate face covering (i.e., as approved by the\nRoyals\nBack Together plan) over your mouth and nose while indoors.\nAttendance\nClass attendance and active participation in class discussion is\nstrongly encouraged. If absence is necessary, please inform the\ninstructor and develop a plan to make up for missing content as soon as\npossible.\nAssignments and Grading\nGrade Policy\nThe course grade will be based on two in-class exams (totaling 50%\nand evenly distributed), approximately ten weekly homework assignments\n(20%), one model report (10%), and a final project (20%).\nGrade Scale\nLetter grades will be assigned based on the following scale:\n\n\nGrade Range\n\n\nLetter Grade\n\n\n94-100\n\n\nA\n\n\n90-93\n\n\nA-\n\n\n87-89\n\n\nB+\n\n\n83-86\n\n\nB\n\n\n80-82\n\n\nB-\n\n\n76-79\n\n\nC+\n\n\n72-75\n\n\nC\n\n\n69-71\n\n\nC-\n\n\n65-68\n\n\nD+\n\n\n60-64\n\n\nD\n\n\n<60\n\n\nF\n\n\nHomework\nThere will be weekly homework assignments. Assignments will be posted\non the course learning management system and made up of problems\nrelating to or extending the material covered in class discussions.\nWorking problems is essential to learning the material and doing well on\nexams.\nDo not underestimate the value (and joy) of carefully working through\nhomework problems.\nExams\nThe in-class exams are meant to assess 1) students’ understanding of\nthe material covered in class and in homework assignments, 2) students’\nunderstanding of the core concepts, 3) students’ problem solving\nabilities, and 4) students’ ability to think independently. Exam 1 is\nscheduled for March 2, and Exam 2 is scheduled for May 4. In writing the\ntests, I assume that you have been studying the material at least 6\nhours per week outside of class.\nModel Report\nAs part of the required coursework for Topics in\nBiomathematics, students are required to submit a model report. The\ngoal of this assignment is for students to read, understand, assess, and\nexplain modeling results from a recently published paper in\nbiomathematics. The model report will make up 10% of the course grade.\nStudents must submit at least two drafts of a model report. A model\nreport should be three-five typed pages and prepared using \\(\\LaTeX\\) or R Markdown. The first draft is\ndue March 23 and the final draft is due May 4. A set of guidelines for\nthe model report is posted on the course learning management system.\nFinal Project\nIt should be recognized that the mathematical techniques developed in\nclass are applicable in broader situations than can be covered in\nlectures and homework. Thus, students are asked to individually explore\na topic in biomathematics beyond what is covered in lecture by means of\na final project. Final projects should be an 8-12 page manuscript typed\nusing \\(\\LaTeX\\) or R Markdown, and students must\nsubmit at least two drafts of their written final projects. The final\ndraft is due no later than 5:00pm on Wednesday May 18.\nAll written and presented work must be original, explained in your own\nwords, and use proper citation for works referenced.\nA set of guidelines for the final project is posted on the course\nlearning management system. You must choose a topic for your\nfinal project and submit a one to two paragraph description of your\nproposed project along with at least two scholarly references to me no\nlater than 3:00pm on March 2.\nUse of Digital Technology\nWork and research in Biomathematics requires professionals in the\nfield to make use of digital technology. The primary uses of digital\ntechnology in Biomathematics is for producing and importing data,\nscientific computing, visualization of data and model-based simulations,\nand preparing written documents to explain mathematical results. Two of\nthe most commonly used technological tools are R for scientific\ncomputing and \\(\\LaTeX\\) for written\ndocument preparation. Students in this course will be expected to use R,\nand \\(\\LaTeX\\). R can be installed to\nany platform via the downloads available here. R is best used with the\nintegrative development environment RStudio which can be installed from\nhere.\nCourse Timeline:\nImportant Dates\n\n\nEvent\n\n\nDate\n\n\nClasses begin\n\n\nWednesday, January 26\n\n\nLast day to add classes\n\n\nTuesday, February 1\n\n\nLast day for 100% tution refund\n\n\nFriday, February 4\n\n\nLast day to drop with no grade\n\n\nFriday February 25\n\n\nExam 1\n\n\nWednesday, March 2\n\n\nSemester Midpoint\n\n\nFriday, March 11\n\n\nLast day of class before spring break\n\n\nFriday, March 11\n\n\nClasses resume after spring break\n\n\nMonday, March 21\n\n\nLast day to withdraw with W grade\n\n\nWednesday, April 13\n\n\nLast day of class before Easter break\n\n\nWednesday, April 13\n\n\nClasses resume after Easter\n\n\nTuesday, April 19\n\n\nExam 2\n\n\nWednesday, May 4\n\n\nLast day of class\n\n\nFriday, May 13\n\n\nFinal exams begin\n\n\nMonday, May 16\n\n\nFinal exams end\n\n\nFriday, May 20\n\n\nWeekly Schedule\nWeek 1: Introduction to Biomathematics\nWeek 2: Basic Biomathematical Workflow\nWeek 3: Introduction to Mathematical Modeling\nWeek 4: Population Models\nWeek 5: Compartment Models\nWeek 6: SIR Type Models\nWeek 7: Exam 1\nWeek 8: The Chemostat Bio-reactor\nWeek 9: Spring Break\nWeek 10: Functional Forms\nWeek 11: Mass Action and Reaction Kinetics\nWeek 12: Dimensional Analysis\nWeek 13: Phase-Plane Methods\nWeek 14: Mathematical Physiology\nWeek 15: Exam 2\nWeek 16: Additional Topics\nWeek 17: Finals Week\nUniversity Resources for\nStudents:\nStudents with Disabilities\nReasonable academic accommodations may be provided to students who\nsubmit relevant and current documentation of their disability. Students\nare encouraged to contact the Center for Teaching and Learning\nExcellence (CTLE) at disabilityservices@scranton.edu or (570) 941-4038 if\nthey have or think they may have a disability and wish to determine\neligibility for any accommodations. For more information, please visit\nhttp://www.scranton.edu/disabilities.\nWriting Center Services\nThe Writing Center focuses on helping students become better writers.\nConsultants will work one-on-one with students to discuss students’ work\nand provide feedback at any stage of the writing process. Scheduling\nappointments early in the writing progress is encouraged.\nTo meet with a writing consultant, call (570) 941-6147 to schedule an\nappointment, or send an email with your available meeting times, the\ncourse for which you need assistance, and your phone number to: writing-center@scranton.edu. The Writing Center does\noffer online appointments for our distance learning students. Please\ncontact Amye Archer at amye.archer@scranton.edu for more information.\nMy Reporting\nObligation as a Responsible Employee\nAs a faculty member, I am deeply invested in the well-being of each\nstudent I teach. I am here to assist you with your work in this course.\nAdditionally, if you come to me with other non-course-related concerns,\nI will do my best to help. It is important for you to know that all\nfaculty members are required to report incidents of sexual harassment or\nsexual misconduct involving students. This means that I cannot keep\ninformation about sexual harassment, sexual assault, sexual\nexploitation, intimate partner violence or stalking confidential if you\nshare that information with me. I will keep the information as private\nas I can but am required to bring it to the attention of the\nUniversity’s Title IX Coordinator, Elizabeth M. Garcia, or Deputy Title\nIX Coordinator, Christine M. Black, who, in conversation with you, will\nexplain available support, resources, and options. I will not report\nanything to anybody without first letting you know and discussing\nchoices as to how to proceed. The University’s Counseling Center\n(570-941-7620) is available to you as a confidential resource;\ncounselors (in the counseling center) do not have an obligation to\nreport to the Title IX Coordinator.\nNon-discrimination Statement\nThe University is committed to providing an educational, residential,\nand working environment that is free from harassment and discrimination.\nMembers of the University community, applicants for employment or\nadmissions, guests, and visitors have the right to be free from\nharassment or discrimination based on race, color, religion, ancestry,\ngender, sex, pregnancy, sexual orientation, gender identity or\nexpression, age, disability, genetic information, national origin,\nveteran status, or any other status protected by applicable law.\nStudents who believe they have been subject to harassment or\ndiscrimination based on any of the above class of characteristics, or\nexperience sexual harassment, sexual misconduct or gender discrimination\nshould contact Elizabeth M. Garcia, Title IX Coordinator, (570) 941-6645\nelizabeth.garcia2@scranton.edu. The United States\nDepartment of Education’s Office for Civil Rights (OCR) enforces Title\nIX. Information regarding OCR may be found at https://www.ed.gov/about/offices/list/ocr/index.html.\nThe University of Scranton Sexual Harassment and Sexual Misconduct\nPolicy can be found online at https://www.scranton.edu/diversity. All reporting\noptions and resources are available at https://www.scranton.edu/CARE.\nAbout Pronouns\nIt is easy to make assumptions about what pronouns people prefer, but\nwe try not to! Please tell us in class or via a private email if you\nwould like to let us know what your pronouns are, if/when you would like\nus (and others) to use them, and certainly feel free to correct us or\nothers if we make a mistake. Using the pronouns that a person has\nindicated they prefer is considered both professional and polite, and as\nsuch we ask that all members of our class use the appropriate\npronouns.\nIf you have questions about this, please feel free to look up more\ninformation here (https://www.mypronouns.org/) or email jason.graham@scranton.edu with any questions.\nAcademic Honesty and\nIntegrity\nEach student is expected to do their own work. It is also expected\nthat each student respect and abide by the Academic Code of Honesty as\nset forth in the University of Scranton student handbook. Conduct that\nviolates the Academic Code of Honesty includes plagiarism, duplicate\nsubmission of the same work, collusion, providing false information,\nunauthorized use of computers, theft and destruction of property, and\nunauthorized possession of tests and other materials. Steps taken in\nresponse to suspected violations may include a discussion with the\ninstructor, an informal meeting with the dean of the college, and a\nhearing before the Academic Dishonesty Hearing Board. Students who are\nfound to have violated the Code will ordinarily be assigned the grade F\nby the instructor and may face other sanctions. The complete Academic\nCode of Honesty is located on the University website at https://www.scranton.edu/academics/wml/acad-integ/acad-code-honesty.shtml.\nFinal Note\nThe instructor reserves the right to modify this syllabus; students\nwill immediately be notified of any such changes and an updated syllabus\nwill be made available to the class via the course learning management\nsystem.\n\n\n\n",
      "last_modified": "2022-03-05T14:27:40-05:00"
    },
    {
      "path": "case_study_01.html",
      "title": "Case Study 1: How do honeybees agree?",
      "description": "A case study in mathematical modeling in biomathematics on honeybee nest-site selection. \n",
      "author": [
        {
          "name": "Jason M. Graham",
          "url": "https://topicsinbiomath.netlify.app/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\nContents\nIntroduction\nBackground\nMathematical Modeling\nIndirect Switching\nDirect Switching\nImplementing Time of\nInfluence\nShiny Implementations\n\nConclusion\n\nIntroduction\nThis notebook presents a case study in order to demonstrate and\nsynthesize concepts and methods covered in Topics in\nBiomathematics. You can also view this as a scaled-down example of\na model report. This particular case study deals with the question of\nwhat are some of the behavioral mechanisms involved in nest-site\nselection by honeybees. As we will see, one can adapt the SIR\napproach to modeling the spread of an infectious disease to gain insight\ninto how honeybees come to agree upon a nest-site when given a choice\nbetween multiple sites.\nBackground\nHoneybees are social insects, they live as collectives in colonies\nand their social lives involve making collective decisions. Further, the\nresults of collective decision-making impact the fitness of the insects.\nThere is much we could discuss regarding collective decision-making\n(see, e.g., (Sumpter 2010)), but for our purposes\nhere it is most relevant to point out that in some cases, collective\ndecisions must be dissent-free. In such cases, the\nentire collective comes to an agreement, it is all or nothing. This is\nin contrast to situations in which the best strategy for maintaining or\nincreasing fitness is to keep several options open.\nAn example of dissent-free collective decision-making is in nest-site\nselection by honeybees. The way this typically works is that a number of\nscouts will individually go out in search of a site. Once a scout\nencounters a potentially viable location, they assess the quality of the\nsite. If the scout determines the site is particularly good, they will\nexpress their enthusiasm for the location by a physical display known as\na dance.\nThis communicates to the other members of the collective that there is a\ngood nest-site option. The question is, given options for two or more\nnest-sites, how is a single one chosen? This question is taken up in\n(Britton et al.\n2002) where the authors use mathematical modeling to gain\ninsight into the problem.\nAs is pointed out in the paper, there are two sources of feedback\nthat need to be considered in addressing the honeybee nest-site\nselection question. These are\nthe intensity of the dance of a honeybee decreases and an\nindividual will eventually stop dancing perhaps even before a decision\nis made, and\nsome scouts change their site-preference.\nThus, a mathematical model that attempts to represent nest-site\nselection must take into account not only competing advertisement but\nalso these sources of feedback.\nMathematical Modeling\nHow should the nest-site selection be modeled mathematically? In\n(Britton et al.\n2002), the authors follow (Karmeshu and\nPathria 1980) and treat the problem from the perspective of\nspread of information. The perspective taken is that information spreads\nanalogously to the spread of an infectious disease. As we know, the\nspread of an infectious disease can be modeled via SIR type models which\nin turn can be viewed as compartment models.\nIn modeling we focus on the situation where there are two possible\nnest-sites so that bees need to decide based on competing information\nabout just two options. In order to proceed, we will describe the\ncompartments relevant for a mathematical model, these are the quantities\nthat will change with time. These are\nundecided (neutral) bees\nbees in favor of and advertising for site 1\nbees in favor of site 1 but not actively advertising\nbees in favor of and advertising for site 2\nbees in favor of site 2 but not actively advertising\nThere is one further point to make relevant for developing a\nmathematical model for honeybee nest-site selection. This is that there\nare multiple ways in which a bee may change its allegiance for one site\nover another. Specifically, we have either\nIndirect switching in which a bee in favor of\nsite \\(i\\) but not actively advertising\nfor \\(i\\) returns to the neutral state\nbefore then deciding to advertise for site \\(j\\) instead.\nDirect switching in which a bee in favor of site\n\\(i\\) but not actively advertising for\n\\(i\\) moves directly to advertising for\nsite \\(j\\) instead.\nModel Notation\nLet\n\\(X(t)\\) denote the number of\nundecided bees at time \\(t\\),\n\\(Y_{1}(t)\\) denote the number\nof bees actively dancing for site 1 at time \\(t\\),\n\\(Y_{2}(t)\\) denote the number\nof bees actively dancing for site 2 at time \\(t\\),\n\\(Z_{1}(t)\\) denote the number\nof bees in favor of but not actively dancing for site 1 at time \\(t\\), and\n\\(Z_{2}(t)\\) denote the number\nof bees in favor of but not actively dancing for site 2 at time \\(t\\).\nNow we introduce the mathematical model and results for each of the\nindirect and direct switching cases one at a time.\nIndirect Switching\nAn appropriate compartment diagram for the indirect switching model\nis represented by the following graph:\n\n\nShow code\n\na_graph <-\n  create_graph() %>%\n  add_n_nodes(n=5,label = c(\"X\",\"Y1\",\"Y2\",\"Z1\",\"Z2\"),\n              node_aes = node_aes(shape=\"rectangle\",color = \"black\")) %>%\n  add_edges_w_string(edges = \"1->2 1->3 2->4 3->5 4->2 4->1 5->3 5->1\") %>%\n  select_edges_by_edge_id(edges = 1:8) %>%\n  set_edge_attrs_ws(\n    edge_attr = color,\n    value = \"black\")\n\n\nrender_graph(a_graph, layout = \"nicely\")\n\n\n\n{\"x\":{\"diagram\":\"digraph {\\n\\ngraph [layout = \\\"neato\\\",\\n       outputorder = \\\"edgesfirst\\\",\\n       bgcolor = \\\"white\\\"]\\n\\nnode [fontname = \\\"Helvetica\\\",\\n      fontsize = \\\"10\\\",\\n      shape = \\\"circle\\\",\\n      fixedsize = \\\"true\\\",\\n      width = \\\"0.5\\\",\\n      style = \\\"filled\\\",\\n      fillcolor = \\\"aliceblue\\\",\\n      color = \\\"gray70\\\",\\n      fontcolor = \\\"gray50\\\"]\\n\\nedge [fontname = \\\"Helvetica\\\",\\n     fontsize = \\\"8\\\",\\n     len = \\\"1.5\\\",\\n     color = \\\"gray80\\\",\\n     arrowsize = \\\"0.5\\\"]\\n\\n  \\\"1\\\" [label = \\\"X\\\", shape = \\\"rectangle\\\", color = \\\"black\\\", fillcolor = \\\"#F0F8FF\\\", fontcolor = \\\"#000000\\\", pos = \\\"3.4150444326297,5.02995821268624!\\\"] \\n  \\\"2\\\" [label = \\\"Y1\\\", shape = \\\"rectangle\\\", color = \\\"black\\\", fillcolor = \\\"#F0F8FF\\\", fontcolor = \\\"#000000\\\", pos = \\\"2.23069161288346,5.4957196334162!\\\"] \\n  \\\"3\\\" [label = \\\"Y2\\\", shape = \\\"rectangle\\\", color = \\\"black\\\", fillcolor = \\\"#F0F8FF\\\", fontcolor = \\\"#000000\\\", pos = \\\"4.59996128522604,4.56327150865024!\\\"] \\n  \\\"4\\\" [label = \\\"Z1\\\", shape = \\\"rectangle\\\", color = \\\"black\\\", fillcolor = \\\"#F0F8FF\\\", fontcolor = \\\"#000000\\\", pos = \\\"2.17808100827143,4.72712052056762!\\\"] \\n  \\\"5\\\" [label = \\\"Z2\\\", shape = \\\"rectangle\\\", color = \\\"black\\\", fillcolor = \\\"#F0F8FF\\\", fontcolor = \\\"#000000\\\", pos = \\\"4.65629763427988,5.32624724788768!\\\"] \\n\\\"1\\\"->\\\"2\\\" [color = \\\"black\\\"] \\n\\\"1\\\"->\\\"3\\\" [color = \\\"black\\\"] \\n\\\"2\\\"->\\\"4\\\" [color = \\\"black\\\"] \\n\\\"3\\\"->\\\"5\\\" [color = \\\"black\\\"] \\n\\\"4\\\"->\\\"2\\\" [color = \\\"black\\\"] \\n\\\"4\\\"->\\\"1\\\" [color = \\\"black\\\"] \\n\\\"5\\\"->\\\"3\\\" [color = \\\"black\\\"] \\n\\\"5\\\"->\\\"1\\\" [color = \\\"black\\\"] \\n}\",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}\nThe corresponding model equations are\n\\[\n\\begin{align*}\n\\frac{d}{dt}X     &= -\\beta_{1}XY_{1} - \\beta_{2}XY_{2} + \\lambda\nZ_{1} + \\lambda Z_{2} \\\\\n\\frac{d}{dt}Y_{1} &= \\beta_{1}XY_{1} - \\gamma Y_{1} + \\delta\n\\beta_{1}Y_{1}Z_{1} \\\\\n\\frac{d}{dt}Y_{2} &= \\beta_{2}XY_{2} - \\gamma Y_{2} + \\delta\n\\beta_{2}Y_{2}Z_{2} \\\\\n\\frac{d}{dt}Z_{1} &= \\gamma Y_{1} - \\lambda Z_{1} - \\delta \\beta_{1}\nY_{1} Z_{1}\\\\\n\\frac{d}{dt}Z_{2} &= \\gamma Y_{2} - \\lambda Z_{2} - \\delta\n\\beta_{2}Y_{2}Z_{2}\n\\end{align*}\n\\]\nWe would like to explore the model dynamics and interpret results in\nthe context of the honeybee nest-site decision problem. First, some\nparameter values will be fixed while others will be allowed to vary in\norder to simulate different scenarios. The following table lists the\nparameters and their values, noting in cases when parameter values will\nbe varied.\n\n\nTable 1: Parameter values for indirect switching model.\n\n\nParameter\n\n\nValue\n\n\n\\(\\beta_{1}\\)\n\n\n0.6\n\n\n\\(\\beta_{2}\\)\n\n\nvaries\n\n\n\\(\\gamma\\)\n\n\n0.3\n\n\n\\(\\delta\\)\n\n\n0.5\n\n\n\\(\\lambda\\)\n\n\n0.3\n\n\nWe will explore the model dynamics using numerical approximations for\nsolutions to the model equations. The following code implements the\nequations in R.\n\n\nShow code\n\nindirect_sys <- function(t,state,parameters){\n  with(as.list(c(state,parameters)),{\n    \n    dX  <- -b1*X*Y1 - b2*X*Y2 + l*Z1 + l*Z2\n    dY1 <- b1*X*Y1 - g*Y1 + d*b1*Y1*Z1\n    dY2 <- b2*X*Y2 - g*Y2 + d*b2*Y2*Z2\n    dZ1 <- g*Y1 - l*Z1 - d*b1*Y1*Z1\n    dZ2 <- g*Y2 - l*Z2 - d*b2*Y2*Z2\n    \n    return(list(c(dX,dY1,dY2,dZ1,dZ2)))\n    \n  })\n  \n}\n\n\n\nWe illustrate one possibility for the dynamics in the case where\n\\(\\beta_{2}=0.5\\). This means that site\n2 is inferior in quality relative to site 1. Denote by \\(N\\) the total colony population. After\nsolving the equations, we plot the proportion of bees in favor of site 1\n(\\(\\frac{Y_{1}+Z_{1}}{N}\\)) as a\nfunction of time together with the proportion of bees in favor of site 1\n(\\(\\frac{Y_{2}+Z_{2}}{N}\\)) as a\nfunction of time.\n\n\nShow code\n\ntimes <- seq(0,100,by=0.1)\nstate <- c(X=0.7,Y1=0.15,Y2=0.15,Z1=0,Z2=0)\nparameters <- c(b1=0.6,b2=0.5,l=0.3,g=0.3,d=0.5)\nindirect_sol <- ode(y=state,times=times,func=indirect_sys,parms=parameters)\n\nindirect_sol_df <- indirect_sol %>% data.frame() %>% as_tibble() %>% mutate(support_site_1=Y1+Z1,support_site_2=Y2+Z2)\n\nindirect_sol_df %>% \n  pivot_longer(c(support_site_1,support_site_2),\n               names_to = \"site\",values_to=\"proportion\") %>%\n  ggplot(aes(x=time,y=proportion,color=site)) + \n  geom_line(lwd=1) + ylim(c(0,1))\n\n\n\n\nWe see that in the long run, the decision of the colony is to agree\nupon selection of site 1. Of course, this is not the only possible\noutcome. The outcome will generally depend on the initial conditions and\nthe particular parameter value(s) used. Later, we will return to this\nissue by using a Shiny web app\nthat will allow us to easily visualize the results of varying initial\nconditions and parameters. First, let us look at the direct switching\nmodel.\nDirect Switching\nAn appropriate compartment diagram for the direct switching model is\nrepresented by the following graph:\n\n\nShow code\n\nb_graph <-\n  create_graph() %>%\n  add_n_nodes(n=5,label = c(\"X\",\"Y1\",\"Y2\",\"Z1\",\"Z2\"),\n              node_aes = node_aes(shape=\"rectangle\",color = \"black\")) %>%\n  add_edges_w_string(edges = \"1->2 1->3 2->4 3->5 4->2 4->3 5->3 5->2\") %>%\n  select_edges_by_edge_id(edges = 1:8) %>%\n  set_edge_attrs_ws(\n    edge_attr = color,\n    value = \"black\")\n\nrender_graph(b_graph, layout = \"cricle\")\n\n\n\n{\"x\":{\"diagram\":\"digraph {\\n\\ngraph [layout = \\\"neato\\\",\\n       outputorder = \\\"edgesfirst\\\",\\n       bgcolor = \\\"white\\\"]\\n\\nnode [fontname = \\\"Helvetica\\\",\\n      fontsize = \\\"10\\\",\\n      shape = \\\"circle\\\",\\n      fixedsize = \\\"true\\\",\\n      width = \\\"0.5\\\",\\n      style = \\\"filled\\\",\\n      fillcolor = \\\"aliceblue\\\",\\n      color = \\\"gray70\\\",\\n      fontcolor = \\\"gray50\\\"]\\n\\nedge [fontname = \\\"Helvetica\\\",\\n     fontsize = \\\"8\\\",\\n     len = \\\"1.5\\\",\\n     color = \\\"gray80\\\",\\n     arrowsize = \\\"0.5\\\"]\\n\\n  \\\"1\\\" [label = \\\"X\\\", shape = \\\"rectangle\\\", color = \\\"black\\\", fillcolor = \\\"#F0F8FF\\\", fontcolor = \\\"#000000\\\"] \\n  \\\"2\\\" [label = \\\"Y1\\\", shape = \\\"rectangle\\\", color = \\\"black\\\", fillcolor = \\\"#F0F8FF\\\", fontcolor = \\\"#000000\\\"] \\n  \\\"3\\\" [label = \\\"Y2\\\", shape = \\\"rectangle\\\", color = \\\"black\\\", fillcolor = \\\"#F0F8FF\\\", fontcolor = \\\"#000000\\\"] \\n  \\\"4\\\" [label = \\\"Z1\\\", shape = \\\"rectangle\\\", color = \\\"black\\\", fillcolor = \\\"#F0F8FF\\\", fontcolor = \\\"#000000\\\"] \\n  \\\"5\\\" [label = \\\"Z2\\\", shape = \\\"rectangle\\\", color = \\\"black\\\", fillcolor = \\\"#F0F8FF\\\", fontcolor = \\\"#000000\\\"] \\n\\\"1\\\"->\\\"2\\\" [color = \\\"black\\\"] \\n\\\"1\\\"->\\\"3\\\" [color = \\\"black\\\"] \\n\\\"2\\\"->\\\"4\\\" [color = \\\"black\\\"] \\n\\\"3\\\"->\\\"5\\\" [color = \\\"black\\\"] \\n\\\"4\\\"->\\\"2\\\" [color = \\\"black\\\"] \\n\\\"4\\\"->\\\"3\\\" [color = \\\"black\\\"] \\n\\\"5\\\"->\\\"3\\\" [color = \\\"black\\\"] \\n\\\"5\\\"->\\\"2\\\" [color = \\\"black\\\"] \\n}\",\"config\":{\"engine\":\"dot\",\"options\":null}},\"evals\":[],\"jsHooks\":[]}\nThe corresponding model equations are\n\\[\n\\begin{align*}\n\\frac{d}{dt}X     &= -\\beta_{1}XY_{1} - \\beta_{2}XY_{2} \\\\\n\\frac{d}{dt}Y_{1} &= \\beta_{1}XY_{1} - \\gamma Y_{1} + \\delta\n\\beta_{1}Y_{1}Z_{1} + \\alpha \\beta_{1} Y_{1} Z_{2} \\\\\n\\frac{d}{dt}Y_{2} &= \\beta_{2}XY_{2} - \\gamma Y_{2} + \\delta\n\\beta_{2}Y_{2}Z_{2} + \\alpha \\beta_{2} Y_{2} Z_{1} \\\\\n\\frac{d}{dt}Z_{1} &= \\gamma Y_{1} - \\delta \\beta_{1}Y_{1} Z_{1} -\n\\alpha \\beta_{2} Y_{2}Z_{1}\\\\\n\\frac{d}{dt}Z_{2} &= \\gamma Y_{2} - \\delta \\beta_{2}Y_{2}Z_{2} -\n\\alpha \\beta_{1} Y_{1} Z_{2}\n\\end{align*}\n\\]\nAs in the case of the indirect switching model, we present a table\nthat lists the parameters for the direct switching model and their\nvalues, noting in cases when parameter values will be varied.\n\n\nShow code\n\ndf2 <- tibble(`Parameter`=c(\"$\\\\beta_{1}$\",\"$\\\\beta_{2}$\",\"$\\\\gamma$\",\"$\\\\delta$\",\"$\\\\alpha$\"),\n             `Value`=c(\"1.0\",\"varies\",\"0.3\",\"0.5\", \"varies\"))\n\nkbl(df2, booktabs=TRUE, align = \"c\",caption = 'Parameter values for direct switching model.', escape = FALSE) %>%\nkable_styling(position = \"center\")\n\n\n\nTable 2: Parameter values for direct switching model.\n\n\nParameter\n\n\nValue\n\n\n\\(\\beta_{1}\\)\n\n\n1.0\n\n\n\\(\\beta_{2}\\)\n\n\nvaries\n\n\n\\(\\gamma\\)\n\n\n0.3\n\n\n\\(\\delta\\)\n\n\n0.5\n\n\n\\(\\alpha\\)\n\n\nvaries\n\n\nThe following R code implements the direct switching model\nequations.\n\n\nShow code\n\ndirect_sys <- function(t,state,parameters){\n  with(as.list(c(state,parameters)),{\n    \n    dX  <- -b1*X*Y1 - b2*X*Y2\n    dY1 <- b1*X*Y1 - g*Y1 + d*b1*Y1*Z1 + a*b1*Y1*Z2\n    dY2 <- b2*X*Y2 - g*Y2 + d*b2*Y2*Z2 + a*b2*Y2*Z1\n    dZ1 <- g*Y1 - d*b1*Y1*Z1 - a*b2*Y2*Z1\n    dZ2 <- g*Y2 - d*b2*Y2*Z2 - a*b1*Y1*Z2\n    \n    return(list(c(dX,dY1,dY2,dZ1,dZ2)))\n    \n  })\n  \n}\n\n\n\nWe illustrate one possibility for the dynamics in the case where\n\\(\\beta_{2}=1.2\\) and \\(\\alpha=0.2\\). This means that site 2 is\nsuperior in quality relative to site 1. Again, denote by \\(N\\) the total colony population. After\nsolving the equations, we plot the proportion of bees in favor of site 1\n(\\(\\frac{Y_{1}+Z_{1}}{N}\\)) as a\nfunction of time together with the proportion of bees in favor of site 1\n(\\(\\frac{Y_{2}+Z_{2}}{N}\\)) as a\nfunction of time.\n\n\nShow code\n\ntimes <- seq(0,100,by=0.1)\nstate <- c(X=0.7,Y1=0.15,Y2=0.15,Z1=0,Z2=0)\nparameters <- c(b1=1.0,b2=1.2,a=0.2,g=0.3,d=0.5)\ndirect_sol <- ode(y=state,times=times,func=direct_sys,parms=parameters)\n\ndirect_sol_df <- direct_sol %>% data.frame() %>% as_tibble() %>% mutate(support_site_1=Y1+Z1,support_site_2=Y2+Z2)\n\ndirect_sol_df %>% \n  pivot_longer(c(support_site_1,support_site_2),\n               names_to = \"site\",values_to=\"proportion\") %>%\n  ggplot(aes(x=time,y=proportion,color=site)) + \n  geom_line(lwd=1) + ylim(c(0,1))\n\n\n\n\nWe see that in the long run, the decision of the colony is to agree\nupon selection of site 2. As with the indirect model, this is not the\nonly possible outcome and we will examine more to do with this\nlater.\nThere is another aspect to understanding the nest-site selection\nproblem that is discussed in the paper (Britton et al. 2002) that we have yet to\ntouch upon. That is, how does the timing of when information about the\nquality of a potential nest-site is received come into play? For\nexample, could it be that even if one nest-site is a much greater\nquality than another, it is not selected because it is advertised much\nlater than another poorer quality nest-site? We can use our existing\nmodel frameworks to explore this by simply adding a delay effect. In\nfact, this is done in the paper (Britton et al. 2002). The code in the\nnext section makes the necessary modifications to incorporate the\ntime-delay effect.\nImplementing Time of\nInfluence\nIn this section, we introduce minor modifications to the R\nimplementations of the indirect and direct switching models. Now, there\nis an additional parameter \\(t_{i}\\)\nthat represents the amount of time that passes before information about\nsite 2 arrives to the bees that are not in favor of site 2. This will\nfacilitate addressing questions such as could it be that even if one\nnest-site is a much greater quality than another, it is not selected\nbecause it is advertised much later than another poorer quality\nnest-site?\nWhile we show a couple of example simulations based on the modified\nmodels, it is better to explore the dynamics that result from the\nmodification in an interactive fashion via Shiny apps. This will be\ntaken up in the next section.\nIndirect\n\n\nShow code\n\nindirect_sys <- function(t,state,parameters){\n  with(as.list(c(state,parameters)),{\n    \n    dX  <- -b1*X*Y1 - b2*X*Y2 + l*Z1 + l*Z2\n    dY1 <- b1*X*Y1 - g*Y1 + d*b1*Y1*Z1\n    dZ1 <- g*Y1 - l*Z1 - d*b1*Y1*Z1\n    if (t < t_i){\n      dY2 <- 0.0\n      dZ2 <- 0.0\n    }else{\n      dY2 <- b2*X*Y2 - g*Y2 + d*b2*Y2*Z2\n      dZ2 <- g*Y2 - l*Z2 - d*b2*Y2*Z2  \n    }\n    \n    \n    return(list(c(dX,dY1,dY2,dZ1,dZ2)))\n    \n  })\n  \n}\n\n\n\n\n\nShow code\n\ntimes <- seq(0,100,by=0.1)\nstate <- c(X=0.9,Y1=0.08,Y2=0.02,Z1=0,Z2=0)\nparameters <- c(b1=0.6,b2=0.7,l=0.3,g=0.3,d=0.5,t_i=5.0)\nindirect_sol <- ode(y=state,times=times,func=indirect_sys,parms=parameters)\n\n\nindirect_sol_df <- indirect_sol %>% data.frame() %>% as_tibble() %>% mutate(support_site_1=Y1+Z1,support_site_2=Y2+Z2)\n\nindirect_sol_df %>% \n  pivot_longer(c(support_site_1,support_site_2),\n               names_to = \"site\",values_to=\"proportion\") %>%\n  ggplot(aes(x=time,y=proportion,color=site)) + \n  geom_line(lwd=1) + ylim(c(0,1))\n\n\n\n\nDirect\n\n\nShow code\n\ndirect_sys <- function(t,state,parameters){\n  with(as.list(c(state,parameters)),{\n    \n    dX  <- -b1*X*Y1 - b2*X*Y2\n    dY1 <- b1*X*Y1 - g*Y1 + d*b1*Y1*Z1 + a*b1*Y1*Z2\n    dZ1 <- g*Y1 - d*b1*Y1*Z1 - a*b2*Y2*Z1\n    if (t < t_i){\n      dY2 <- 0.0\n      dZ2 <- 0.0\n    }else{\n      dY2 <- b2*X*Y2 - g*Y2 + d*b2*Y2*Z2 + a*b2*Y2*Z1\n      dZ2 <- g*Y2 - d*b2*Y2*Z2 - a*b1*Y1*Z2  \n    }\n    \n    return(list(c(dX,dY1,dY2,dZ1,dZ2)))\n    \n  })\n  \n}\n\ntimes <- seq(0,100,by=0.1)\nstate <- c(X=0.7,Y1=0.15,Y2=0.15,Z1=0,Z2=0)\nparameters <- c(b1=1.0,b2=1.2,a=0.2,g=0.3,d=0.5,t_i=5.0)\ndirect_sol <- ode(y=state,times=times,func=direct_sys,parms=parameters)\n\n\n\n\n\nShow code\n\ndirect_sol_df <- direct_sol %>% data.frame() %>% as_tibble() %>% mutate(support_site_1=Y1+Z1,support_site_2=Y2+Z2)\n\ndirect_sol_df %>% \n  pivot_longer(c(support_site_1,support_site_2),\n               names_to = \"site\",values_to=\"proportion\") %>%\n  ggplot(aes(x=time,y=proportion,color=site)) + \n  geom_line(lwd=1) + ylim(c(0,1))\n\n\n\n\nShiny Implementations\nShiny is an R package that\nenables one to easily create interactive web applications that run R\ncode and visualizations. To learn more about shiny we recommend the book\nMastering Shiny. For our\npurposes, we want to use shiny to see how the dynamics of our indirect\nand direct switching models can change as the parameters are varied. The\ncode for the shiny implementations is given together with links where\nyou can access the resulting apps. You can also copy and run the\nprovided code on your own computer.\nIndirect Model\n\n\nShow code\n\nserver <- function(input, output) {\n  output$indirect <- renderPlot({\n    state <- c(X=input$X,Y1=input$Y1,Y2=input$Y2,Z1=0,Z2=0)\n    parameters <- c(b1=0.6,b2=input$b2,l=0.3,g=0.3,d=0.5,t_i=input$t_i)\n    times <- seq(0,100,by=0.1)\n    indirect_sol <- ode(y=state,times=times,func=indirect_sys,parms=parameters)\n    indirect_sol_df <- indirect_sol %>% \n      data.frame() %>% as_tibble() %>% \n      mutate(support_site_1=Y1+Z1,support_site_2=Y2+Z2)\n    \n    indirect_sol_df %>% \n      pivot_longer(c(support_site_1,support_site_2),\n                   names_to = \"site\",values_to=\"proportion\") %>%\n      ggplot(aes(x=time,y=proportion,color=site)) + \n      geom_line(lwd=1) + ylim(c(0,1)) + theme(text = element_text(size = 18))\n  })\n}\n\nui <- fluidPage(\n  headerPanel(\"Indirect Switching\"),\n  sidebarLayout(\n    sidebarPanel(\n      h3(\"Initial values\"),\n      numericInput(\"X\", label = \"X\",\n                   min = 0.0, max = 1,  value = 0.7, step = 0.01, width=100),\n      numericInput(\"Y1\", label = \"Y1\",\n                   min = 0.0, max = 1,  value = 0.15, step = 0.01, width=100),\n      numericInput(\"Y2\", label = \"Y2\",\n                   min = 0.0, max = 1,  value = 0.15, step = 0.01, width=100),\n      \n      h3(\"Parameters\"),\n      numericInput(\"b2\", label = \"b2\",\n                   min = 0.0, max = 1,  value = 0.5, step = 0.01, width=100),\n      numericInput(\"t_i\", label = \"t_i\",\n                   min = 0.0, max = 10,  value = 0.0, step = 0.1, width=100)\n    ),\n    mainPanel(\n      h3(\"Simulation results\"),\n      plotOutput(\"indirect\")\n    )\n  )\n)\n\nshinyApp(ui = ui, server = server)\n\n\n\nThe indirect model Shiny app is running here.\nDirect Model\n\n\nShow code\n\nserver <- function(input, output) {\n  output$direct <- renderPlot({\n    state <- c(X=input$X,Y1=input$Y1,Y2=input$Y2,Z1=0,Z2=0)\n    parameters <- c(b1=1.0,b2=input$b2,a=input$a,g=0.3,d=0.5,t_i=input$t_i)\n    times <- seq(0,100,by=0.1)\n    direct_sol <- ode(y=state,times=times,func=direct_sys,parms=parameters)\n    direct_sol_df <- direct_sol %>% \n      data.frame() %>% as_tibble() %>% \n      mutate(support_site_1=Y1+Z1,support_site_2=Y2+Z2)\n    \n    direct_sol_df %>% \n      pivot_longer(c(support_site_1,support_site_2),\n                   names_to = \"site\",values_to=\"proportion\") %>%\n      ggplot(aes(x=time,y=proportion,color=site)) + \n      geom_line(lwd=1) + ylim(c(0,1)) + theme(text = element_text(size = 18))\n  })\n}\n\nui <- fluidPage(\n  headerPanel(\"Direct Switching\"),\n  sidebarLayout(\n    sidebarPanel(\n      h3(\"Initial values\"),\n      numericInput(\"X\", label = \"X\",\n                   min = 0.0, max = 1,  value = 0.7, step = 0.01, width=100),\n      numericInput(\"Y1\", label = \"Y1\",\n                   min = 0.0, max = 1,  value = 0.15, step = 0.01, width=100),\n      numericInput(\"Y2\", label = \"Y2\",\n                   min = 0.0, max = 1,  value = 0.15, step = 0.01, width=100),\n      \n      h3(\"Parameters\"),\n      numericInput(\"b2\", label = \"b2\",\n                   min = 0.0, max = 3,  value = 1.2, step = 0.05, width=100),\n      numericInput(\"a\", label = \"a\",\n                   min = 0.0, max = 1,  value = 0.2, step = 0.01, width=100),\n      numericInput(\"t_i\", label = \"t_i\",\n                   min = 0.0, max = 10,  value = 5.0, step = 0.1, width=100)\n    ),\n    mainPanel(\n      h3(\"Simulation results\"),\n      plotOutput(\"direct\")\n    )\n  )\n)\n\nshinyApp(ui = ui, server = server)\n\n\n\nThe direct model Shiny app is running here.\nConclusion\nWe’ve described and reproduced the model and results on honeybee\nnest-site selection from the paper (Britton et al. 2002).\n\n\n\nBritton, Nick F, Nigel R Franks, Stephen C Pratt, and Thomas D Seeley.\n2002. “Deciding on a New Home: How Do Honeybees Agree?”\nProceedings of the Royal Society of London. Series B: Biological\nSciences 269 (1498): 1383–88.\n\n\nKarmeshu, and RK Pathria. 1980. “Stochastic Evolution of Competing\nSocial Groups.” Journal of Mathematical Sociology 7 (1):\n47–58.\n\n\nSumpter, David JT. 2010. Collective Animal Behavior. Princeton\nUniversity Press.\n\n\n\n\n",
      "last_modified": "2022-03-05T14:27:51-05:00"
    },
    {
      "path": "course_blog.html",
      "title": "Course Blog",
      "author": [],
      "contents": "\n\n\n\n",
      "last_modified": "2022-03-05T14:27:52-05:00"
    },
    {
      "path": "index.html",
      "title": "Topics in Biomathematics",
      "description": "Welcome to the website for MATH 463 Topics in Biomathematics!\n",
      "author": [],
      "contents": "\nWhat is MATH 463?\nMATH 463 Topics in Biomathematics, is a course taught at the\nUniversity of Scranton. See the\ncourse\nsyllabus for more information. This site is a home for many of the\ncourse materials developed by Jason M. Graham\nin teaching MATH 463 since 2013.\nWhat is Biomathematics?\nBiomathematics is concerned with the use of mathematical methods\n(e.g., linear algebra, differential equations, dynamical\nsystems, and probability theory) to understand phenomenon in the life\nsciences, it is part of the larger field of mathematical\nand theoretical biology. Mathematical and theoretical biology\nprovide a solid foundation for computational and quantitative approaches\nto investigations in biology and medicine.\n\n\n\n",
      "last_modified": "2022-03-05T14:27:52-05:00"
    },
    {
      "path": "LICENSE.html",
      "author": [],
      "contents": "\nAttribution-ShareAlike 4.0 International\n=======================================================================\nCreative Commons Corporation (“Creative Commons”) is not a law firm\nand does not provide legal services or legal advice. Distribution of\nCreative Commons public licenses does not create a lawyer-client or\nother relationship. Creative Commons makes its licenses and related\ninformation available on an “as-is” basis. Creative Commons gives no\nwarranties regarding its licenses, any material licensed under their\nterms and conditions, or any related information. Creative Commons\ndisclaims all liability for damages resulting from their use to the\nfullest extent possible.\nUsing Creative Commons Public Licenses\nCreative Commons public licenses provide a standard set of terms and\nconditions that creators and other rights holders may use to share\noriginal works of authorship and other material subject to copyright and\ncertain other rights specified in the public license below. The\nfollowing considerations are for informational purposes only, are not\nexhaustive, and do not form part of our licenses.\nConsiderations for licensors: Our public licenses are intended for\nuse by those authorized to give the public permission to use material in\nways otherwise restricted by copyright and certain other rights. Our\nlicenses are irrevocable. Licensors should read and understand the terms\nand conditions of the license they choose before applying it. Licensors\nshould also secure all rights necessary before applying our licenses so\nthat the public can reuse the material as expected. Licensors should\nclearly mark any material not subject to the license. This includes\nother CC- licensed material, or material used under an exception or\nlimitation to copyright. More considerations for licensors:\nwiki.creativecommons.org/Considerations_for_licensors\nConsiderations for the public: By using one of our public licenses, a\nlicensor grants the public permission to use the licensed material under\nspecified terms and conditions. If the licensor’s permission is not\nnecessary for any reason–for example, because of any applicable\nexception or limitation to copyright–then that use is not regulated by\nthe license. Our licenses grant only permissions under copyright and\ncertain other rights that a licensor has authority to grant. Use of the\nlicensed material may still be restricted for other reasons, including\nbecause others have copyright or other rights in the material. A\nlicensor may make special requests, such as asking that all changes be\nmarked or described. Although not required by our licenses, you are\nencouraged to respect those requests where reasonable.\nMore_considerations for the public:\nwiki.creativecommons.org/Considerations_for_licensees\n=======================================================================\nCreative Commons Attribution-ShareAlike 4.0 International Public\nLicense\nBy exercising the Licensed Rights (defined below), You accept and\nagree to be bound by the terms and conditions of this Creative Commons\nAttribution-ShareAlike 4.0 International Public License (“Public\nLicense”). To the extent this Public License may be interpreted as a\ncontract, You are granted the Licensed Rights in consideration of Your\nacceptance of these terms and conditions, and the Licensor grants You\nsuch rights in consideration of benefits the Licensor receives from\nmaking the Licensed Material available under these terms and\nconditions.\nSection 1 – Definitions.\nAdapted Material means material subject to Copyright and Similar\nRights that is derived from or based upon the Licensed Material and in\nwhich the Licensed Material is translated, altered, arranged,\ntransformed, or otherwise modified in a manner requiring permission\nunder the Copyright and Similar Rights held by the Licensor. For\npurposes of this Public License, where the Licensed Material is a\nmusical work, performance, or sound recording, Adapted Material is\nalways produced where the Licensed Material is synched in timed relation\nwith a moving image.\nAdapter’s License means the license You apply to Your Copyright\nand Similar Rights in Your contributions to Adapted Material in\naccordance with the terms and conditions of this Public\nLicense.\nBY-SA Compatible License means a license listed at\ncreativecommons.org/compatiblelicenses, approved by Creative Commons as\nessentially the equivalent of this Public License.\nCopyright and Similar Rights means copyright and/or similar\nrights closely related to copyright including, without limitation,\nperformance, broadcast, sound recording, and Sui Generis Database\nRights, without regard to how the rights are labeled or categorized. For\npurposes of this Public License, the rights specified in Section\n2(b)(1)-(2) are not Copyright and Similar Rights.\nEffective Technological Measures means those measures that, in\nthe absence of proper authority, may not be circumvented under laws\nfulfilling obligations under Article 11 of the WIPO Copyright Treaty\nadopted on December 20, 1996, and/or similar international\nagreements.\nExceptions and Limitations means fair use, fair dealing, and/or\nany other exception or limitation to Copyright and Similar Rights that\napplies to Your use of the Licensed Material.\nLicense Elements means the license attributes listed in the name\nof a Creative Commons Public License. The License Elements of this\nPublic License are Attribution and ShareAlike.\nLicensed Material means the artistic or literary work, database,\nor other material to which the Licensor applied this Public\nLicense.\nLicensed Rights means the rights granted to You subject to the\nterms and conditions of this Public License, which are limited to all\nCopyright and Similar Rights that apply to Your use of the Licensed\nMaterial and that the Licensor has authority to license.\nLicensor means the individual(s) or entity(ies) granting rights\nunder this Public License.\nShare means to provide material to the public by any means or\nprocess that requires permission under the Licensed Rights, such as\nreproduction, public display, public performance, distribution,\ndissemination, communication, or importation, and to make material\navailable to the public including in ways that members of the public may\naccess the material from a place and at a time individually chosen by\nthem.\nSui Generis Database Rights means rights other than copyright\nresulting from Directive 96/9/EC of the European Parliament and of the\nCouncil of 11 March 1996 on the legal protection of databases, as\namended and/or succeeded, as well as other essentially equivalent rights\nanywhere in the world.\nYou means the individual or entity exercising the Licensed Rights\nunder this Public License. Your has a corresponding meaning.\nSection 2 – Scope.\nLicense grant.\nSubject to the terms and conditions of this Public License, the\nLicensor hereby grants You a worldwide, royalty-free, non-sublicensable,\nnon-exclusive, irrevocable license to exercise the Licensed Rights in\nthe Licensed Material to:\nreproduce and Share the Licensed Material, in whole or in part;\nand\nproduce, reproduce, and Share Adapted Material.\n\nExceptions and Limitations. For the avoidance of doubt, where\nExceptions and Limitations apply to Your use, this Public License does\nnot apply, and You do not need to comply with its terms and\nconditions.\nTerm. The term of this Public License is specified in Section\n6(a).\nMedia and formats; technical modifications allowed. The Licensor\nauthorizes You to exercise the Licensed Rights in all media and formats\nwhether now known or hereafter created, and to make technical\nmodifications necessary to do so. The Licensor waives and/or agrees not\nto assert any right or authority to forbid You from making technical\nmodifications necessary to exercise the Licensed Rights, including\ntechnical modifications necessary to circumvent Effective Technological\nMeasures. For purposes of this Public License, simply making\nmodifications authorized by this Section 2(a)\nnever produces Adapted Material.\n\nDownstream recipients.\nOffer from the Licensor – Licensed Material. Every recipient of\nthe Licensed Material automatically receives an offer from the Licensor\nto exercise the Licensed Rights under the terms and conditions of this\nPublic License.\nAdditional offer from the Licensor – Adapted Material. Every\nrecipient of Adapted Material from You automatically receives an offer\nfrom the Licensor to exercise the Licensed Rights in the Adapted\nMaterial under the conditions of the Adapter’s License You\napply.\nNo downstream restrictions. You may not offer or impose any\nadditional or different terms or conditions on, or apply any Effective\nTechnological Measures to, the Licensed Material if doing so restricts\nexercise of the Licensed Rights by any recipient of the Licensed\nMaterial.\n\nNo endorsement. Nothing in this Public License constitutes or may\nbe construed as permission to assert or imply that You are, or that Your\nuse of the Licensed Material is, connected with, or sponsored, endorsed,\nor granted official status by, the Licensor or others designated to\nreceive attribution as provided in Section 3(a)(1)(A)(i).\n\nOther rights.\nMoral rights, such as the right of integrity, are not licensed\nunder this Public License, nor are publicity, privacy, and/or other\nsimilar personality rights; however, to the extent possible, the\nLicensor waives and/or agrees not to assert any such rights held by the\nLicensor to the limited extent necessary to allow You to exercise the\nLicensed Rights, but not otherwise.\nPatent and trademark rights are not licensed under this Public\nLicense.\nTo the extent possible, the Licensor waives any right to collect\nroyalties from You for the exercise of the Licensed Rights, whether\ndirectly or through a collecting society under any voluntary or waivable\nstatutory or compulsory licensing scheme. In all other cases the\nLicensor expressly reserves any right to collect such royalties. Section\n3 – License Conditions.\n\nYour exercise of the Licensed Rights is expressly made subject to the\nfollowing conditions.\nAttribution.\nIf You Share the Licensed Material (including in modified form),\nYou must:\nretain the following if it is supplied by the Licensor with the\nLicensed Material:\nidentification of the creator(s) of the Licensed Material and any\nothers designated to receive attribution, in any reasonable manner\nrequested by the Licensor (including by pseudonym if\ndesignated);\na copyright notice;\na notice that refers to this Public License;\na notice that refers to the disclaimer of warranties;\na URI or hyperlink to the Licensed Material to the extent\nreasonably practicable;\n\nindicate if You modified the Licensed Material and retain an\nindication of any previous modifications; and\nindicate the Licensed Material is licensed under this Public\nLicense, and include the text of, or the URI or hyperlink to, this\nPublic License.\n\nYou may satisfy the conditions in Section 3(a)(1) in any\nreasonable manner based on the medium, means, and context in which You\nShare the Licensed Material. For example, it may be reasonable to\nsatisfy the conditions by providing a URI or hyperlink to a resource\nthat includes the required information.\nIf requested by the Licensor, You must remove any of the\ninformation required by Section 3(a)(1)(A) to the extent reasonably\npracticable.\n\nShareAlike.\nIn addition to the conditions in Section 3(a), if You Share Adapted\nMaterial You produce, the following conditions also apply.\nThe Adapter’s License You apply must be a Creative Commons\nlicense with the same License Elements, this version or later, or a\nBY-SA Compatible License.\nYou must include the text of, or the URI or hyperlink to, the\nAdapter’s License You apply. You may satisfy this condition in any\nreasonable manner based on the medium, means, and context in which You\nShare Adapted Material.\nYou may not offer or impose any additional or different terms or\nconditions on, or apply any Effective Technological Measures to, Adapted\nMaterial that restrict exercise of the rights granted under the\nAdapter’s License You apply. Section 4 – Sui Generis Database\nRights.\nWhere the Licensed Rights include Sui Generis Database Rights that\napply to Your use of the Licensed Material:\nfor the avoidance of doubt, Section 2(a)(1) grants You the right\nto extract, reuse, reproduce, and Share all or a substantial portion of\nthe contents of the database;\nif You include all or a substantial portion of the database\ncontents in a database in which You have Sui Generis Database Rights,\nthen the database in which You have Sui Generis Database Rights (but not\nits individual contents) is Adapted Material,\nincluding for purposes of Section 3(b); and c. You must comply with\nthe conditions in Section 3(a) if You Share all or a substantial portion\nof the contents of the database.\nFor the avoidance of doubt, this Section 4 supplements and does not\nreplace Your obligations under this Public License where the Licensed\nRights include other Copyright and Similar Rights.\nSection 5 – Disclaimer of Warranties and Limitation of Liability.\nUNLESS OTHERWISE SEPARATELY UNDERTAKEN BY THE LICENSOR, TO THE\nEXTENT POSSIBLE, THE LICENSOR OFFERS THE LICENSED MATERIAL AS-IS AND\nAS-AVAILABLE, AND MAKES NO REPRESENTATIONS OR WARRANTIES OF ANY KIND\nCONCERNING THE LICENSED MATERIAL, WHETHER EXPRESS, IMPLIED, STATUTORY,\nOR OTHER. THIS INCLUDES, WITHOUT LIMITATION, WARRANTIES OF TITLE,\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, NON-INFRINGEMENT,\nABSENCE OF LATENT OR OTHER DEFECTS, ACCURACY, OR THE PRESENCE OR ABSENCE\nOF ERRORS, WHETHER OR NOT KNOWN OR DISCOVERABLE. WHERE DISCLAIMERS OF\nWARRANTIES ARE NOT ALLOWED IN FULL OR IN PART, THIS DISCLAIMER MAY NOT\nAPPLY TO YOU.\nTO THE EXTENT POSSIBLE, IN NO EVENT WILL THE LICENSOR BE LIABLE\nTO YOU ON ANY LEGAL THEORY (INCLUDING, WITHOUT LIMITATION, NEGLIGENCE)\nOR OTHERWISE FOR ANY DIRECT, SPECIAL, INDIRECT, INCIDENTAL,\nCONSEQUENTIAL, PUNITIVE, EXEMPLARY, OR OTHER LOSSES, COSTS, EXPENSES, OR\nDAMAGES ARISING OUT OF THIS PUBLIC LICENSE OR USE OF THE LICENSED\nMATERIAL, EVEN IF THE LICENSOR HAS BEEN ADVISED OF THE POSSIBILITY OF\nSUCH LOSSES, COSTS, EXPENSES, OR DAMAGES. WHERE A LIMITATION OF\nLIABILITY IS NOT ALLOWED IN FULL OR IN PART, THIS LIMITATION MAY NOT\nAPPLY TO YOU.\nThe disclaimer of warranties and limitation of liability provided\nabove shall be interpreted in a manner that, to the extent possible,\nmost closely approximates an absolute disclaimer and waiver of all\nliability.\nSection 6 – Term and Termination.\nThis Public License applies for the term of the Copyright and\nSimilar Rights licensed here. However, if You fail to comply with this\nPublic License, then Your rights under this Public License terminate\nautomatically.\nWhere Your right to use the Licensed Material has terminated\nunder Section 6(a), it reinstates:\nautomatically as of the date the violation is cured, provided it\nis cured within 30 days of Your discovery of the violation; or\nupon express reinstatement by the Licensor.\n\nFor the avoidance of doubt, this Section 6(b) does not affect any\nright the Licensor may have to seek remedies for Your violations of this\nPublic License. c. For the avoidance of doubt, the Licensor may also\noffer the Licensed Material under separate terms or conditions or stop\ndistributing the Licensed Material at any time; however, doing so will\nnot terminate this Public License.\nSections 1, 5, 6, 7, and 8 survive termination of this Public\nLicense.\nSection 7 – Other Terms and Conditions.\nThe Licensor shall not be bound by any additional or different\nterms or conditions communicated by You unless expressly\nagreed.\nAny arrangements, understandings, or agreements regarding the\nLicensed Material not stated herein are separate from and independent of\nthe terms and conditions of this Public License.\nSection 8 – Interpretation.\nFor the avoidance of doubt, this Public License does not, and\nshall not be interpreted to, reduce, limit, restrict, or impose\nconditions on any use of the Licensed Material that could lawfully be\nmade without permission under this Public License.\nTo the extent possible, if any provision of this Public License\nis deemed unenforceable, it shall be automatically reformed to the\nminimum extent necessary to make it enforceable. If the provision cannot\nbe reformed, it shall be severed from this Public License without\naffecting the enforceability of the remaining terms and\nconditions.\nNo term or condition of this Public License will be waived and no\nfailure to comply consented to unless expressly agreed to by the\nLicensor.\nNothing in this Public License constitutes or may be interpreted\nas a limitation upon, or waiver of, any privileges and immunities that\napply to the Licensor or You, including from the legal processes of any\njurisdiction or authority.\n=======================================================================\nCreative Commons is not a party to its public licenses.\nNotwithstanding, Creative Commons may elect to apply one of its public\nlicenses to material it publishes and in those instances will be\nconsidered the “Licensor.” The text of the Creative Commons public\nlicenses is dedicated to the public domain under the CC0 Public Domain\nDedication. Except for the limited purpose of indicating that material\nis shared under a Creative Commons public license or as otherwise\npermitted by the Creative Commons policies published at\ncreativecommons.org/policies, Creative Commons does not authorize the\nuse of the trademark “Creative Commons” or any other trademark or logo\nof Creative Commons without its prior written consent including, without\nlimitation, in connection with any unauthorized modifications to any of\nits public licenses or any other arrangements, understandings, or\nagreements concerning use of licensed material. For the avoidance of\ndoubt, this paragraph does not form part of the public licenses.\nCreative Commons may be contacted at creativecommons.org.\n\n\n",
      "last_modified": "2022-03-05T14:27:53-05:00"
    },
    {
      "path": "notes001.html",
      "title": "Course Notes 1",
      "description": "Introduction to Biomathematics\n",
      "author": [
        {
          "name": "Jason M. Graham",
          "url": "https://topicsinbiomath.netlify.app/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\nContents\nGoals\nTopics in Biomathematics\nLecture Notes\nCourse Projects\nThe Use of R\n\nWhat is Biomathematics?\nFurther Reading\nBasic Texts in\nBiomathematics\nMathematical Population\nDynamics\nMathematical Physiology\nMathematical\nTechniques and Computing\nApproaches not Covered in\nClass\nResearch in\nBiomathematics\n\n\nGoals\nAfter reading this section of notes, you should\nbe aware of the general structure of the course Topics in\nBiomathematics, and\nhave a general sense of what the field of biomathematics is about\nand how we will approach learning biomathematics in the course\nTopics in Biomathematics.\nTopics in Biomathematics\nWelcome to Topics in Biomathematics! The set of notes to\nwhich this document belongs have been developed from a course, MATH 463\nTopics in Biomathematics, taught at the University of Scranton since 2013.\nThe purpose of this course is to provide students having a background in\nlinear algebra and differential equations with a grounding in\nmathematical modeling for biological phenomenon. We hope that these\nnotes may also be useful for a somewhat wider audience of individuals\nthat are interested in mathematical or theoretical biology, or areas of\napplied mathematics that consider scientific problems from biology or\nmedicine.\nLecture Notes\nThere are several reasons for the existence of these notes. The\nprincipal ones are\nto provide a reference that strikes a desired balance between the\nsubjects of mathematics and science,\nto provide a reference that includes discussion of some important\ntopics from mathematical modeling that are relevant in contexts more\ngeneral than just mathematical biology,\nto provide a reference that helps to bridge the gap that is\nnecessary to close in order to begin reading the research literature,\nand\nto provide a reference that encourages good work flow practices\nsuch as integrating analysis, computing, and the written presentation of\nresults.\nCourse Projects\nWhen teaching MATH 463 Topics in Biomathematics, an\nimportant component of the course is student projects. There are two\ndifferent types of projects that students in Topics in\nBiomathematics are asked to complete: model reports, and a final\nindependent project. The model reports are meant for students to get\nearly exposure to reading research literature that involves the\ndevelopment or application of mathematical models in biology and\nmedicine. The idea is for students to get experience with the\n“translation” process of going from a real world biological problem to a\nmathematical abstraction and back again. Furthermore, students are asked\nto think and write critically about a mathematical model published in a\nrecent research article. One might reasonably view the model report\nassignment as asking students to write a peer-review referee report for\na manuscript that has already been reviewed and published.\nThe final independent project is meant as a capstone to the course.\nIt is not the expectation that every student will do an entirely\noriginal research project that involves developing a novel mathematical\nmodel from scratch, although in practice this does occur fairly often.\nHowever, the final project requires a more substantial synthesis of\nscientific and mathematical knowledge and understanding than the model\nreport or other assignments such as homework or written exams.\nThis is all meant to highlight the fact that throughout these set of\nlecture notes, we have tried to provide pointers to current or at least\nfairly recent research that is reasonably accessible to the average\nstudent in MATH 463 in order to facilitate the model report and final\nindependent projects. Every time we discuss a topic in the notes, we\nfollow the discussion up with specific references where students may go\nto in order to learn more, acquire project ideas, and see what else is\nout there regarding mathematical and theoretical biology.\nThe Use of R\nThroughout these notes and the Topics in Biomathematics\ncourse we make regular use of the R software and ecosystem for\ncomputing. It is impossible to do very much interesting work in science\nand applied mathematics, including mathematical and theoretical biology,\nwithout computation. For the purposes of this course, we will need to\nemploy numerical methods for solving equations, optimization, and linear\nalgebra. In addition, we will find it very helpful to be able to create\nvisualizations that are simple yet professional in appearance. The R\nenvironment and language possesses several features that make it highly\nappropriate for all of these purposes. Among it’s many advantages, R is\nalso freely available.\nIn addition to R, we also use RStudio, an integrated development\nenvironment that enhances the use of R. Using RStudio makes it possible\nto access the Topics in Biomathematics lecture notes in an\ninteractive fashion because all of the notes are written as R Markdown notebooks. This\nallows us to integrate text, equations, figures, R code, plots, etc. and\nto compile the result as both html and pdf files. On top of that,\nstudents will have a template they can follow in order to write and\npresent their work for the model report and independent final\nprojects.\nWhat is Biomathematics?\nBiomathematics is concerned with the use of mathematical methods\n(e.g., linear algebra, differential equations, dynamical\nsystems, and probability theory) to understand phenomenon in the life\nsciences, it is part of the larger field of mathematical\nand theoretical biology. Mathematical and theoretical biology\nprovide a solid foundation for computational and quantitative approaches\nto investigations in biology and medicine. The general work flow in\nbiomathematics proceeds as follows:\nStart with some real world phenomenon of interest from the life\nsciences.\nAbstract from the real world in order to highlight essential\nfeatures, mechanisms, processes, etc. with the goal of answering some\nspecific question or solving some particular problem. This typically\ninvolves making some set of simplifying assumptions about the biological\nworld.\nRepresent your abstraction from step 2 mathematically, say for\nexample as a system of equations. This typically involves the\nconstruction of a mathematical\nmodel.\nApply rigorous techniques from applied mathematics or scientific\ncomputing in order to understand the mathematical representation in step\n3 with the goal of using it to solve a problem or answer a\nquestion.\nPlace your results from step 4 in the context of the original real\nworld biological phenomenon.\nIt may be necessary to repeat steps 2-5 multiple times with\nrefinements at each iteration in order for your efforts to yield\nsomething that is truly useful for addressing a scientific question.\nBiomathematics, which for the purposes of this course we consider\nsynonymous with mathematical biology, emerges as a distinct field due to\nthe fact that carrying out the previously described steps has resulted\nin the (continuing) development of some common methods and terminology.\nFurthermore, we carefully distinguish biomathematics from the field of\nbiostatistics.\nWhile biomathematics certainly involves the use of probability and\nstatistics, these areas play a different role within biomathematical\ninvestigations than they do in biostatistical investigations.\nAdditionally, the relationship between theory and experiment is\ndifferent in biomathematics than in biostatistics.\nIn the next lecture, we will spend some more time fleshing out the\nsteps of the basic biomathematical workflow. From there, we will begin\nto examine some general principles related to the construction of\nmathematical models. That is, we will study those ideas from\nmathematical modeling that are essential for biomathematics. Our goal is\nto get to a point where developing a mathematical model and using it to\nanswer some biological question does not seem like an impossible\ntask.\nFurther Reading\nThroughout this course, you are encouraged to look at additional\nreferences for the purposes of seeing the perspectives of others and for\nlearning about topics and methods that are not covered explicitly in\nlectures or assigned reading. The following sections provide an overview\nof some additional texts you might want to examine at some point.\nBasic Texts in\nBiomathematics\nSeveral established textbooks in biomathematics are widely available.\nSee for example, (Allen 2007; Britton 2003; de\nVries et al. 2006; Edelstein-Keshet 2005; Friedman and Kao 2014; Murray\n2002, 2003). The two-volume text by Murray,\n(Murray\n2002, 2003), is considered something of a\nstandard, the books cover a variety of different topics well beyond what\nwe can, but assume a greater mathematical background than we do in this\ncourse. There are also several nice sets of lecture notes that are\navailable online for free, such as those by Byrne,\nChasnov,\nGoldstein\nand Pedley, Ingalls,\nand Sontag.\nMathematical Population\nDynamics\nThe earliest motivations for the development of biomathematics comes\nfrom theoretical\necology and population\ndynamics. A sub-area of these fields is mathematical\nepidemiology. Excellent references for learning more about these\nfields are provided by(Brauer and Castillo-Chavez 2012; Kot\n2001).\nMathematical Physiology\nMathematical\nphysiology is another large sub-discipline within biomathematics. A\nstandard reference is provided by (Keener and Sneyd 2009b, 2009a). Note that mathematical\nphysiology intersects with biophysics\nand biochemistry.\nNeuronal Dynamics\nAn important and well-developed topic in mathematical physiology and\nbiophysics is mathematical\nand computational neuroscience. Excellent references for this field\nare (Börgers 2017; Ermentrout and Terman 2010). You are\nalso encouraged to watch the videos from two conference talks on Brain\nControl and Modeling\nLarge Scale Brain Activity.\nMathematical Techniques\nand Computing\nIn this course, we will primarily use techniques from linear\nalgebra and ordinary\ndifferential equations. In much of our study of mathematical models\narising in biomathematics, we will be equally interested in qualitative\nand quantitatve results. The area of applied mathematics known as dynamical\nsystems theory provides the mathematical techniques for a\nqualitative analysis of mathematical models. During the course, we will\nneed to develop and employ some techniques for differential equations\nthat may not be covered in a first course in ODEs. The following two\nreferences may be very helpful in learning more about applied dynamical\nsystems and differential equations as they relate to biomathematics\n(Jones, Plank, and Sleeman 2010; Strogatz 2015).\nWhen it comes to both the quantitative and qualitative analysis of\ndifferential equation models, it is very helpful to do so with the aid\nof a computer. Both the R\nlanguage for statistical computing and the Julia language for scientific\ncomputing are excellent for our purposes. Each of these has an\nassociated ecosystem with packages that help make mathematical modeling\nand analysis easier. In this course, we primarily use R because of the\nphaseR package for the\nphase-line and phase-plane analysis of one- and two-dimensional systems\nof differential equations. Furthermore, the notes for this course are\nwritten using the RStudio integrated\ndevelopment environment associated with R. Thus, using R and RStudio\nallows the reader to go through these notes interactively to enhance the\nlearning experience.\nApproaches not Covered in\nClass\nThere are many different classes of mathematical models and a variety\nof different approaches to biomathematics. Notably absent from the main\ndiscussion in this course is stochastic\nmodels (an excellent reference with applications in biology is\nprovided by (Allen 2011)) and game theory.\nResearch in Biomathematics\nBiomathematics and related fields are active areas of research in\nwhich there are new peer-reviewed articles appearing on a daily basis.\nThe Society for Mathematical Biology\nis a great source for information on what is happening in the field of\nbiomathematcs. If you are interested to see what is going on at the\ncutting edge, you might also want to look at some of the following\nlinks:\nJournal of\nMathematical Biology\nJournal\nof Theoretical Biology\nBulletin of\nMathematical Biology\nMathematical\nBiosciences and Engineering\nPLos Computational\nBiology\narXiv on Quantitative\nBiology\n\n\n\nAllen, Linda J. S. 2007. Introduction to Mathematical Biology.\nPearson/Prentice Hall. https://agris.fao.org/agris-search/search.do?recordID=US201300115181.\n\n\n———. 2011. An Introduction to Stochastic Processes with Applications\nto Biology. Second. CRC Press, Boca Raton, FL. https://mathscinet.ams.org/mathscinet-getitem?mr=2560499.\n\n\nBörgers, Christoph. 2017. An Introduction to Modeling Neuronal\nDynamics. Vol. 66. Texts in Applied Mathematics.\nSpringer, Cham. https://doi.org/10.1007/978-3-319-51171-9.\n\n\nBrauer, Fred, and Carlos Castillo-Chavez. 2012. Mathematical Models\nin Population Biology and Epidemiology. Second. Vol. 40. Texts in\nApplied Mathematics. Springer, New York. https://doi.org/10.1007/978-1-4614-1686-9.\n\n\nBritton, Nicholas F. 2003. Essential Mathematical Biology.\nSpringer Undergraduate Mathematics Series.\nSpringer-Verlag London, Ltd., London. https://doi.org/10.1007/978-1-4471-0049-2.\n\n\nEdelstein-Keshet, Leah. 2005. Mathematical Models in Biology.\nVol. 46. Classics in Applied Mathematics. Society for\nIndustrial and Applied Mathematics (SIAM), Philadelphia, PA. https://doi.org/10.1137/1.9780898719147.\n\n\nErmentrout, G. Bard, and David H. Terman. 2010. Mathematical\nFoundations of Neuroscience. Vol. 35. Interdisciplinary\nApplied Mathematics. Springer, New York. https://doi.org/10.1007/978-0-387-87708-2.\n\n\nFriedman, Avner, and Chiu-Yen Kao. 2014. Mathematical Modeling of\nBiological Processes. Springer.\n\n\nJones, D. S., M. J. Plank, and B. D. Sleeman. 2010. Differential\nEquations and Mathematical Biology. Chapman &\nHall/CRC Mathematical and Computational\nBiology Series. CRC Press, Boca Raton, FL. https://mathscinet.ams.org/mathscinet-getitem?mr=2573923.\n\n\nKeener, James, and James Sneyd. 2009a. Mathematical Physiology.\nVol. I: Cellular Physiology.\nSecond. Vol. 8/. Interdisciplinary Applied Mathematics.\nSpringer, New York. https://doi.org/10.1007/978-0-387-79388-7.\n\n\n———. 2009b. Mathematical Physiology. Vol.\nII: Systems Physiology. Second. Vol. 8/.\nInterdisciplinary Applied Mathematics. Springer, New\nYork. https://doi.org/10.1007/978-0-387-79388-7_1.\n\n\nKot, Mark. 2001. Elements of Mathematical Ecology.\nCambridge University Press, Cambridge. https://doi.org/10.1017/CBO9780511608520.\n\n\nMurray, J. D. 2002. Mathematical Biology. I.\nThird. Vol. 17. Interdisciplinary Applied Mathematics.\nSpringer-Verlag, New York. https://mathscinet.ams.org/mathscinet-getitem?mr=1908418.\n\n\n———. 2003. Mathematical Biology. II. Third. Vol.\n18. Interdisciplinary Applied Mathematics.\nSpringer-Verlag, New York. https://mathscinet.ams.org/mathscinet-getitem?mr=1952568.\n\n\nStrogatz, Steven H. 2015. Nonlinear Dynamics and Chaos. Second.\nWestview Press, Boulder, CO. https://mathscinet.ams.org/mathscinet-getitem?mr=3837141.\n\n\nVries, Gerda de, Thomas Hillen, Mark Lewis, Johannes Müller, and Birgitt\nSchönfisch. 2006. A Course in Mathematical Biology. Vol. 12.\nMathematical Modeling and Computation.\nSociety for Industrial and Applied Mathematics (SIAM),\nPhiladelphia, PA. https://doi.org/10.1137/1.9780898718256.\n\n\n\n\n",
      "last_modified": "2022-03-05T14:27:54-05:00"
    },
    {
      "path": "notes002.html",
      "title": "Course Notes 2",
      "description": "Basic Biomathematical Work Flow\n",
      "author": [
        {
          "name": "Jason M. Graham",
          "url": "https://topicsinbiomath.netlify.app/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\nContents\nGoals\nOverview\nSimple Population\nGrowth\nGeneral Model of\nInflammation\nFurther Reading\nMathematical\nModels for Population Growth\nMathematical Models\nof Inflammation\n\n\nGoals\nAfter reading this section of notes, you should\nhave developed a greater appreciation for the basic work flow of\nbiomathematics,\nknow the meaning of “per capita rate of change” as it relates to\npopulation growth,\nknow the basic “exponential growth” model \\(\\frac{dN}{dt} = rN\\).\nOverview\nIn the previous lecture, we introduced the basic work flow of\nbiomathematics:\nStart with some real world phenomenon of interest from the life\nsciences.\nBy making some set of simplifying assumptions, abstract from the\nreal world in order to highlight essential features for the purposes of\nanswering some specific question or solving some particular\nproblem.\nRepresent your abstraction from step 2 as a mathematical model.\nUse techniques from applied mathematics or scientific computing in\norder to understand the mathematical representation in step 3 with the\ngoal of solving a problem or answering a question.\nPlace your results from step 4 in the context of the original real\nworld biological phenomenon.\nIn this lecture, we will illustrate these steps by way of two\nexamples. One is an extremely simple example about population growth,\nwhile the other is an example from a paper concerned with understanding\ngeneral features of the inflammatory process (Herald 2010).\nSimple Population Growth\nIndividual organisms typically belong to a population. Understanding\nthe growth of a population is important for understanding the ecology\nand evolution of organisms. In particular, one may want to know about\nfactors that lead to the extinction of a species. Of course, a\npopulation of organisms belongs to an ecosystem in which it interacts\nwith its environment and other species. Before we get carried away and\ntry to understand an entire ecosystem, it is useful to theorize about\nhow a single-species population may change as a function of time.\nConsider a simple isolated and homogeneous population. Let \\(N(t)\\) denote the number (or sometimes\ndensity) of individuals in the population at time \\(t\\). For simplicity we will assume that\n\\(N\\) is a continuous and\ndifferentiable function of the continuous variable \\(t\\). Later we will reflect on these\nassumptions and discuss modifications that could be made if necessary.\nWe define\n\\(\\text{per capita rate of change} =\n\\frac{1}{N}\\frac{dN}{dt}\\)\nnoting that this quantity has units of \\(\\frac{1}{\\text{time}}\\). The point is that\nwe can arrive at a mathematical model for the growth of a population by\nspecifying a formula for the per capita rate of change. Let’s begin with\nthe simplest assumption that we can possibly make, suppose that the per\ncapita rate of change is constant. That is, suppose\n\\(\\frac{1}{N}\\frac{dN}{dt} =\nr\\).\nThen,\n\\(\\frac{dN}{dt} = rN\\).\nLet’s make two observations about this last equation:\nIf \\(r > 0\\), then \\(rN >0\\) (populations are always positive\nso we assume implicitly that \\(N >\n0\\)) and thus \\(\\frac{dN}{dt} >\n0\\). Therefore, if the constant rate \\(r > 0\\), then the population will always\nbe increasing. On the other hand, if \\(r <\n0\\), then the population will always be decreasing.\nReflection: Sketch the graph of a function that is\nalways positive and always increasing. Sketch the graph of a function\nthat is always positive and always decreasing.\nGiven an initial value of the population \\(N(0) = N_0\\), \\(N(t) = N_{0}e^{rt}\\) satisfies the\ndifferential equation \\(\\frac{dN}{dt} =\nrN\\).\nReflection: Take a moment to verify this by\nsubstituting \\(N(t) = N_{0}e^{rt}\\)\ninto both sides of the equation. In the homework you will be asked to\nderive this solution using the method of\nseparation. (Chances are that you have done this before.)\nLet’s look at the graph of \\(N(t) =\nN_{0}e^{rt}\\):\n\n\n\nFigure 1:  Exponential growth model results.\n\n\n\n(Note: It is worth the effort to remember forever\nand all time that the solution of the differential equation\n\\(\\frac{dx}{dt} = ax\\),\nwith initial condition \\(x(0)=x_0\\)\nis \\(x(t) = x_{0}e^{at}\\).)\nBased on our observations, we see that a population that obeys the\nmodel \\(\\frac{dN}{dt}=rN\\) will grow\n(if \\(r > 0\\)) or decay (if \\(r < 0\\)) in an exponential fashion.\nAn obvious question is, what determines if \\(r\\) is positive or negative? One way to\nmake sense of this is to think of \\(r\\)\nas the difference between the per capita birth rate \\(b\\) and the per capita death rate \\(d\\) so that \\(r=b-d\\). Then \\(r\n> 0\\) if \\(b > d\\) and\n\\(r < 0\\) if \\(b < d\\). Thus, a population is predicted\nto go extinct (in the long run as \\(t\n\\rightarrow \\infty\\)) if the per capita death rate is greater\nthan the per capita birth rate.\nOne problem with the model is that long term exponential growth is\nunrealistic. The survival of a real population depends on resources such\nas food and water. An exponentially growing population would soon\ndeplete all available resources. On the other hand, it is not\nunrealistic for a population to initially grow exponentially when the\npopulation numbers are very small relative to the availability of\nresources. Later on we will discuss ways to adjust the model so that\ngrowth is exponential when the population is small but slows as the\npopulation increases.\nNotice how we hit each step of the biomathematics work flow during\nthe course of our discussion on population growth. We began with a real\nworld phenomenon, abstracted to an isolated homogeneous population,\nwrote down a mathematical model, derived information from the model and\ncast that information in the context of the original real world\nphenomenon. Let’s look at another example of how the biomathematics work\nflow plays out in the context of more recent research.\nGeneral Model of\nInflammation\nInflammation\nis a normal part of the immune response\nfor defense against invasion by foreign cells or molecules. However,\ninflammation may become chronic and lead to disease, sepsis, and even death.\nFor the purposes of both treatment and prevention of disease, it is\nimportant to understand the conditions that lead to chronic\ninflammation.\nWithout going into the biological and chemical details, we know that\ninflammation is controlled and mediated by immune cells (the macrophage)\nwhose behavior is regulated by signaling molecules known as cytokines. Thus, it is\nreasonable for the purposes of abstraction to encapsulate the immune\nresponse by the activities of macrophage cells, cytokines, and an\ninvading body such as a bacteria cell. This is exactly what is done in\nthe paper (Herald 2010).\nFigure 2 shows a schematic corresponding to our abstraction of the\nimmune response. The macrophage cell population responds to bacterial\ninvasion and produces cytokines that mediate the immune response. The\nexact details of the interactions are governed by model parameters and\nmathematical relationships between the interacting cell populations and\ncytokines.\n\n\n\nFigure 2:  Schematic of inflammation model. This corresponds roughly to\nFigure 1 in (Herald 2010).\n\n\n\nIn (Herald 2010), the author converts the\nmodel diagram into a mathematical model in the form of a coupled system\nof nonlinear differential equations shown here:\n\\[\\begin{align}\n\\frac{dM}{dt} &= s + \\frac{r C}{1 + k_{1} C} - m_{d} M, \\\\\n\\frac{dC}{dt} &=  p_{c} B M + M \\frac{a C}{(1 + k_{2} C)}\\frac{1}{(1\n+ k_{3} A)} - c_{d} C,\\\\\n\\frac{dA}{dt} &=  p_{a} C M - a_{d} A, \\\\\n\\frac{dB}{dt} &= g B - b_{d} M B.\n\\end{align}\\]\nLater on in the course we will study this model in more detail. For\nnow, note that\n\\(M\\) - macrophage cell\npopulation\n\\(C\\) - inflammatory cytokine\nconcentration\n\\(A\\) - anti-inflammatory cytokine\nconcentration\n\\(B\\) - bacteria cell\npopulation\nIn the paper, the author uses the model equations to show that under\na certain set of circumstances a bacterial pathogen will not provide a\nsufficient trigger to cause chronic inflammation. On the other hand, if\nconditions are right, even a minor bacterial infection can lead to\nchronic inflammation. We leave the details of the analysis for later in\nthe course. Notice that this example contains all of the components of\nthe basic biomathematics work flow.\nThe real world phenomenon of interest from the life sciences is\ninflammation.\nFigure 2 corresponds to an abstraction of the biochemical details of\nthe immune system highlighting what is thought to be the essential\nfeatures of the inflammatory response.\nClearly there is a mathematical model. A major portion of this\ncourse is devoted to understanding how one might come up with such a\nsystem of equations. These were not simply pulled out of thin air.\nIn (Herald 2010), the author uses techniques\nfrom dynamical\nsystems and bifurcation\ntheory in order to derive useful information from the model\nequations.\nThe author’s analysis of the model system explains some aspects of\ninflammation and pinpoints conditions that lead to chronic inflammation.\nThe authors work also explains why certain therapies for chronic\ninflammation are not successful.\nThere are still many questions about inflammation to be addressed\nbeyond what is done in (Herald 2010). However, in order to make\nprogress more details of the immune response may need to be included.\nThis will involve either modifying the system of equations displayed in\nthis section, or using a different mathematical model altogether. For\nnow, the point to take away is that, often times, this is how work in\nbiomathematics proceeds. In the next lecture, we will start to learn\nsome essential principles of mathematical modeling that will help us to\nsee where equations such as the ones presented in this section come\nfrom.\nFurther Reading\nFor those that want to learn more about the topics discussed in this\nlecture, we provide here some relevant references.\nMathematical Models\nfor Population Growth\nIntroductions to mathematical models for population growth may be\nfound in most of the standard texts in biomathematics. Good places to\nstart are (Allen 2007; Britton 2003; Edelstein-Keshet 2005). The textbook\n(Kot\n2001) is entirely devoted to population models. An important\napplication of population growth models is to cancer biology where one\nis interested to understand the growth of tumor cell populations. Two\npapers that examine population growth models in the context of tumor\ncell growth are (Gerlee\n2013; Sarapata and de Pillis 2014).\nMathematical Models of\nInflammation\nMathematical modeling of inflammation is an area of current research.\nIn addition to the paper already referenced, (Herald 2010), we also recommend (Day et\nal. 2006; Reynolds et al. 2006).\n\n\n\nAllen, Linda J. S. 2007. Introduction to Mathematical Biology.\nPearson/Prentice Hall. https://agris.fao.org/agris-search/search.do?recordID=US201300115181.\n\n\nBritton, Nicholas F. 2003. Essential Mathematical Biology.\nSpringer Undergraduate Mathematics Series.\nSpringer-Verlag London, Ltd., London. https://doi.org/10.1007/978-1-4471-0049-2.\n\n\nDay, Judy, Jonathan Rubin, Yoram Vodovotz, Carson C. Chow, Angela\nReynolds, and Gilles Clermont. 2006. “A Reduced Mathematical Model\nof the Acute Inflammatory Response. II.\nCapturing Scenarios of Repeated Endotoxin\nAdministration.” Journal of Theoretical Biology 242 (1):\n237–56. https://doi.org/10.1016/j.jtbi.2006.02.015.\n\n\nEdelstein-Keshet, Leah. 2005. Mathematical Models in Biology.\nVol. 46. Classics in Applied Mathematics. Society for\nIndustrial and Applied Mathematics (SIAM), Philadelphia, PA. https://doi.org/10.1137/1.9780898719147.\n\n\nGerlee, Philip. 2013. “The Model Muddle: In\nSearch of Tumor Growth Laws.” Cancer\nResearch 73 (8): 2407–11. https://doi.org/10.1158/0008-5472.CAN-12-4355.\n\n\nHerald, Meagan C. 2010. “General Model of Inflammation.”\nBulletin of Mathematical Biology 72 (4): 765–79. https://doi.org/10.1007/s11538-009-9468-9.\n\n\nKot, Mark. 2001. Elements of Mathematical Ecology.\nCambridge University Press, Cambridge. https://doi.org/10.1017/CBO9780511608520.\n\n\nReynolds, Angela, Jonathan Rubin, Gilles Clermont, Judy Day, Yoram\nVodovotz, and G. Bard Ermentrout. 2006. “A Reduced Mathematical\nModel of the Acute Inflammatory Response. I.\nDerivation of Model and Analysis of\nAnti-Inflammation.” Journal of Theoretical Biology 242\n(1): 220–36. https://doi.org/10.1016/j.jtbi.2006.02.016.\n\n\nSarapata, E. A., and L. G. de Pillis. 2014. “A Comparison and\nCatalog of Intrinsic Tumor Growth Models.” Bulletin of\nMathematical Biology 76 (8): 2010–24. https://doi.org/10.1007/s11538-014-9986-y.\n\n\n\n\n",
      "last_modified": "2022-03-05T14:27:57-05:00"
    },
    {
      "path": "notes003.html",
      "title": "Course Notes 3",
      "description": "Introduction to Mathematical Modeling in Biomathematics\n",
      "author": [
        {
          "name": "Jason M. Graham",
          "url": "https://topicsinbiomath.netlify.app/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\nContents\nGoals\nOverview\nWhat is a Mathematical\nModel?\nMathematical Modeling\nFurther Reading\n\nGoals\nAfter reading this section of notes, you should\nhave an understanding of the notion of “mathematical\nmodel”,\nbe aware of typical steps in the modeling process, and\nhave gained an appreciation for the place of mathematical\nmodeling in the basic biomathematical work flow.\nOverview\nAt this point, we have introduced the basic work flow that is often\nfollowed in the practice of biomathematics. Key components of the\nbiomathematics work flow is the construction of a mathematical model and\nthe use of the model to try to solve a problem or answer a question\nstemming from the life sciences. Mathematical modeling is the process of\nconstructing or deriving a mathematical model. But what exactly is a\nmathematical model? We beleive that it is not very easy to answer this\nquestion in a way that is unique, definitive, and concise. However, we\nhope that as the course proceeds you will over time develop an internal\nunderstanding of what a mathematical model is and even gain some ability\nwith building mathematical models in the context of biomathematics.\nWhat is a Mathematical Model?\nBefore we begin to address the question of what is a mathematical\nmodel, let’s spend some time focusing just on\nnot-necessarily-mathematical models. Work in science and engineering\noften proceeds by employing models. What is a model? Consider the\nfollowing quotation:\n\nA model is a rendition of a reality which is often too difficult or\nimpossible to handle directly. A model is always a simplification, and a\ngood model is one that captures the essential features of reality,\nleaving the unessential out (Calvetti and Somersalo 2013).\n\nA great example of a scientific model is the Bohr model for the\natom. This model posits that an atom is made up of a small dense nucleus\nsurrounded by orbiting electrons. This is a model because it does not\ninclude many atomic and nuclear details. It is a useful model because it\nleads to an explanation of certain chemical properties of atoms that\ncould not be derived prior to the use of the Bohr model. Many biologists\nuse model\norganisms to investigate the biological world. For example, people\ninterested in understanding the evolution of social behavior study\nspecific species of ants or bees. These insects are used because they\nare relatively easy to keep in a lab or to observe in nature and are\nalso easy to manipulate experimentally. The use of animal\nmodels is also widespread in the study of disease and drug\ntherapies.\nA mathematical model plays a similar role to models in the more\ngeneral sense that we just described, but as you might imagine\nmathematical models are formulated and implemented mathematically. In\nthe last lecture, we very briefly indicated two mathematical models. One\nfor the growth of a population and another for certain cellular and\nmolecular interactions that occur during inflammation. Let’s look at\nanother example of a mathematical model, this time one coming from\nphysics that is likely familiar to you from a course in ordinary\ndifferential equations.\nPhysics and mechanics in particular is often interested in the motion\nof a point particle. (Notice that point particles are an abstraction\nfrom reality.) Newton’s laws tell us, among other things, that the sum\nof all forces acting on a mass is proportional to the acceleration of\nthe object. Furthermore, the constant of proportionality is the mass. In\nnotation, we have that \\(F=ma\\). Now,\nwhile \\(F=ma\\) is an equation and you\ncould reasonably argue that it is a “mathematical model” for how the\nphysical world works, \\(F=ma\\) is not\nreally representative of what we mean by a mathematical model in most\ninstances. The reason is that it is a general statement, a theory and\nnot a reference to something specific. However, we can use \\(F=ma\\) to construct mathematical models in\nmore specific situations.\nSuppose for example that we are concerned with the motion of a\nparticle of mass \\(m\\) attached to a\nspring. We can model the total force that is applied to the mass by the\nspring via the equation \\(F=-kx\\). This\nsays that the force due to the spring is linearly proportional to the\ndisplacement of the mass from it’s equilibrium (resting) position.\n(Again, this is an abstraction from reality.) The constant of\nproportionality \\(k\\) is called the\nspring constant. It encodes physical properties of a spring such as its\nstiffness. Taken together with \\(F=ma\\)\nand using that acceleration is the second derivative of displacement we\narrive at a mathematical model\n\\(\\frac{d^2 x}{dt^2} =\n-\\frac{k}{m}x.\\)\nThis is a model because it is based on several abstractions from\nreality and ignores some details such as more fine-grained details about\nthe material properties of real world springs. It also assumes an ideal\nsituation where there is no friction.\nAs you have seen in a differential equations course, or by using\nmethods we will discuss later, it can be deduced based on the form of\nthe equation \\(\\frac{d^2 x}{dt^2} =\n-\\frac{k}{m}x\\) that such a mass will oscillate with a fixed\nperiod and frequency determined by the values for \\(k\\) and \\(m\\). This leads us to another important\npoint. There are several levels of “variable” involved in the model\n\\(\\frac{d^2 x}{dt^2} = -\\frac{k}{m}x\\).\nThere is the independent variable \\(t\\)\nfor time, the dependent variable for the unknown displacement \\(x\\) (the quantity we are ultimately most\ninterested in), and there are the parameters \\(k\\) and \\(m\\).\nWe will see that most mathematical models involve parameters and it\nwill become very important to understand how the values of parameters\ninfluence the results obtained from the model. Also very important is to\nnote that variables and parameters correspond to quantities and thus\nhave some set of units associated with them. We will spend a lot of time\ntalking about why units of measurement are important but take note now\nthat a mathematical model can not make sense if there is an\ninconsistency between units for parameters or variables.\nThe last example provides some insight into mathematical modeling,\nthat is, the process of constructing or deriving a model. We begin with\nan abstraction from reality that represents those parts of the world in\nwhich we are most interested in, then we specify quantities that we want\nto relate, establish mathematical notation, and finally write down an\nequation that becomes our mathematical model. While our last example was\nvery simple (too simple), it still serves to highlight the modeling\nprocess. The next section elaborates on this.\nMathematical Modeling\nIt is important to realize two facts about mathematical modeling,\nespecially in the context of biomathematics, from the start:\nMathematical modeling is as much art as it is science. The point\nis that mathematical modeling is not routine or algorithmic. Successful\nmodeling requires creativity and intuition developed through\nexperience.\nMathematical modeling will almost certainly involve repeated\nrefinements. Unless there is a very strong reason to do otherwise, it’s\nbest to start with the simplest possible reasonable model, even at the\nrisk of oversimplification. If the model produces incorrect or\ninaccurate results relative to the problem of interest, then the model\ncan be revised in order to fix what is glaringly wrong.\nIn the next lecture, we will begin to address specific techniques\nthat can help one to get started with mathematical modeling. Here we\nwill provide a conceptual outline of the modeling process in the form of\na series of steps that one typically carries out during the course of\nthe modeling process.\nFormulate the question or state your problem. Explicitly write\ndown assumptions and what is known about the system that you want to\ndevelop a model for.\nIdentify key quantities and define variables and parameters of\ninterest. At this stage you should take careful note of the units of\nmeasurement that are associated with all of the model variables and\nparameters.\nDevelop a qualitative description of your model. Use diagrams or\nword equations to describe the relationships between variables. In the\nnext lecture we will discuss compartment modeling which is a commonly\nused method for organizing the processes and interactions of variables\nin a way that helps one to more easily write down model\nequations.\nWrite down model equations corresponding to the qualitative\ndescription in the previous step. Perform dimensional\nanalysis (covered in detail later) to make sure that there are no\ninconsistencies in your equations regarding units. At this stage it is\nvery helpful to construct a table that lists all of the variables and\nparameters appearing in the model. The table should include the units of\nmeasurement for all of the variables and parameters as well as any\nspecific parameters values that are known from experiment or the\nexisting literature.\nNondimensionalize\nthe model. Later we will cover nondimensionalization in detail. This is\na process founded on the Buckinghma\n\\(\\pi\\) theorem in which variables\nand parameters are rescaled to remove units. This process is extremely\nimportant as it often simplifies the model by reducing the number of\nparameters and pinpoints the most significant parameters (or parameter\ncombinations) in the model.\nAt this stage you will be ready to analyze or implement your model in\norder to obtain results such as qualitative or quantitative predictions.\nThe next thing to do is determine if the model results are consistent\nwith known information or experimental results. You have to do something\nto decide if your model is successful or should be revised in order to\naddress your starting question or solve the problem you have posed.\nWith this overview in hand, the next lecture will cover compartment\nmodeling and we will start to see concrete examples of mathematical\nmodels and the modeling process.\nFurther Reading\nFor general texts on mathematical modeling we recommend (Barnes and Fulford 2015; Calvetti and Somersalo 2013; Witelski and Bowen 2015). Both (Barnes and Fulford 2015; Calvetti and Somersalo 2013) provide\ngood coverage of compartment\nmodeling. Dimensional\nanalysis is covered well in (Calvetti and Somersalo 2013; Witelski and Bowen 2015).\nA nice recent reference on mathematical modeling of biological\nsystems is the chapter (Ayati 2019), which discusses modeling\napproaches in the context of microbial ecology.\n\n\n\nAyati, Bruce P. 2019. “Considerations for Modeling\nProteus Mirabilis Swarming.” In Proteus\nMirabilis, 285–96. Springer.\n\n\nBarnes, B., and G. R. Fulford. 2015. Mathematical Modelling with\nCase Studies. Third. Textbooks in Mathematics.\nCRC Press, Boca Raton, FL. https://mathscinet.ams.org/mathscinet-getitem?mr=3288754.\n\n\nCalvetti, Daniela, and Erkki Somersalo. 2013. Computational\nMathematical Modeling. Mathematical Modeling and\nComputation. Society for Industrial and Applied\nMathematics (SIAM), Philadelphia, PA. https://mathscinet.ams.org/mathscinet-getitem?mr=3013353.\n\n\nWitelski, Thomas, and Mark Bowen. 2015. Methods of Mathematical\nModelling. Springer.\n\n\n\n\n",
      "last_modified": "2022-03-05T14:27:58-05:00"
    },
    {
      "path": "notes004.html",
      "title": "Course Notes 4",
      "description": "Introduction to compartment modeling in biomathematics\n",
      "author": [
        {
          "name": "Jason M. Graham",
          "url": "https://topicsinbiomath.netlify.app/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\nContents\nGoals\nOverview\nA Simple\nExample: Population Models Revisited\nLogistic Growth\nHarvesting\nInteracting Populations\n\nAnother Compartment\nModel Example\nFurther Reading\n\nGoals\nAfter reading this section of notes, you should\nhave a feel for the concepts of compartment models and balance\nlaws, and\nunderstand how common population models can be viewed from the\nperspective of compartment modeling.\nOverview\nCompartment modeling is a framework for the construction of\ndifferential equation models for systems that involve one or more\ntime-dependent quantities that form distinct compartments that taken\ntogether make up the system of interest. Compartment modeling proceeds\nby accounting for the processes and interactions that influence the rate\nof change of the various quantities encapsulated by each of the\ncompartments. Thus, we view a compartment model as a network of time\nvarying quantities where inputs and outputs between nodes of the network\ndetermine the factors that influence the time rate of change for those\nquantities. Typically, an input corresponds to a factor that will\nincrease a compartment quantity while an output corresponds to a factor\nthat will decrease a compartment quantity.\nSoon we will present concrete examples of compartment models. For the\nmoment, let’s consider a conceptual example that will help to provide\nsome intuition for the presently vague notion of a compartment. Suppose\nwe are interesting in modeling food to cell metabolism. We can do this\nwith a two-compartment model where one compartment is the stomach and\nthe other compartment is the blood. We are interested in the\ntime-varying energy content of each of the two compartments. Eating is\nan input and will increase the energy content within the stomach, while\ndigestion will decrease the energy content within the stomach but\nincrease the energy content within the blood. On the other hand\nmetabolic activity will decrease the energy content within the blood and\nthus is an output for the blood energy content. We can represent the\nprocesses just described with the following compartment\ndiagram.\n\n\n\nFigure 1: Compartment diagram describing the pathway from food to\nmetabolism\n\n\n\nR Tip: Compartment diagrams such as the previous one\ncan be made using the DiagrammeR\npackage.\nThe next step would be to write down differential equations for the\nrate of change of energy content in the stomach and the rate of change\nof energy content in the blood. In the next section, we will start to\nget a feel for how to go from a compartment model and compartment\ndiagram to the corresponding differential equations.\nSee both (Barnes and Fulford 2015; Calvetti and Somersalo 2013) for\ncomplimentary treaments of compartment\nmodeling. We note that compartment models are also used in the\ncontext of stochastic models, for information about this see the later\nchapters from (Calvetti and Somersalo 2013) or the\ntextbook (Allen 2011).\nA Simple Example:\nPopulation Models Revisited\nIn this section, we look at how we can recast population models in\nthe compartment model framework. We can view a single isolated and\nhomogeneous time-varying population \\(N(t)\\) as making up a single compartment.\nThen a compartment model for this situation has the following\ncompartment diagram:\n\n\n\nFigure 2: Compartment diagram of single-species population model.\n\n\n\nAs a word equation, this model reads\n\\(\\left\\{\\begin{array}{c} \\text{rate of\nchange} \\\\ \\text{of population} \\end{array} \\right\\} =\n\\left\\{\\begin{array}{c} \\text{rate of} \\\\ \\text{births} \\end{array}\n\\right\\} - \\left\\{\\begin{array}{c} \\text{rate of} \\\\ \\text{deaths}\n\\end{array} \\right\\}\\).\nOur goal is to covert the word equation corresponding to the\ncompartment diagram into a mathematical equation, specifically a\ndifferential equation. Clearly we have that\n\\(\\left\\{\\begin{array}{c} \\text{rate of\nchange} \\\\ \\text{of population} \\end{array} \\right\\} =\n\\frac{dN}{dt}\\),\nwhat remains is to determine mathematical expressions for the rate of\nbirths and rate of deaths. In general, inputs and outputs in compartment\nmodels may be constants, functions of time, or functions of one or more\nof the other compartment variables. In terms of the single-species\npopulation model, it is reasonable to initially assume that both the\nrate of births and rate of deaths are proportional to the population\n\\(N\\). Why is that? First off, if the\ninitial population is zero, then the population should never increase or\ndecrease. Furthermore, we don’t yet have a strong reason to assume any\nmore complicated functional dependencies for the birth and growth rates.\nThus, to begin we assume that\n\\(\\left\\{\\begin{array}{c} \\text{rate of} \\\\\n\\text{births} \\end{array} \\right\\}=bN,\\ \\ \\left\\{\\begin{array}{c}\n\\text{rate of} \\\\ \\text{deaths} \\end{array} \\right\\} = dN\\),\nwhere \\(b\\) and \\(d\\) are both positive constants.\nThis leads to the differential equation model\n\\(\\frac{dN}{dt} = bN - dN =\n(b-d)N\\).\nAs we have already seen, this models leads to either exponential\ngrowth (when \\(b > d\\)) or\nexponential decay (when \\(b < d\\)).\nNow exponential growth is unrealistic for a long-term model of a\npopulation that depends on some limited resource in order to persist.\nThis suggests that we might want to consider a different model and\nspecifically, we may want to revisit our assumption that the rate of\nbirth is directly proportional to the population. This is taken up in\nthe following subsection.\nLogistic Growth\nLet’s momentarily suppose that we can ignore deaths and consider a\nmodel corresponding to the following diagram:\n\n\n\nFigure 3: Compartment diagram of single-species population model with\nnutrient dependent birth rate.\n\n\n\nLet \\(C(t)\\) be the time-dependent\nconcentration of some (limited) nutrient that the population requires in\norder to persist. A corresponding mathematical model is then\n\\(\\frac{dN}{dt} = r(C)N\\),\nwhere \\(r(C)\\) is the growth rate\nthat depends as a function on \\(C\\). As\nis, we do not have enough information to solve this differential\nequation. That is because as is, both \\(N\\) and \\(C\\) are unknowns and we cannot solve a\nsystem of differential equations where the number of unknowns is not\nequal to the number of equations. We are left with three options:\nProvide an explicit expression for \\(C(t)\\). For example, maybe we assume that\nthe nutrient concentration decreases over time and thus set \\(C(t) = e^{-\\alpha t}\\), where \\(\\alpha\\) is the rate at which the nutrient\ndepletes. Of course there are (potentially infinitely) many other\noptions for an expression for \\(C(t)\\).\nThe problem with this approach is that any particular choice for \\(C(t)\\) is likely to apply in only very\nspecific situations.\nDerive an additional differential equation for \\(C(t)\\). The problem with this approach is\nthat additional information or assumptions are necessary to do\nthis.\nDetermine an expression for \\(C\\) in terms of \\(N\\) (and perhaps also some parameters). We\nwill now take up this approach and see that it leads to an interesting\nresult.\nA reasonable assumption is that as the population increases, the\nnutrient will decrease. That is,\n\\(\\frac{dC}{dt} = -\\alpha\n\\frac{dN}{dt}\\),\nwhere \\(\\alpha > 0\\) is a\nconstant. Rearranging the previous equation shows that\n\\(\\frac{dC}{dt} + \\alpha \\frac{dN}{dt} =\n\\frac{d}{dt}(C + \\alpha N) = 0\\). Therefore, we have that \\(C + \\alpha N = \\text{constant}\\) and we\nwill denote this constant by \\(q\\).\nFrom this, we determine that\n\\(C = q - \\alpha N\\),\nNow let’s think about how \\(r\\)\ncould depend on \\(C\\). In mathematical\nmodeling, one typically starts with the simplest reasonable expression.\nIn our case, that would be to assume that \\(r\\) is a linear function of \\(C\\). That is,\n\\(r(C) = a_{1}C + a_{0},\\)\nwhere \\(a_{0}\\) and \\(a_{1}\\) are constants. Further, if there is\nno nutrient available, then there should be no growth. Therefore, \\(r(0) = 0\\) from which we conclude that\n\\(a_{0}=0\\). Then putting together\n\\(C = q - \\alpha N\\) and \\(r(C)=a_{1}C\\) leads to\n\\(r(C) = a_{1}(q - \\alpha N) =\na_{1}q\\left(1 - \\frac{N}{\\frac{q}{\\alpha}}\\right)\\).\nThen, our differential equations becomes\n\\(\\frac{dN}{dt} = a_{1}q\\left(1 -\n\\frac{N}{\\frac{q}{\\alpha}}\\right)N\\).\nLet’s take a moment to reflect on the meaning of the parameters in\nour last expression. The constant \\(q\\)\nhas units of concentration and thus \\(a_{1}q\\) is the growth rate. On the other\nhand \\(\\alpha\\) is a ratio of nutrient\nconcentration per unit of population. This means that \\(\\frac{q}{\\alpha}\\) tells us about how much\nnutrient it takes to support a given sized population provided that the\npopulation consumes nutrient at some particular rate (determined by\n\\(\\alpha\\)). Based on this, we define\nnew parameters \\(r = a_{0}q\\) (the\ngrowth rate) and \\(K =\n\\frac{q}{\\alpha}\\) (the carrying capacity). This leads finally to\nthe so-called logistic\ngrowth model\n\\(\\frac{dN}{dt} = r\\left(1 -\n\\frac{N}{K}\\right)N\\).\nIn the homework, you will derive a closed form solution for this\nequation. (You can use the method of separation in the form\n\\(\\int \\frac{dN}{\\left(1 -\n\\frac{N}{K}\\right)N} = \\int r dt,\\)\nand then use partial fractions to compute the left hand indefinite\nintegral).\nEven without solving the differential equation, we can deduce the\nbehavior of the population that is implied by the model. First, both\nsides of the equation are a statement about the time rate of change of\n\\(N\\). This is because the derivative\n\\(\\frac{dN}{dt}\\) is by definition the\ntime rate of change of \\(N\\) and since\nthe right side equals the left side, \\(r\\left(1 - \\frac{N}{K}\\right)N\\) must also\ndetermine the time rate of change of \\(N\\).\nNow, if the population \\(N\\) is much\nsmaller than the carrying capacity \\(K\\), then \\(\\left(1 - \\frac{N}{K}\\right) \\approx 1\\)\nand thus \\(\\frac{dN}{dt} \\approx rN\\).\nThis suggests that when the population is small the growth is\nexponential. However, as \\(N\\)\napproaches \\(K\\) the quantity \\(\\left(1 - \\frac{N}{K}\\right)\\) gets closer\nand closer to zero which suggests that the growth of the population\napproaches zero. Further, at \\(N=0\\)\nand \\(N=K\\) we have that \\(r\\left(1 - \\frac{N}{K}\\right)N=0\\). That\nis, \\(N=0\\) and \\(N=K\\) are steady-state solutions to\n\\(\\frac{dN}{dt} = r\\left(1 -\n\\frac{N}{K}\\right)N\\).\nBased on our previous discussion we should suspect that \\(N=K\\) is a stable\nsteady-state because for any starting population the species will grow\nso as to approach but never surpass the carrying capacity \\(K\\). (You should think about what will\nhappen if we initially begin with a population that is greater than\n\\(K\\).) Either recall or note that the\ndifferential equation \\(\\frac{dN}{dt} =\nr\\left(1 - \\frac{N}{K}\\right)N\\) is a nonlinear autonomous (that\nis, no explicit dependence on \\(t\\))\nequation. Dynamical systems theory provides techniques for the\nqualitative analysis of nonlinear autonomous equations (and systems) and\nwe will take up a much more detailed study of these methods later on.\nFor now, suffice it to say that a graph of \\(F(N) = r\\left(1 - \\frac{N}{K}\\right)N\\)\nwill show us how we expect the system to respond (in terms of increasing\nor decreasing behavior) for any particular initial population value.\n\n\n\nThe last plot shows the graph of \\(F(N) =\nr\\left(1 - \\frac{N}{K}\\right)N\\) from which we see that the\npopulation will decrease if \\(N <\n0\\) or \\(N > K\\) and the\npopulation will increase if \\(0 < N <\nK\\). The steady-state values occur at the \\(x\\)-intercepts. We see that \\(N=K\\) is a stable steady-state because it\nis robust to small perturbations. This previous construction is called\nthe phase line.\nThe following plot shows solutions to \\(\\frac{dN}{dt} = r\\left(1 -\n\\frac{N}{K}\\right)N\\) for four different initial conditions.\n\n\n\nFrom this figure, we see that if \\(N(0) =\n0\\) or if \\(N(0)=K\\) then there\nis no change over time. However, if \\(N(0)\\) is any other positive value then the\nsolution to \\(\\frac{dN}{dt} = r\\left(1 -\n\\frac{N}{K}\\right)N\\) approaches \\(K\\) as time increases.\nWe will say more about this later but the last two plots are obtained\nusing the phaseR\npackage which is an R package for the qualitative analysis of one-\nand two-dimensional autonomous ODE systems, using phase line/plane\nmethods. (You can also learn more about this by reading our R for\nBiomath page.) This package will turn out to be very useful for us.\nLet’s move on to look at some extensions of our single population model\nbefore moving on to some other examples of compartment models.\nHarvesting\nAs a sort of application of our logistic growth model, let’s consider\nthe impact of harvesting on the dynamics of a\npopulation. As you can probably imagine, harvesting is the extraneous\nremoval of individuals from a population. A good example of harvesting\nis fishing. To start with, we will consider a very simple scenario.\nSuppose that we want to study the impact of fishing with the specific\ngoal of examining what amount of fishing can be supported in order to\navoid the total depletion of the fish population found say, in a small\nlake or pond. Let’s assume that our study occurs over a small enough\ntime-frame that the death rate is negligible compared with the rate of\nharvesting, i.e., fishing. Because we are considering a fish\npopulation in a small isolated body of water it should be very\nreasonable to assume logistic growth because resources are obviously\nlimited. A diagram for the situation we have described is as\nfollows:\n\n\n\nFigure 4: Compartment diagram of harvesting model.\n\n\n\nLet \\(h\\) denote the harvesting\nrate. We will begin by assuming that \\(h\\) is a constant so that harvesting is\nindependent of the population size (this can be viewed as setting a\nquota at the beginning of fishing season). Then our mathematical model\nis\n\\(\\frac{dN}{dt} = r\\left(1 -\n\\frac{N}{K}\\right)N - h\\).\nNow, the steady-states to this equation are given by solutions to the\nquadratic equation \\(r\\left(1 -\n\\frac{N}{K}\\right)N - h = 0\\). In the homework, you will show\nusing the quadratic formula that these are given by\n\\(N = \\frac{K}{2}\\left(1 \\pm \\sqrt{1 -\n\\frac{4h}{Kr}} \\right)\\).\nIt should be clear that if the ratio \\(\\frac{4h}{Kr}\\) is too large then \\(1 - \\frac{4h}{Kr} < 0\\) which leads to a\nproblem since the expression under the radical will be negative. On the\nother hand, if \\(\\frac{4h}{Kr}\\) is\nsufficiently small, then there will be two positive steady-states. Let’s\nexplore what can happen by graphing \\(f(N) =\nr\\left(1 - \\frac{N}{K}\\right)N - h\\) in the cases where \\(\\frac{4h}{Kr}\\) is “large” versus when\n\\(\\frac{4h}{Kr}\\) is “small”. (Later on\nwe will be more explicit about what exactly we mean by large versus\nsmall).\n\n\nShow code\n\nF <- function(N,h=0.5){N*(1-N) - h}\nx <- seq(-0.75,1.75,by=0.01)\ndf <- tibble(x=x)\np1 <- ggplot(df,aes(x)) + \n  geom_function(fun=F,args=list(h=0.08)) + \n  geom_hline(yintercept = 0,linetype=\"dashed\") + labs(x=\"N\",y=\"dN/dt\",title=TeX(\"$\\\\frac{4h}{Kr}$ small\"))\np2 <- ggplot(df,aes(x)) + geom_function(fun=F,args=list(h=0.3)) + \n  geom_hline(yintercept = 0,linetype=\"dashed\") + labs(x=\"N\",y=\"dN/dt\",title=TeX(\"$\\\\frac{4h}{Kr}$ large\"))\n(p1 | p2)\n\n\n\n\nThe two previous plots illustrate the following:\nIf \\(\\frac{4h}{Kr}\\) is\nsufficiently small then there are two positive steady-states for a\npopulation that obeys the harvesting model. Furthermore, one of these\nsteady-states will be a stable steady-state. The biological\ninterpretation is that when harvesting is small relative to the carrying\ncapacity and growth rate then the population can persist despite removal\ndue to harvesting.\nIf \\(\\frac{4h}{Kr}\\) is\nsufficiently large then there are no positive steady-states for a\npopulation that obeys the harvesting model and the population will\ndecrease over time. The biological interpretation is that when\nharvesting is large relative to the carrying capacity and growth rate\nthen the population cannot persist given the removal due to\nharvesting.\nIt should be intuitively obvious that there is a single intermediate\nstage (occurring when \\(\\frac{4h}{Kr} =\n1\\)) that separates the two situations that we just described. We\nsay that this model exhibits a bifurcation that occurs\nat some critical value for the relationship between the model\nparameters. Bifurcations are common in biomathematical models and we\nwill spend some time later reviewing those aspects of bifurcation\ntheory that are most frequently applied in biomathematics.\nBefore moving on, let’s look at some actual solutions to the\ndifferential equation\n\\(\\frac{dN}{dt} = r\\left(1 -\n\\frac{N}{K}\\right)N - h\\).\nWe will use the deSolve\npackage that implements numerical\nmethods for differential equations to compute said numerical\nsolutions. Later in the course we will explain in detail how to use the\ndeSolve package, for now we just display the results. (You\ncan also learn more about this by reading our R for\nBiomath page.)\n\n\nShow code\n\nharvest_model <- function(time,N,parms){\n  with(as.list(c(N,parms)),{\n    dN <- r*N*(1-N/K) - h\n    return(list(dN))\n  })\n}\ntimes1 <- seq(0,10,by=0.01)\nN <- c(N=0.25)\nsol1 <- data.frame(ode(N,times1,harvest_model,c(r=1,K=1,h=0.08)))\ntimes2 <- seq(0,1.4,by=0.01)\nsol2 <- data.frame(ode(N,times2,harvest_model,c(r=1,K=1,h=0.3)))\np1 <- ggplot(sol1,aes(x=time,y=N)) + geom_line(lwd=1) + labs(title=TeX(\"$\\\\frac{4h}{Kr}$ small\"))\np2 <- ggplot(sol2,aes(x=time,y=N)) + geom_line(lwd=1) + labs(title=TeX(\"$\\\\frac{4h}{Kr}$ large\"))\n(p1 | p2)\n\n\n\n\nWhat these two plots show is that when \\(\\frac{4h}{Kr}\\) is small the population\ngrows to some stable level (which is no longer the carrying capacity).\nOn the other hand, if \\(\\frac{4h}{Kr}\\)\nis too large the population crashes.\nWhat we have learned is that over fishing (or more generally over\nharvesting) will occur if the harvesting rate is critically greater than\nthe growth rate and carrying capacity together.\nNow that we have a feel for single-species population models, let’s\nexamine some problems that involve the interactions of two or more\nspecies.\nInteracting Populations\nThere are several different ways in which two or more species may\ninteract. Some of the most common are\npredator-prey interactions,\ncompetitive interactions, and\nmutualism.\nIn this subsection we will look at both predator-prey interactions\nand competitive interactions and save the topic of mutualism for\nlater.\nPredator-prey Interactions\nIn predator-prey interactions, one species persists by way of\nconsuming another. We start by assuming that this interaction is\nunidirectional in that the predator feeds on the prey (which is a\nlimited resource) but that the prey persists on some much more widely\navailable resource. Think of rabbits and foxes where the rabbit is the\nprey and the fox the predator.\nWe will also assume that predation is by far the most significant\ncause of death for the prey population. The following compartment\ndiagram provides an illustration of the idea behind the model.\n\n\n\nFigure 5: Compartment diagram of predator-prey model.\n\n\n\nIf we let \\(X(t)\\) denote the prey\npopulation and \\(Y(t)\\) denote the\npredator population, then under the simplest assumptions for the rates\nthe differential equation model corresponding to the compartment diagram\nis\n\\[\\begin{align}\n\\frac{dX}{dt} &= aX - bXY \\\\\n\\frac{dY}{dt} &= \\alpha b XY - d Y\n\\end{align}\\]\nWe will study the behavior of this model later, for now note the\nfollowing points:\nThe predators cannot persist in the absence of prey.\nAs the predator population increases there is a strong\npossibility for the prey population to decrease. If \\(Y\\) gets sufficiently large, then \\(bY\\) will be greater than \\(aX\\) which will result in \\(X\\) decreasing.\nOn the other hand, due to the first point, when \\(X\\) becomes too small then \\(Y\\) cannot grow very quickly, if at\nall.\nIf we take the last three points together, it seems like the\npredator-prey model may result in cyclic (periodic) behavior. In fact,\nperiodic behavior is a common feature of many mathematical models for\nbiological systems. Later in the course, we will study some techniques\nfor examining the existence of periodic dynamics.\nCompetitive Interactions\nHow is competition different from the predator-prey interaction? In\nthis situation, the two may not interact “directly” such as in the\npredator-prey relationship. However, since the two species are trying to\npersist in the same ecosystem and depend on the same resources there is\na competitive stress that could impact the mutual existence of both\nspecies. There are a few different ways in which competitive stress can\narise. Probably the simplest is the case that is captured by the\nfollowing compartment diagram.\n\n\n\nFigure 6: Compartment diagram of competition model.\n\n\n\nIf we denote by \\(N_{1}\\) the first\npopulation and by \\(N_{2}\\) the second,\nthen the corresponding differential equation model is\n\\[\\begin{align}\n\\frac{dN_{1}}{dt} &= b_{1}N_{1} - d_{1}N_{1}N_{2} \\\\\n\\frac{dN_{2}}{dt} &= b_{2}N_{2} - d_{2}N_{1}N_{2}\n\\end{align}\\]\nThe question that we can try to answer with the model (we will work\nout details later) is, can both species coexist or will one always out\ncompete the other. Later we will also see other ways in which two or\nmore species can compete.\nAnother Compartment Model\nExample\nCompartment models are often employed together with balance\nlaws. Balance laws arise from the fact that certain physical\nquantities such as mass, momentum, and energy are conserved in the sense\nthat they cannot be created or destroyed without the action of some\nintervening processes. Thus, the rate of change of a conserved quantity\nis specified by accounting for the in-flow, out-flow, and production\n(source) and degradation (sink) processes.\nAn important point to take into account is that not all common\nquantities are conserved. For example, one is often interested to\nconstruct a model for the rate of change in the concentration of some\nchemical. Concentration is not a conserved quantity. However, mass is\nconserved and concentration is mass per unit volume. Therefore, we can\nobtain a conserved quantity from a concentration by multiplying the\nconcentration by volume resulting in a quantity with units of mass.\nWe now present a simple example to illustrate a compartment\nmodel/balance law application. Suppose that we want to study pollution\nin a body of water of a fixed volume \\(V\\). Suppose that the pollutant flows into\nthe lake with constant concentration \\(c_{\\text{in}}\\) with in-flow rate \\(F\\) (in units of volume per unit time) and\nflows back out at the same rate. The following compartment diagram\ndisplays what is happening.\n\n\n\nFigure 7: Compartment diagram of lake pollutant model.\n\n\n\nIn words, we have\n\\(\\left\\{\\begin{array}{c} \\text{rate of\nchange} \\\\ \\text{pollutant mass} \\end{array}\\right\\} =\n\\left\\{\\begin{array}{c} \\text{mass} \\\\ \\text{in flow}\n\\end{array}\\right\\} - \\left\\{\\begin{array}{c} \\text{mass} \\\\ \\text{out\nflow} \\end{array}\\right\\}\\)\nThis leads to the following differential equation:\n\\(\\frac{d}{dt}(VC) = Fc_{\\text{in}} - F\nC,\\)\nor equivalently\n\\(\\frac{dC}{dt} = \\frac{F}{V}c_{\\text{in}}\n- \\frac{F}{V} C\\)\nIt is interesting to consider how the models changes if the volume of\nthe compartment is not constant but varies with time itself so that\n\\(V(t)\\). A simple problem along these\nlines will be taken up in the homework problems.\nNotice that the differential equation \\(\\frac{dC}{dt} = \\frac{F}{V}c_{\\text{in}} -\n\\frac{F}{V} C\\) has the form\n\\(\\frac{dx}{dt} = a - bx\\),\nwhich can be solved for a given initial condition by the method of\nseparation. In the homework you will be asked to do this, and to apply\nthe result to the lake pollutant problem. You should take a moment to\nthink about what you expect the behavior of a solution to such a\ndifferential equation to be based just on the form of the equation.\nSpecifically, think about the cases in which the right hand side will be\npositive versus when it will be negative. This will allow you to\ndetermine when the solution will be increasing with time versus when it\nwill be decreasing with time.\nAnother important application of compartment models is to model the\nspread of infectious diseases, this will be the topic covered in future\nnotes.\nFurther Reading\nIn our presentation of compartment models we have adapted the\ntreatments found in (Barnes and Fulford 2015; Calvetti and Somersalo 2013). As we\nproceed through the course, we will explore further the topic of\npopulation models. A great reference for going deeper into the study of\npopulation dynamics is (Kot\n2001).\nCompartment models and compartment diagrams abound in the\nbiomathematics research literature. It is an interesting a useful\nexercise to search through the literature, find a few papers that\ncontain compartment models or compartment diagrams, and study the\ncorrespondence between the compartment diagram and mathematical model\nappearing in the paper. To help you get started, notice that the paper\non inflammation modeling we referenced earlier (Herald 2010) contains a compartment\ndiagram. Furthermore, you can probably find a plethora of papers with\ncompartment modeling in any of the following journals or preprint\narchives:\nJournal of\nMathematical Biology\nJournal\nof Theoretical Biology\nBulletin of\nMathematical Biology\nMathematical\nBiosciences and Engineering\nPLos Computational\nBiology\narXiv on Quantitative\nBiology\n\n\n\nAllen, Linda J. S. 2011. An Introduction to Stochastic Processes\nwith Applications to Biology. Second. CRC Press, Boca Raton,\nFL. https://mathscinet.ams.org/mathscinet-getitem?mr=2560499.\n\n\nBarnes, B., and G. R. Fulford. 2015. Mathematical Modelling with\nCase Studies. Third. Textbooks in Mathematics.\nCRC Press, Boca Raton, FL. https://mathscinet.ams.org/mathscinet-getitem?mr=3288754.\n\n\nCalvetti, Daniela, and Erkki Somersalo. 2013. Computational\nMathematical Modeling. Mathematical Modeling and\nComputation. Society for Industrial and Applied\nMathematics (SIAM), Philadelphia, PA. https://mathscinet.ams.org/mathscinet-getitem?mr=3013353.\n\n\nHerald, Meagan C. 2010. “General Model of Inflammation.”\nBulletin of Mathematical Biology 72 (4): 765–79. https://doi.org/10.1007/s11538-009-9468-9.\n\n\nKot, Mark. 2001. Elements of Mathematical Ecology.\nCambridge University Press, Cambridge. https://doi.org/10.1017/CBO9780511608520.\n\n\n\n\n",
      "last_modified": "2022-03-05T14:28:03-05:00"
    },
    {
      "path": "notes005.html",
      "title": "Course Notes 5",
      "description": "Review of one-dimensional autonomous systems\n",
      "author": [
        {
          "name": "Jason M. Graham",
          "url": "https://topicsinbiomath.netlify.app/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\nContents\nGoals\nOverview\nOne-Dimensional\nAutonomous Systems\nEquilibria and\nStability\nBifurcations\nfor One-Dimensional Autonomous Systems\nPhaseR\n\n\nGoals\nAfter reading this section of notes, you should\nknow what is a one-dimensional autonomous system,\nknow the concepts of equilibrium and stability for\none-dimensional autonomous systems, and\ngain familiarity with the concept of a bifurcation for a\none-dimensional autonomous system.\nOverview\nPreviously, we have observed that for the logistic growth model\n\\(\\frac{dN}{dt} = rN\\left(1 -\n\\frac{N}{K}\\right),\\)\nthe constant solution \\(N=K\\) is a\nstable steady-state (or equilibrium). Further, we stated that the\nharvesting model\n\\(\\frac{dN}{dt} = rN\\left(1 -\n\\frac{N}{K}\\right) - h,\\)\nexhibits a bifurcation that occurs at some critical value for the\nrelationship between the model parameters.\nIn this section of notes, we review the concepts of equilibrium,\nstability, and bifurcation for one-dimensional autonomous systems. This\nmaterial may be familiar from a course in differential equations but we\nreview the basic concepts relevant for Topics in Biomathematics\nin a self-contained manner. A standard reference for this material is\nChapters 2 & 3 of (Strogatz 2015).\nOne-Dimensional Autonomous\nSystems\nWe call a differential equation of the form\n\\(\\frac{dx}{dt} = f(x),\\)\nwhere \\(f\\) is a differentiable\nfunction on the real numbers a one-dimensional autonomous\nsystem. The reason for the term autonomous is based on the\nfact that the right hand side of the differential equation does not\ndepend explicitly on the time variable \\(t\\).\nAlready we have seen examples of one-dimensional autonomous systems\nas both the logistic growth model and the harvesting models are cases.\nFurther examples include\n\\(\\frac{dx}{dt}=x(1-x)\\)\n\\(\\frac{d\\theta}{dt}=\\sin(\\theta)\\)\n\\(\\frac{dx}{dt}=x^2 +\n\\alpha\\)\nNotice that the expression of an one-dimensional autonomous system\nmay depend on one or more parameters. Sometimes it is convenient to make\nthe dependence on parameters explicit. In such cases, we use a semicolon\nto distinguish the dependent variable from parameters. For instance, for\nexample (c) we may write\n\\(\\frac{dx}{dt}=f(x;\\alpha),\\)\nwhere \\(f(x;\\alpha)=x^2 +\n\\alpha\\).\nAn important observation about one-dimensional autonomous systems is,\nsince \\(\\frac{dx}{dt}\\) is (by\ndefinition) the local slope of the function \\(x\\) as a function of \\(t\\), then by equality \\(f(x)\\) must also be the local slope of the\nfunction \\(x\\) but now for various\nvalues of \\(x\\) in the domain of \\(f\\).\nThe point is, if we sketch a graph of \\(y=f(x)\\) then we can easily see, based on\nwhere the graph is above or below the \\(x\\)-axis, where \\(x(t)\\) will be increasing or decreasing,\nrespectively.\nFor example, we plot \\(f(x)=x(1-x)\\). The arrows on the \\(x\\)-axis indicate the increasing (right\narrows) or decreasing (left arrows) behavior of the function \\(x\\).\n\n\nShow code\n\nf <- function(t,x,parameters){list(x*(1-x))}\na_phaseline <- phasePortrait(f,ylim   = c(-0.5, 1.5),\n                                        points = 10,\n                                        frac   = 0.5,\n                                        state.names = \"x\")\n\n\n\n\nSuch a plot is referred to as a phase-line and the\narrows indicate the one-dimensional flow for the point\n\\(x(t)\\) as it moves on the line as a\nparametric function of time \\(t\\).\nEquilibria and Stability\nIf\n\\(\\frac{dx}{dt}=f(x)\\)\nis an one-dimensional autonomous system, we say that a constant value\n\\(x^{\\ast}\\) is an\nequilibrium or steady-state for the\nsystem if \\(f(x^{\\ast}) = 0\\). Note\nthat an equilibrium is a (constant) solution to the differential\nequation. Further, note that equilibrium values are the \\(x\\)-intercepts for the graph \\(y=f(x)\\).\nGiven an one-dimensional autonomous system\n\\(\\frac{dx}{dt}=f(x),\\)\none finds the equilibria or steady-states for the system by finding\nall solutions to the equation \\(f(x) =\n0\\). In general this will be a nonlinear equation. Thus, in some\napplications it is necessary to utilize a root-finding\nalgorithm such as Newton’s\nmethod to find (approximately) the equilibrium values. (See also this\npost.) However, if \\(y=f(x)\\) can\nbe plotted then the equilibria can be studied qualitatively by using the\ngraph.\nExamples:\n\\(\\frac{dx}{dt}=x(1-x)\\) has\nequilibria \\(x^{\\ast}=0\\) and \\(x^{\\ast}=1\\).\n\\(\\frac{d\\theta}{dt}=\\sin(\\theta)\\) has\nequilibria \\(x^{\\ast}=n\\pi\\) where\n\\(n\\) is an integer.\n\\(\\frac{dx}{dt}=x^2 + \\alpha\\)\nhas equilibria \\(x^{\\ast}=\\pm\\sqrt{-\\alpha}\\) provided \\(\\alpha \\leq 0\\).\nRoughly speaking, an equilibrium \\(x^{\\ast}\\) for a one-dimensional autonomous\nsystem is said to be stable if, for any initial\ncondition \\(x_{0}\\) that is\nsufficiently close to \\(x^{\\ast}\\), the\ncorresponding solution \\(x(t)\\) to the\ninitial value problem\n\\[\\begin{align}\n\\frac{dx}{dt} &= f(x), \\\\\nx(0) &= x_{0},\n\\end{align}\\]\nsatisfies \\(x(t) \\rightarrow\nx^{\\ast}\\) as \\(t\\rightarrow\n\\infty\\). We refer to (Strogatz 2015) for a more mathematically\nrigorous definition of stability.\nConsider our previous phase-line plot for \\(\\frac{dx}{dt}=x(1-x)\\). This plot suggests\nthat \\(x^{\\ast}=1\\) is a stable\nequilibrium while \\(x^{\\ast}\\) is not.\nObserve that this equation is a special case of the logistic growth\nmodel with \\(r=1\\) and \\(K=1\\). Thus, for an initial condition \\(x_{0}\\), the solution to the corresponding\ninitial value problem is\n\\(x(t) = \\frac{x_{0}}{x_{0} +\n(1-x_{0})e^{-t}},\\)\nfrom which it is easy to see that if \\(x_{0}\\) is close to 1, then \\(x(t) \\rightarrow 1\\) as \\(t\\rightarrow \\infty\\).\nAs another example, let’s study the phase-line for \\(\\frac{dx}{dt}=x^2 - 1\\) which is a special\ncase of our example (c) with \\(\\alpha=-1\\). Here is the phase-line:\n\n\nShow code\n\nf2 <- function(t,x,parameters){list(x^2-1)}\na_phaseline <- phasePortrait(f2,ylim   = c(-1.5, 1.5),\n                                        points = 10,\n                                        frac   = 0.5,\n                                        state.names = \"x\")\n\n\n\n\nFrom this phase-line, it appears that \\(x^{\\ast}=-1\\) is a stable equilibrium while\n\\(x^{\\ast}=1\\) is not. In the next\nsubsection, we will confirm this using an analytic criterion.\nAn Analytic Criteria for\nStability\nSuppose that\n\\(\\frac{dx}{dt}=f(x)\\)\nis an one-dimensional autonomous system, that \\(x^{\\ast}\\) is an equilibrium, and that\n\\(f\\) is continuously differentiable at\n\\(x^{\\ast}\\). If\n\\(f'(x^{\\ast}) < 0,\\)\nthen \\(x^{\\ast}\\) is a stable\nequilibrium, while if\n\\(f'(x^{\\ast}) > 0\\),\nthen \\(x^{\\ast}\\) is not a stable\nequilibrium.\nThis is referred to as linear stability analysis and\nthe stated criterion is derived in section 2.4 of (Strogatz 2015). See also the blog post\non linear\nstability analysis.\nExample:\nConsider \\(\\frac{dx}{dt}=f(x)=x^2-1\\) with equilibria\n\\(x^{\\ast}=-1\\) and \\(x^{\\ast}=1\\). Since \\(f'(x) = 2x\\), we have\n\\(f'(-1)=-2 < 0\\)\nand\n\\(f'(1) = 2 > 0\\)\nThus, we can conclude that \\(x^{\\ast}=-1\\) is stable and \\(x^{\\ast}=1\\) is not. This corresponds with\nwhat we observed in the phase-line plot for this system.\nExercise: To test your understanding of what we have\ndone so far, use both the phase-line and the analytic criteria to\ndetermine the stability properties of the equilibria for \\(\\frac{d\\theta}{dt}=\\sin(\\theta)\\).\nBifurcations\nfor One-Dimensional Autonomous Systems\nConsider a one-dimensional autonomous system that depends on a\nparameter\n\\(\\frac{dx}{dt}=f(x;\\alpha),\\)\nthen since the equilibria are (real-valued) solutions in the \\(x\\) variable to\n\\(f(x;\\alpha) = 0,\\)\nin general the equilibrium values will be a function of the parameter\n\\(\\alpha\\). For example, if \\(f(x;\\alpha)=x^2+\\alpha\\), then the\nequilibria are \\(x^{\\ast}=\\pm\\sqrt{-\\alpha}\\) whenever \\(\\alpha \\leq 0\\).\nWe say that a bifurcation occurs at \\(\\alpha_{c}\\) if there is a change in either\nthe number of equilibria or the stability properties of an equilibrium\nas the value of \\(\\alpha\\) is varied\naway from \\(\\alpha_{c}\\).\nGoing back to our example \\(\\frac{dx}{dt}=x^2+\\alpha\\), we can already\nsee that there is a bifurcation at \\(\\alpha_{c}=0\\) because\nif \\(\\alpha > 0\\), then there\nare no equilibria,\nif \\(\\alpha = 0\\), then there is\nexactly one equilibrium value, and\nif \\(\\alpha <0\\), then there\nare exactly two equilibria. Further, as the graph of \\(f(x) = x^2+\\alpha\\) indicates whenever\n\\(\\alpha <0\\), one equilirium will\nbe stable and the other will not. We can confirm this using our analytic\ncriterion. Since \\(f'(x) = 2x\\), we\nhave\n\\(f'(\\sqrt{-\\alpha})=2\\sqrt{-\\alpha} >\n0\\) when \\(\\alpha < 0\\),\nwhile\n\\(f'(-\\sqrt{-\\alpha})=-2\\sqrt{-\\alpha} <\n0\\) when \\(\\alpha <\n0\\).\nThe type of bifurcation exhibited by \\(\\frac{dx}{dt}=x^2 + \\alpha\\) is known as a\nsaddle-node\nbifurcation. The key characteristics of any saddle-node bifurcation is\nthat, as one or more parameters are varied, the qualitative behavior of\nthe system is that we observe a sudden appearance of two equilibrium\nvalues, one stable, the other not. Thinking back to our previous\ndiscussion of the harvesting model, it is apparent that it also exhibits\na saddle-node bifurcation.\nIn general, bifurcation\ntheory is concerned with the study of how the qualitative behavior\nof solutions to a dynamical\nsystem, a system that varies with time, changes as parameters are\nvaried. This is important in biomathematics (as well as other areas of\nscience) because parameter values for a biological system can vary due\nto environmental impacts, experimental manipulation, effects of disease,\netc.\nLater in the course we will have cause to analyze the bifurcation\nbehavior of other mathematical models of biological systems. Thus, we\nwill take some time in lecture to learn a little more about bifurcation\ntheory.\nPhaseR\nThe R package phaseR can be used as an aid in the\nanalysis of one-dimensional autonomous systems. For example, the\nfollowing R code produces the phase-line for \\(\\frac{dx}{dt}=x(1-x)\\):\n\n\nlibrary(phaseR)\nf <- function(t,x,parameters){list(x*(1-x))}\na_phaseline <- phasePortrait(f,ylim   = c(-0.5, 1.5),\n                                        points = 10,\n                                        frac   = 0.5,\n                                        state.names = \"x\")\n\n\n\nThis assumes that you have installed the phaseR package.\nMore details regarding this package will be covered in lecture and\nexample use can be see in the R for\nBiomath page. The phaseR\ndocumentation covers its full usage.\n\n\n\nStrogatz, Steven H. 2015. Nonlinear Dynamics and Chaos. Second.\nWestview Press, Boulder, CO. https://mathscinet.ams.org/mathscinet-getitem?mr=3837141.\n\n\n\n\n",
      "last_modified": "2022-03-05T14:28:05-05:00"
    },
    {
      "path": "notes006.html",
      "title": "Course Notes 6",
      "description": "An introduction to epidemiological modeling. \n",
      "author": [
        {
          "name": "Jason M. Graham",
          "url": "https://topicsinbiomath.netlify.app/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\nContents\nGoals\nOverview\nInitial SIR Model\nNumerical Simulations\nIncorporating\nVaccination\nThe Role of Quarantines\n\nFurther Reading\n\nGoals\nAfter reading this section of notes, you should\nknow what is the basic SIR model, and\nhave a sense of how the SIR model may be extended to incorporate\nother features relevant to understanding the spread of infectious\ndiseases.\nOverview\nThe use of mathematical models, and differential equations\nspecifically to understand the spread of infectious diseases dates back\nat least to the 18th century. (See (Bacaër 2011; Bjornstad 2018; Britton 2003; Hadeler\n2017) for more aspects of the historical development of\nmathematical epidemiology.) However, the modern approach, an approach\nwhich is frequently used to this day, to mathematical epidemiology\nbegins in (Kermack and McKendrick 1927). Two things\nthat are quite interesting about this paper are\nthe authors clearly state a fundamental question about epidemics\nin a way that lends to a quantitative study, and\nthe authors write down a simple differential equations model now\nwidely known as the SIR model. This SIR model corresponds to a\ncompartment model and forms the basis for a lot of research in\nbiomathematics.\nThe basic idea of the SIR model is to divide a population into\ndistinct classes of individuals that are susceptible to infection,\nindividuals that are infected, and individuals that have recovered and\nbecome immune to infection. To point 1, in (Kermack and McKendrick 1927), the\nauthors write\n\nIn the course of time the epidemic may come to an end. One of the\nmost important problems in epidemiology is to ascertain whether this\ntermination occurs only when no susceptible individuals are left, or\nwhether the interplay of the various factors of infectivity, recovery\nand mortality, may result in termination, whilst many susceptible\nindividuals are still present in the unaffected population. Hence, our\nproblem is to understand what proportion of a population becomes\ninfected and how quickly this occurs. Given this knowledge, we can\nformulate better strategies for combating epidemics. Mathematical models\nare useful in this regard as well since we can modify the model by\nincorporating terms that correspond to a mitigation strategy.\n\nIn the next section, we will introduce the SIR model as a compartment\nmodel, our primary reference is Chapter 6 from (Hadeler\n2017).\nInitial SIR Model\nWe begin by considering an infectious disease like chickenpox or the\nannual flu over a relatively short period of time, say for example a\nsingle flu season. This will allow us to make the following simplifying\nassumptions:\nWe have a homogeneous population and can reasonably ignore birth and\ndeath processes.\nThe infection does not cause mortality.\nInfection of susceptibles occurs via contact with infecteds. We\nassume that infected individuals are mixing with others in the\npopulation in a random and independent fashion.\nThere is no latent period of infection.\nChances of recovery does not change during the course of\ninfection.\nInfectiousness does not change during the course of infection.\nThe following compartment diagram corresponds to (aspects of) our\nmodel assumptions.\n\n\nShow code\n\nknitr::include_graphics(\"./Figures/sir.png\")\n\n\n\n\nFigure 1: SIR compartment model for the spread of infectious disease.\n\n\n\nIf we let \\(\\beta\\) be the rate of\ninfection of susceptibles per number of infected, and if we let \\(\\gamma\\) be the recovery rate, then the\ndifferential equations corresponding to the compartment diagram are:\n\\[\\begin{align}\n\\frac{dS}{dt} &= -\\beta SI, \\\\\n\\frac{dI}{dt} &= \\beta SI - \\gamma I, \\\\\n\\frac{dR}{dt} &= \\gamma I.\n\\end{align}\\]\nLet’s make two notes regarding the model system.\nThe infection rate term \\(\\beta\nSI\\) is mathematically the same as the law of mass\naction. We will see this again when we study chemical reaction\nmodels later in the course. This “mass action” in the context of the SIR\nmodel can be justified with probabilistic arguments. Notice that if\nthere are no infected individuals, then no susceptible will ever become\ninfected. This is a reasonable fact.\nIf we add the three equations, we obtain \\(\\frac{dS}{dt}+\\frac{dI}{dt}+\\frac{dR}{dt}=0\\).\nSo, if \\(N=S+I+R\\) is the total\npopulation, we have that \\(\\frac{dN}{dt}=0\\) which implied that the\ntotal population is constant in time.\nWhat can we learn from the SIR model? Once we have developed some\nmore mathematical tools we will be able to learn quite a lot from the\nSIR model equations. For now, let’s look at the plot of solutions to the\nSIR equations under two different scenarios.\nObserve that in the previous equations, the \\(R\\) equation decouples from the \\(S\\) and \\(I\\) equations. Thus, it suffices to remove\nit from an analysis.\nNumerical Simulations\nWe can obtain numerical solutions to the SIR model equations using\nthe deSolve package in R. In a later lecture we will\nexplain in detail how to use the deSolve package. In the\nfollowing results, we display the graphs for the susceptible and\ninfected populations as functions of time. Two different situations are\nshown.\n\n\nShow code\n\nsir_model <- function(t,state,parameters){\n  with(as.list(c(state,parameters)),{\n    dx <- -R0*x*y\n    dy <- R0*x*y - y\n    \n    list(c(dx,dy))\n  })\n}\nstate <- c(x=0.90,y=0.1)\ntimes <- seq(0,15,by=0.1)\nsim1 <- as.data.frame(ode(y=state,times=times,func=sir_model,parms=c(R0=0.8)))\nsim2 <- as.data.frame(ode(y=state,times=times,func=sir_model,parms=c(R0=5.6)))\np1 <- sim1 %>% rename(susceptible=x,infected=y) %>% \n  pivot_longer(cols=c(susceptible,infected),names_to=\"state\",values_to=\"population\") %>%\n  ggplot(aes(x=time,y=population,color=state)) + geom_line(lwd=2,show.legend = FALSE) + ylim(c(0,1)) + \n  labs(x=\"time\",title=\"Susceptibles persist\") +  theme(text = element_text(size = 20)) \np2 <- sim2 %>% rename(susceptible=x,infected=y) %>% \n  pivot_longer(cols=c(susceptible,infected),names_to=\"state\",values_to=\"population\") %>%\n  ggplot(aes(x=time,y=population,color=state)) + geom_line(lwd=2) + ylim(c(0,1)) +\n  labs(x=\"time\",y=\"\",title=\"Susceptibles diminish\") +  theme(text = element_text(size = 20)) \n(p1 | p2)\n\n\n\n\nIn the plot on the left, only a small proportion of susceptible\nindividuals become infected and in the long term, “many susceptible\nindividuals are still present in the unaffected population” as the\nauthors say in (Kermack and McKendrick 1927). On the\nother hand, the right side plot shows the spread of an infection such\nthat little to no susceptible individuals remain uninfected.\nWhat is happening that leads to this distinct qualitative (and\nquantitative) difference in the outcome for the spread of the infection?\nAfter discussing dimensional analysis, we will show that there is a\nsingle numerical quantity, the magnitude of which very specifically\ndetermines the spread of the infection. This number is called \\(R_{0}\\).\nThere are many common variations on the basic SIR model. Some of\nthese attempt to include the effects such as a latent infection period,\nage-dependent infection rates, the spatial spread of infections, etc. We\nwill consider some further epidemiological models later in the course.\nYou are also invited to explore the literature on your own perhaps as\npart of your final project.\nIncorporating Vaccination\nA key application of SIR-type models is to study epidemic mitigation\nstrategies. Two common strategies for limiting the spread of an\ninfectious disease are vaccination and quarantine. Let’s consider how\nthe basic SIR model could be modified to incorporate vaccination. We\nexamine a scenario in which vaccination is implemented at the onset of a\ndisease outbreak.\nWhat component(s) of the SIR model needs to be changed? Assume that\nthe role of vaccination is to prevent infection of some proportion of\nsusceptible individuals thus “moving” some susceptibles directly to the\nrecovered on removed state. This can be modeled via a function \\(\\psi\\) that depends on the number of\nsusceptible and infected individuals resulting in\n\\[\\begin{align}\n\\frac{dS}{dt} &= -\\beta SI - \\psi(S,I), \\\\\n\\frac{dI}{dt} &= \\beta SI - \\gamma I, \\\\\n\\frac{dR}{dt} &= \\gamma I + \\psi(S,I).\n\\end{align}\\]\nReflections: Why should \\(\\psi\\) depend on both the number of\nsusceptible and infected individuals? What do you think will be the\nimpact of vaccination compared with the results fomr our numerical\nsimulations using the base SIR model?\nThe questions remains as to exactly is an appropriate expression for\nthe function \\(\\psi\\)? What would you\npropose initially? When we discuss functional forms later in the course\nwe will return to a discussion on this question.\nThe Role of Quarantines\nThe quarantine strategy differs from the vaccination strategy from a\nmodeling perspective in that it introduces a new compartment into the\n\\(S \\rightarrow I \\rightarrow R\\)\nscheme. At least some infected individuals are placed into quarantine\nbefore eventually moving into the recovered state.\nExercise: Draw an appropriate compartment diagram\nfor an SIR-type model that incorporates quarantine.\nIf we let the total population be \\(N=S+I+Q+R\\), where \\(Q\\) denotes the number of individuals in\nquarantine, then one SIR-type model incorporating quarantine is\n\\[\\begin{align}\n\\frac{dS}{dt} &= -\\beta \\frac{SI}{N-Q}, \\\\\n\\frac{dI}{dt} &= \\beta \\frac{SI}{N-Q} - \\gamma I -\\kappa I, \\\\\n\\frac{dQ}{dt} &= \\kappa I - \\sigma Q, \\\\\n\\frac{dR}{dt} &= \\gamma I + \\sigma Q.\n\\end{align}\\]\nQuestion: Do these model equations correspond to the\ncompartment diagram you came up with?\nExercise: Explain in words the meaning of the terms\nin the last set of equations.\nWe will study the model with quarantine in more detail later in the\ncourse. If you want to explore more about infections disease modleing,\nthe following section provides a list of sources to get you started.\nFurther Reading\nThe recent article (Artzrouni\n2020) provides an excellent and elementary exposition of\nepidemiological models including SIR. This paper discusses, along with\nsome basic principles of mathematical modeling, the usefulness of models\nfor understanding the recent COVID-19\npandmeic. This article is highly recommended and will be assigned\nreading a little later in the course.\nSome textbooks that contain substantial coverage of epidemiological\nmodeling include (Bjornstad 2018; Brauer and Castillo-Chavez 2012; Britton 2003), the textbook on\nmathematical modeling, (Calvetti and Somersalo 2013), introduces\nthe basic SIR model. A nice introduction to stochastic models for the\nspread of infectious disease may be found in (Allen 2011).\nThe research literature on mathematical epidemiology is vast. Some\naccessible papers that extend what we cover on epidemiological models in\nthis class are (Hethcote 1975, 2000, 1989). Other interesting papers include\n(Hethcote and Levin 1989; Ruan\nand Wang 2003; Schaffer and Kot 1985; van den Driessche and Watmough\n2002).\n\n\n\nAllen, Linda J. S. 2011. An Introduction to Stochastic Processes\nwith Applications to Biology. Second. CRC Press, Boca Raton,\nFL. https://mathscinet.ams.org/mathscinet-getitem?mr=2560499.\n\n\nArtzrouni, Marc. 2020. “Are Models Useful?\nReflections on Simple Epidemic Projection Models and the\nCovid-19 Pandemic.” The Mathematical\nIntelligencer 42 (3): 1–9. https://doi.org/10.1007/s00283-020-09997-7.\n\n\nBacaër, Nicolas. 2011. A Short History of Mathematical Population\nDynamics. Springer Science & Business Media.\n\n\nBjornstad, Ottar N. 2018. Epidemics: Models and\nData Using R. Use R!\nSpringer International Publishing. https://doi.org/10.1007/978-3-319-97487-3.\n\n\nBrauer, Fred, and Carlos Castillo-Chavez. 2012. Mathematical Models\nin Population Biology and Epidemiology. Second. Vol. 40. Texts in\nApplied Mathematics. Springer, New York. https://doi.org/10.1007/978-1-4614-1686-9.\n\n\nBritton, Nicholas F. 2003. Essential Mathematical Biology.\nSpringer Undergraduate Mathematics Series.\nSpringer-Verlag London, Ltd., London. https://doi.org/10.1007/978-1-4471-0049-2.\n\n\nCalvetti, Daniela, and Erkki Somersalo. 2013. Computational\nMathematical Modeling. Mathematical Modeling and\nComputation. Society for Industrial and Applied\nMathematics (SIAM), Philadelphia, PA. https://mathscinet.ams.org/mathscinet-getitem?mr=3013353.\n\n\nDriessche, P. van den, and James Watmough. 2002. “Reproduction\nNumbers and Sub-Threshold Endemic Equilibria for Compartmental Models of\nDisease Transmission.” In Mathematical\nBiosciences, 180:29–48. https://doi.org/10.1016/S0025-5564(02)00108-6.\n\n\nHadeler, Karl Peter. 2017. Topics in Mathematical Biology.\nLecture Notes on Mathematical Modelling in the Life Sciences. Springer,\nCham. https://doi.org/10.1007/978-3-319-65621-2.\n\n\nHethcote, Herbert W. 1975. “Mathematical Models for the Spread of\nInfectious Diseases.” In Epidemiology (Proc.\nSIMS Conf., Alta, Utah,\n1974), 122–31. https://mathscinet.ams.org/mathscinet-getitem?mr=0403724.\n\n\n———. 1989. “Three Basic Epidemiological Models.” In\nApplied Mathematical Ecology (Trieste, 1986),\n18:119–44. Biomathematics. Springer, Berlin. https://doi.org/10.1007/978-3-642-61317-3_5.\n\n\n———. 2000. “The Mathematics of Infectious Diseases.”\nSIAM Review 42 (4): 599–653. https://doi.org/10.1137/S0036144500371907.\n\n\nHethcote, Herbert W., and Simon A. Levin. 1989. “Periodicity in\nEpidemiological Models.” In Applied Mathematical Ecology\n(Trieste, 1986), 18:193–211. Biomathematics.\nSpringer, Berlin. https://doi.org/10.1007/978-3-642-61317-3_8.\n\n\nKermack, William Ogilvy, and Anderson G. McKendrick. 1927. “A\nContribution to the Mathematical Theory of Epidemics.”\nProceedings of the Royal Society of London. Series A, Containing\nPapers of a Mathematical and Physical Character 115 (772): 700–721.\n\n\nRuan, Shigui, and Wendi Wang. 2003. “Dynamical Behavior of an\nEpidemic Model with a Nonlinear Incidence Rate.” Journal of\nDifferential Equations 188 (1): 135–63. https://doi.org/10.1016/S0022-0396(02)00089-X.\n\n\nSchaffer, William M., and Mark Kot. 1985. “Nearly One-Dimensional\nDynamics in an Epidemic.” Journal of Theoretical Biology\n112 (2): 403–27. https://doi.org/10.1016/S0022-5193(85)80294-0.\n\n\n\n\n",
      "last_modified": "2022-03-05T14:28:08-05:00"
    },
    {
      "path": "notes007.html",
      "title": "Course Notes 7",
      "description": "An introduction to the chemostat. \n",
      "author": [
        {
          "name": "Jason M. Graham",
          "url": "https://topicsinbiomath.netlify.app/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\nContents\nGoals\nOverview\nThe Chemostat Model\nFurther Reading\n\nGoals\nAfter reading this section of notes, you should\nknow what a chemostat is, and\nknow the basic mathematical model corresponding to the\nchemostat.\nOverview\nA chemostat is\nan experimental apparatus that can be used to culture microorganisms in\na controlled fashion. A chemostat is set up to allow one to pump a\nsterile nutrient into the growth chamber of the apparatus at a constant\nrate, keeping the volume within the growth chamber constant by allowing\nexcess medium to flow out. From an ecological point of view, the\nchemostat is interesting because it provides insight into the carrying\ncapacity. For our purposes, we will use the chemostat as motivation for\na discussion on functional forms (to be defined later) and reaction\nkinetics. Finally, the chemostat is a topic of interest in much of the\nresearch literature in biomathematics, see for example (Butler\nand Waltman 1981; Butler, Hsu, and Waltman 1985; Butler and Wolkowicz 1985; Nowack and Klapper 2018; Smith and\nWaltman 1995). An introduction to the chemostat along the\nlines of what we do in these notes can be found in any of (Allen 2007; Edelstein-Keshet 2005; Kot\n2001).\nBefore we develop a mathematical model for the chemostat it is\nhelpful to see what one looks like. Good illustrations can be found at\nthe Wikipedia page for\nchemostat or at this image\nlink.\nThe Chemostat Model\nThe chemostat possesses the following features that we can exploit to\ndevelop a mathematical model for the nutrient limited growth of an\norganism:\nThere is a regular supply of nutrient of constant concentration\n\\(C_{0}\\) that is pumped into the\ngrowth chamber at a volumetric flow rate \\(F\\).\nThe growth chamber is kept at constant volume \\(V\\).\nAfter being well-mixed with nutrient in the growth chamber, any\nexcess nutrient and biomass are removed at a volumetric flow rate \\(F\\).\nThe growth rate of the microorganism is a function of the\nconcentration of nutrient within the growth chamber.\nWe can represent this using a compartment modeling approach.\nThe following compartment diagram corresponds to (aspects of) our\nmodel assumptions.\n\n\n\nFigure 1: Chemostat compartment model for nutrient limited growth of a\nmicroorgansim.\n\n\n\nLet \\(C(t)\\) be the concentration of\nnutrient in the growth chamber at time \\(t\\) and let \\(N(t)\\) be the concentration of\nmicroorganism in the growth chamber at time \\(t\\). The nutrient mass \\(VC(t)\\) and microorganism biomass \\(VN(t)\\) must be conserved. Thus, a balance\nlaw leads to the following system of differential equations:\n\\[\\begin{align}\n\\frac{dVN}{dt} &= G(C)VN - FN,  \\\\\n\\frac{dVC}{dt} &= FC_{0} - \\alpha G(C)VN - FC,\n\\end{align}\\]\nor equivalently\n\\[\\begin{align}\n\\frac{dN}{dt} &= G(C)N - \\frac{F}{V}N,  \\\\\n\\frac{dC}{dt} &= \\frac{F}{V}C_{0} - \\alpha G(C)N - \\frac{F}{V}C.\n\\end{align}\\]\nIn the previous system of equations, the function \\(G(C)\\) is the nutrient limited growth rate\nfor the microorganism and \\(\\alpha\\) is\na constant of proportionality. We do not know a priori the\nexact manner in which the growth rate will depend on the nutrient\nconcentration. A particular choice for \\(G(C)\\) is an example of what we call a\nfunctional form. Thus, in order to complete our\nmathematical modeling we need to specify a functional form for \\(G\\). One of the perennial challenges of\nmathematical modeling is to choose an appropriate functional form for a\nterm or terms in a mathematical model.\nThere is one clear property that we know the function \\(G\\) must satisfy, that is \\(G(0)=0\\). This represents an extreme\nsituation and it is often helpful to consider extreme situations in\norder to motivate constraints that need to be placed on a functional\nform. Another type of extreme is asymptotic behavior. For example, what\ndo we expect about \\(\\lim_{C \\rightarrow\n\\infty}G(C)\\)?\nWhen thinking about functional forms, we may also want to consider\nqualitative behaviors such as increasing/decreasing behavior, concavity,\netc. For example, it seems reasonable to assume that the nutrient\nlimited growth rate function \\(G(C)\\)\nis increasing. As a simple first approximation, we could choose \\(G(C)\\) to be a linear function, then we\nwould have the following model system:\n\\[\\begin{align}\n\\frac{dN}{dt} &= aCN - \\frac{F}{V}N,  \\\\\n\\frac{dC}{dt} &= \\frac{F}{V}C_{0} - \\alpha aCN - \\frac{F}{V}C.\n\\end{align}\\]\nLater we will analyze this previous system of equations in order to\nsee what type of behavior is predicted. For now, consider the following:\na consequence of assuming \\(G(C)=aC\\)\nis that \\(\\lim_{C \\rightarrow \\infty}G(C) =\n\\infty\\). Do you think that this is an accurate reflection of\nreality? Why or why not? Might it be more realistic to have \\(\\lim_{C \\rightarrow \\infty}G(C) = L\\) for\nsome constant value \\(L\\)? All of these\nquestions are addressed in detail in the next lecture.\nFurther Reading\nAs noted already, an introductory treatment of the chemostat may be\nfound in any of (Allen 2007; Edelstein-Keshet 2005; Kot\n2001) as well as the online lecture notes by Sontag.\nTo get a sense of what type of problems and applications are\nassociated with the chemostat in research, a good place to start is with\none or more of the following (Butler\nand Waltman 1981; Butler, Hsu, and Waltman 1985; Butler and Wolkowicz 1985; Nowack and Klapper 2018; Smith and\nWaltman 1995).\n\n\n\nAllen, Linda J. S. 2007. Introduction to Mathematical Biology.\nPearson/Prentice Hall. https://agris.fao.org/agris-search/search.do?recordID=US201300115181.\n\n\nButler, G. J., S. B. Hsu, and Paul Waltman. 1985. “A Mathematical\nModel of the Chemostat with Periodic Washout Rate.” SIAM\nJournal on Applied Mathematics 45 (3): 435–49. https://doi.org/10.1137/0145025.\n\n\nButler, G. J., and Paul Waltman. 1981. “Bifurcation from a Limit\nCycle in a Two Predator-One Prey Ecosystem Modeled on a\nChemostat.” Journal of Mathematical Biology 12 (3):\n295–310. https://doi.org/10.1007/BF00276918.\n\n\nButler, G. J., and G. S. K. Wolkowicz. 1985. “A Mathematical Model\nof the Chemostat with a General Class of Functions Describing Nutrient\nUptake.” SIAM Journal on Applied Mathematics 45 (1):\n138–51. https://doi.org/10.1137/0145006.\n\n\nEdelstein-Keshet, Leah. 2005. Mathematical Models in Biology.\nVol. 46. Classics in Applied Mathematics. Society for\nIndustrial and Applied Mathematics (SIAM), Philadelphia, PA. https://doi.org/10.1137/1.9780898719147.\n\n\nKot, Mark. 2001. Elements of Mathematical Ecology.\nCambridge University Press, Cambridge. https://doi.org/10.1017/CBO9780511608520.\n\n\nNowack, Shane, and Isaac Klapper. 2018. “Exclusion in a Temporally\nVarying Chemostat System: Dependence on Trade-Offs.” SIAM\nJournal on Applied Mathematics 78 (5): 2819–39. https://doi.org/10.1137/17M1144210.\n\n\nSmith, Hal L., and Paul Waltman. 1995. The Theory of the\nChemostat. Vol. 13. Cambridge Studies in\nMathematical Biology. Cambridge University Press,\nCambridge. https://doi.org/10.1017/CBO9780511530043.\n\n\n\n\n",
      "last_modified": "2022-03-05T14:28:10-05:00"
    },
    {
      "path": "notes008.html",
      "title": "Course Notes 8",
      "description": "Functional forms. \n",
      "author": [
        {
          "name": "Jason M. Graham",
          "url": "https://topicsinbiomath.netlify.app/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\nContents\nGoals\nOverview\nSome Common Functional\nForms\nMichaelis-Menten\nForm in the Chemostat Model\nThe Spruce Budworm\nModel\nFurther Reading\n\nGoals\nAfter reading this section of notes, you should\nappreciate the concept of a functional form, and\nknow the type I, II, and III functional forms and some of their\nproperties.\nOverview\nRecall the differential equations for our mathematical model of the\nchemostat:\n\\[\\begin{align}\n\\frac{dN}{dt} &= G(C)N - \\frac{F}{V}N,  \\\\\n\\frac{dC}{dt} &= \\frac{F}{V}C_{0} - \\alpha G(C)N - \\frac{F}{V}C.\n\\end{align}\\]\nIn order for this model to be useful, we need to obtain an explicit\nexpression, or a functional form for the nutrient\ndependent growth rate function \\(G(C)\\). Further, recall our discussion on\nincorporating vaccination into the basic SIR model. This led to the\nfollowing system of equations:\n\\[\\begin{align}\n\\frac{dS}{dt} &= -\\beta SI - \\psi(S,I), \\\\\n\\frac{dI}{dt} &= \\beta SI - \\gamma I, \\\\\n\\frac{dR}{dt} &= \\gamma I + \\psi(S,I).\n\\end{align}\\]\nTo apply this model, we need an appropriate functional form for \\(\\psi\\).\nIn these notes we address this and begin a larger discussion of some\nfunctional forms that occur commonly in mathematical biology. Before\ndoing that, as additional motivation, let’s look at two more modeling\nsituations that require further consideration regarding the\nspecification of a functional form.\nRemember that for a time-dependent population \\(N(t)\\), we refer to the quantity \\(\\frac{1}{N}\\frac{dN}{dt}\\) as the\nper-capita rate of growth. A differential equation model for the growth\nof a population may be obtained by specifying a functional form for the\nper-capita rate of growth \\(F(N)\\),\nsince then we obtain\n\\(\\frac{1}{N}\\frac{dN}{dt}=F(N),\\)\nor equivalently\n\\(\\frac{dN}{dt}=NF(N).\\)\nOnce an explicit expression is given for \\(F(N)\\), the behavior of the growth of the\npopulation can be explored by analyzing the differential equation \\(\\frac{dN}{dt}=NF(N)\\). We have already seen\ntwo examples of this, one where \\(F(N) =\nr\\), a constant, and another where \\(F(N) = r\\left(1 - \\frac{N}{K}\\right)\\).\nFurther, many differential equation models for predator-prey\ninteractions take the form\n\\[\\begin{align}\n\\frac{dU}{dt} &= rU\\left(1-\\frac{U}{K}\\right) - V\\Phi(U),  \\\\\n\\frac{dV}{dt} &= \\alpha V\\Phi(U) - \\beta V.\n\\end{align}\\]\nIn these equations, \\(U\\) is the\nprey population and \\(V\\) is the\npredator population. The function \\(\\Phi(U)\\) is called the predator\nfunctional response. To complete the last system of\ndifferential equations and apply them to a particular situation, we need\nan explicit expression for \\(\\Phi(U)\\).\nExercise: Provide an explanation for the meaning of\n\\(\\Phi(U)\\) in the previous\nequations.\nFor a mathematical model, how does one determine an appropriate\nfunctional form? Unfortunately, there is no universal principle or\ngeneral technique for determining functional forms. This should not be\ntoo much of a surprise given the fact that there are infinitely many\nfunctions to choose from. Then how do we solve the seemingly impossible\nproblem of selecting functional forms? The answer is through a mix of\nexamples, experience, intuition, careful reasoning, and hard work.\nSome Common Functional Forms\nIn this section, we list a few functional forms that occur frequently\nin the mathematical biology literature. In fact, the functional forms\nthat we list here are so common that they have names associated with\nthem, at least when they occur in the context of mathematical ecology.\nThe functional forms to which we are referring are:\nHolling Type I - \\(f(x) = a\nx\\),\nHolling Type II - \\(f(x) = \\frac{ax}{b +\nx}\\), and\nHolling Type III - \\(f(x) =\n\\frac{ax^2}{b^2 + x^2}\\).\nNotice that all three of the previous functions are increasing\nfunctions of \\(x\\) on \\((0,\\infty)\\) (we assume that the parameters\n\\(a\\) and \\(b\\) are positive). In the homework, you\nwill explore important qualitative differences between the three Holling\ntype functional forms. For reasons that we will see later, the Holling\nType II functional response is also sometimes called a\nMichaelis-Menten response. Let’s examine a situation\nwhere a Holling Type II functional response arises as an appropriate\nchoice for a functional form in a mathematical model.\nMichaelis-Menten\nForm in the Chemostat Model\nIn this section, we follow the presentation from (Edelstein-Keshet 2005) to look at an\nexample in which a Holling Type II, or Michaelis-Menten functional form\narises naturally. (See also the online notes by Sontag.)\nIn order to derive an appropriate functional form for the nutrient\ndependent rate of growth \\(G(C)\\) in\nthe chemostat model, let’s look in more detail at the biochemical\nprocesses involved in cellular consumption of a nutrient substance like\nglucose. We view the nutrient as a substrate\nmolecule that will bind with receptor\nproteins at the surface membrane of the cell. The molecular\nreceptors at the cell membrane capture nutrient molecules and then\ntransport the resulting nutrient/receptor complex through the membrane\nand then finally release the nutrient into the cell body. This is\nnecessary since water-soluble molecules are unable to permeate the cell\nmembrane. Figure 1 illustrates the process.\n\n\n\nFigure 1: Nutrient transport at cell membrane (from Biology\nLibreTexts).\n\n\n\nOnce the nutrient is released into the cell body, the membrane\nreceptor is free again to bind with another nutrient molecule. This\nresults in a sort of “conveyor-belt” procedure. However, when a cell is\n“surrounded by” nutrient as is the case in a chemostat, there is usually\na much greater concentration of available nutrient than there is unbound\nmembrane receptor proteins, a situation illustrated in Figure\n2. The result is a “saturation effect” due to the\nlimited number of available receptors, an important observation that we\nwill return to soon.\n\n\n\nFigure 2: The conveyor belt model from (Edelstein-Keshet 2005).\n\n\n\nIf we denote the external nutrient by \\(C\\), unoccupied receptors by \\(X_{0}\\), an occupied receptor by \\(X_{1}\\), and a nutrient molecule\nsuccessfully transported in the cell body by \\(P\\), then the scenario described above and\nrepresented in Figure 2 can be written as a chemical\nreaction: \\[\\begin{align}\n&C + X_0 \\rightleftharpoons X_1\\\\\n&X_1 \\rightarrow P + X_0\n\\end{align}\\]\nNotice that the first reaction is reversible while\nthe second is irreversible. Basically this says that a\nmolecule of \\(C\\) binds with an\nunoccupied receptor \\(X_{0}\\) to form a\ncomplex \\(X_{1}\\) which results in a\nproduct \\(P\\) of transported nutrient\nand a free receptor \\(X_{0}\\). The rate\nof these reactions are specified by constants \\(k_{1}\\) (first forward reaction), \\(k_{-1}\\) (first reverse reaction) and \\(k_{2}\\) (second forward reaction). The\nrate constants are essentially constants of\nproportionality that describe how likely the reactions are to result in\nthe specified products.\nTo convert the chemical equations into differential equations for the\nrate of change of the concentration of the molecules involved we apply\nthe law of mass action. This states that when two or\nmore reactants are involved in a reaction step, the rate of reaction is\nproportional to the product of their concentrations. (Note the\nsimilarity with what we saw in the SIR model.) Following a commonly used\nconvention, we denote the concentrations of molecules \\(C\\), \\(X_{0}\\), \\(X_{1}\\) and \\(P\\) by the corresponding lower-case letters\n\\(c\\), \\(x_{0}\\), \\(x_{1}\\), and \\(p\\) respectively. The law of mass action\nthen gives\n\\[\\begin{align}\n  \\frac{dc}{dt} & = -k_{1}cx_{0} + k_{-1}x_{1},\\label{eq:MM1a} \\\\\n  \\frac{dx_{0}}{dt} & = -k_{1}cx_{0} + k_{-1}x_{1} + k_{2}x_{1},\n\\label{eq:MM1b} \\\\\n  \\frac{dx_{1}}{dt} & = k_{1}cx_{0} - k_{-1}x_{1} - k_{2}x_{1},\n\\label{eq:MM1c} \\\\\n  \\frac{dp}{dt} & = k_{2}x_{1}.  \\label{eq:MM1d}\n\\end{align}\\]\nAgain, note that the law of mass action is analogous to deriving\nmodels for the spread of an infectious disease, where we assumed that\nthe rate in which susceptibles become infected is proportional to the\nproduct of susceptible and infected. Using the law of mass action to\nderive differential equations for chemical reactions is fundamental to\nresearch in biochemistry and systems biology, this is something we will\nreturn to again later.\nHow does this lead us to a Holling Type II functional response? We\nneed to do a little more work to get there. Specifically, we want to\nsimplfy the last set of equations which we can begin to do by observing\nthat\nthe last equation is decoupled from the others since \\(p\\) does not appear in any of the first\nthree equations, and\neven more importantly, we can add up the second and third\nequation to obtain \\(\\frac{dx_{0}}{dt} +\n\\frac{dx_{1}}{dt}=0\\) which imples that \\(x_{0}+x_{1} = \\text{constant}\\). For\nnotational purposes, set \\(x_{0}+x_{1}=r\\). (Note again how there is\nan analog with the SIR model.)\nBy solving for one of \\(x_{0}\\) or\n\\(x_{1}\\) in terms of the other, we can\neliminate another differential equation. Let us write \\(x_{0} = r - x_{1}\\) and substitute this\ninto our equations to obtain \\[\\begin{align}\n  \\frac{dc}{dt} & = -k_{1}c(r - x_{1}) + k_{-1}x_{1} = -k_{1}rc +\n(k_{-1} + k_{1}c)x_{1},\\label{eq:MM2a} \\\\\n  \\frac{dx_{1}}{dt} & = k_{1}c(r - x_{1}) - k_{-1}x_{1} - k_{2}x_{1}\n= k_{1}rc - (k_{-1} + k_{2} + k_{1}c)x_{1}. \\label{eq:MM2b}\n\\end{align}\\]\nLet’s reflect on what these equations model. They tell us the rate of\nchange of the concentrations of the nutrient (\\(c\\)) and of the bound cell membrane\nreceptors (\\(x_{1}\\)). At this point,\nwe have reduced a system of four ODEs to an equivalent system of two.\nHowever, there is one additional simplification that can be made and\nthis is where our intuition plays an important role.\nAs we mentioned previously and as illustrated in Figure 2, we expect\nthat there is far more available nutrient than there are available\nreceptors. Thus, we assume that \\(x_{0}\\) will very quickly reach zero and\nhence \\(x_{1}\\) will very quickly reach\na steady-state value \\(r\\). In other\nwords, it is reasonable to assume that \\(\\frac{dx_{1}}{dt} = 0\\), an assumption\nknown as the quasi-steady-state assumption, which\nreduces the last two differential equations further to \\[\\begin{align}\n  \\frac{dc}{dt} & = -k_{1}c(r - x_{1}) + k_{-1}x_{1} = -k_{1}rc +\n(k_{-1} + k_{1}c)x_{1},\\label{eq:MM3a} \\\\\n   0 & = k_{1}c(r - x_{1}) - k_{-1}x_{1} - k_{2}x_{1} = k_{1}rc -\n(k_{-1} + k_{2} + k_{1}c)x_{1}, \\label{eq:MM3b}\n\\end{align}\\] one differential equation and one algebraic\nequation. Using some algebra, we can solve the equation\n\\(k_{1}rc - (k_{-1} + k_{2} + k_{1}c)x_{1}\n= 0\\)\nfor \\(x_{1}\\). Specifically,\n\\(x_{1} = \\frac{k_{1}rc}{k_{-1}+k_{2} +\nk_{1}c} = r \\frac{c}{\\left(\\frac{k_{-1}+k_{2}}{k_{1}}\\right) +\nc},\\)\nan expression that shoud remind you of a Holling Type II functional\nform. The quasi-steady-state hypothesis can actually be put on a more\nfirm mathematical foundation by using techniques from singular\nperturbation theory, a topic that we will discuss a bit later in the\ncourse. If we substitute the identity,\n\\(x_{1} = r\n\\frac{c}{\\left(\\frac{k_{-1}+k_{2}}{k_{1}}\\right) + c}\\)\ninto the last equation for \\(\\frac{dc}{dt}\\), we obtain\n\\[\\begin{align}\n  \\frac{dc}{dt} &= -k_{1}rc + (k_{-1} + k_{1}c)r\n\\frac{c}{\\left(\\frac{k_{-1}+k_{2}}{k_{1}}\\right) + c} \\\\\n  &=\nrc\\left[\\frac{-k_{1}\\left[\\left(\\frac{k_{-1}+k_{2}}{k_{1}}\\right) +\nc\\right] + k_{-1} k_{1}c}{\\left(\\frac{k_{-1}+k_{2}}{k_{1}}\\right) + c}\n\\right] \\\\\n  &= rc\\left[ \\frac{-k_{-1}-k_{2} - k_{1}c + k_{-1} +\nk_{1}c}{\\left(\\frac{k_{-1}+k_{2}}{k_{1}}\\right) + c} \\right] \\\\\n  &= rc\\left[ \\frac{-k_{2}}{\\left(\\frac{k_{-1}+k_{2}}{k_{1}}\\right)\n+ c} \\right] \\\\\n  &= -k_{2}r\\frac{c}{\\left(\\frac{k_{-1}+k_{2}}{k_{1}}\\right) + c}\n\\end{align}\\]\nNow define \\(K_{\\text{max}} =\nk_{2}r\\) and \\(k_{n} = \\frac{k_{-1} +\nk_{2}}{k_{1}}\\), then we can write the above result as \\[\\begin{align}\n  \\frac{dc}{dt} = -\\frac{K_{\\text{max}}c}{k_{n} + c},\n\\label{eq:MMratelaw}\n\\end{align}\\] which is commonly referred to as the\nMichaelis-Menten rate law. What this says is that the\nconsumption rate of the nutrient is proportional to a function of the\nform\n\\[ f(c) = K_{\\text{max}}\\frac{c}{k_{n} +\nc}, \\]\na Michaelis-Menten function or a Holling Type II functional form.\nIn order to get a better understanding of the Holling Type II\nfunctional response, let’s look at the graph of the function \\(f(x) = \\frac{x}{1+x}\\).\n\n\nShow code\n\nF <- function(x){x/(1+x)}\nx <- seq(0,3,by=0.01)\ndf <- tibble(x=x)\nggplot(df,aes(x)) + \n  geom_function(fun=F,lwd=1) + \n  labs(x=\"x\",y=TeX(\"$f(x) = \\\\frac{x}{1+x}$\"),\n       title=\"Shape of the graph of Holling Type II\")\n\n\n\n\nNote that the graph of any Holling Type II functional form will have\nthe same shape as the previous graph.\nYou may be wondering what is the meaning of the parameters \\(K_{\\text{max}}\\) and \\(k_{n}\\) in the function \\(f(c) = K_{\\text{max}}\\frac{c}{k_{n} + c}\\).\nWell, \\(K_{\\text{max}}\\) is the limit\nof \\(f(c)\\) as \\(c\\rightarrow \\infty\\). You can think of\n\\(K_{\\text{max}}\\) as the theoretical\nmaximum rate of consumption. Next, notice that\n\\(f(k_{n}) =\n\\frac{K_{\\text{max}}}{2}.\\)\nThus, \\(k_{n}\\) is the concentration\nlevel at which the rate of consumption is exactly half of the\ntheoretical maximum rate of consumption. No matter how much nutrient is\navailable, a cell can never consume at a rate greater than \\(K_{\\text{max}}\\), this encapssulates the\nsaturation effect we have been hinting at. There is a common method for\nestimating the values of \\(K_{\\text{max}}\\) and \\(k_{n}\\) given appropriate data. This method\narises from the following observation:\n\\(\\frac{1}{f(c)} = \\frac{k_{n} +\nc}{K_{\\text{max}}c} = \\frac{k_{n}}{K_{\\text{max}}}\\frac{1}{c} +\n\\frac{1}{K_{\\text{max}}}.\\)\nThe previous expression is a linear equation in \\(\\frac{1}{c}\\) with slope \\(\\frac{k_{n}}{K_{\\text{max}}}\\) and \\(y\\)-intercept \\(\\frac{1}{K_{\\text{max}}}\\). The point is,\nif we have data for the rate \\(\\frac{dc}{dt}\\) and the concentrations\n\\(c\\), then the relation\n\\(-\\frac{1}{\\frac{dc}{dt}} =\n\\frac{k_{n}}{K_{\\text{max}}}\\frac{1}{c} +\n\\frac{1}{K_{\\text{max}}}\\)\nallows us to estimate \\(K_{\\text{max}}\\) and \\(k_n\\). For more on this, see our post on fitting\na line to data.\nThe Spruce Budworm Model\nIn this section, we look at an example in which a Holling Type III\nfunctional form arises naturally. Whenever a functional form is expected\nto increase as a function of its input but with a saturating\ncharacteristic one might be inclined to try a Holling Type II functional\nresponse. This is good thinking but there may be additional features at\nplay that should be taken into account. There is a well-known problem\nthat illustrates the point we are getting at here.\nThe spruce budworm model seeks to study the outbreak of an insect\nknown as the spruce budworm\nthat is considered a pest due to the negative impact these insects can\nhave on a tree population. The mathematical model attempts to capture\nthe population growth of the budworm assuming logistic growth and\npredation. The general form for the mathematical model is\n\\(\\frac{dN}{dt} = rN\\left(1 -\n\\frac{N}{K}\\right) - p(N),\\)\nwhere \\(p(N)\\) is the death rate due\nto predation (mainly by birds) of the insect. It is natural to assume\nthat \\(p(N)\\) saturates because birds\ncan only eat so many budworms. On the other hand, since the relevant\nbirds eat more than just the budworm, they will not expend a great deal\nof energy to seek out the budworm for predation unless there are\nsufficiently many budworms available. In other words, if \\(N\\) is very near zero, one expects that\n\\(p(N)\\) should be relatively small.\nThis is not a feature of a Holling Type II functional response but it is\na feature of a Holling Type III response. To see this, let’s graph \\(f(x)=\\frac{x^2}{1+x^2}\\) which is\nrepresentative in terms of shape of a Holling Type III response.\n\n\nShow code\n\nF <- function(x){x^2/(1+x^2)}\nx <- seq(0,3,by=0.01)\ndf <- tibble(x=x)\nggplot(df,aes(x)) + \n  geom_function(fun=F,lwd=1) + \n  labs(x=\"x\",y=TeX(\"$f(x) = \\\\frac{x^2}{1+x^2}$\"),\n       title=\"Shape of the graph of Holling Type II\")\n\n\n\n\nNote the change in concavity that occurs near 0.5. (In the homework\nyou will be asked to determine the exact location of the inflection\npoint.)\nUsing a Holling Type III functional response for \\(p(N)\\), the spruce budworm model\nbecomes\n\\(\\frac{dN}{dt} = rN\\left(1 -\n\\frac{N}{K}\\right) - \\gamma \\frac{N^2}{1+N^2}.\\)\nThis demonstrates that one may have to take into account concavity as\nwell and increasing/decreasing behavior when choosing an appropriate\nfunctional form.\nLater we will see that the the spruce budworm exhibits some\ninteresting behavior. In particular, the spruce budworm model exhibits a\nsaddle-node\nbifurcation.\nFurther Reading\nWe are not aware of any single reference that provides a general\ndiscussion of functional forms in biomathematics. However, an excellent\nexercise is to look at a few papers from the literature and pay close\nattention to what functional forms appear in models. You may also want\nto try to figure out why the authors have chosen to use the functional\nform that they employ. Some good places to start are:\nthe paper (Gerlee\n2013) that considers a number of simple growth laws for a\ntumor population,\nthe recent paper (Alonso Izquierdo, González León, and de la Torre\nMayado 2019) that uses a modification of the Holling Type II\nresponse in a predator-prey type model,\nthe previously mentioned paper (Herald 2010) on inflammation\nmodeling,\nthe paper (Khoury, Myerscough, and Barron 2011) on\nhoney bee populations, and\nthe paper (Butler and Wolkowicz 1985) which greatly\nexpands our discussion of the chemostat model.\n\n\n\nAlonso Izquierdo, A., M. A. González León, and M. de la Torre Mayado.\n2019. “A Generalized Holling Type II\nModel for the Interaction Between Dextral-Sinistral Snails and It\nPareas Snakes.” Applied Mathematical Modelling.\nSimulation and Computation for Engineering and Environmental\nSystems 73: 459–72. https://doi.org/10.1016/j.apm.2019.04.005.\n\n\nButler, G. J., and G. S. K. Wolkowicz. 1985. “A Mathematical Model\nof the Chemostat with a General Class of Functions Describing Nutrient\nUptake.” SIAM Journal on Applied Mathematics 45 (1):\n138–51. https://doi.org/10.1137/0145006.\n\n\nEdelstein-Keshet, Leah. 2005. Mathematical Models in Biology.\nVol. 46. Classics in Applied Mathematics. Society for\nIndustrial and Applied Mathematics (SIAM), Philadelphia, PA. https://doi.org/10.1137/1.9780898719147.\n\n\nGerlee, Philip. 2013. “The Model Muddle: In\nSearch of Tumor Growth Laws.” Cancer\nResearch 73 (8): 2407–11. https://doi.org/10.1158/0008-5472.CAN-12-4355.\n\n\nHerald, Meagan C. 2010. “General Model of Inflammation.”\nBulletin of Mathematical Biology 72 (4): 765–79. https://doi.org/10.1007/s11538-009-9468-9.\n\n\nKhoury, David S., Mary R. Myerscough, and Andrew B. Barron. 2011.\n“A Quantitative Model of Honey Bee Colony\nPopulation Dynamics.” PLOS ONE 6 (4): e18491. https://doi.org/10.1371/journal.pone.0018491.\n\n\n\n\n",
      "last_modified": "2022-03-05T14:28:13-05:00"
    },
    {
      "path": "notes009.html",
      "title": "Course Notes 9",
      "description": "Reaction kinetics. \n",
      "author": [
        {
          "name": "Jason M. Graham",
          "url": "https://topicsinbiomath.netlify.app/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\nContents\nGoals\nOverview\nChemical Reaction\nKinetics\nFurther Reading\n\nGoals\nAfter reading this section of notes, you should\nknow the law of mass action and how it applies to derive\ndifferential equations models for reactions.\nOverview\nMolecular and cellular processes drive many biological phenomenon and\nthus should often be taken into consideration for mathematical modeling\nof biological problems. We have already seen an example of this in our\nmathematical modeling of the chemostat bioreactor. Recall that one of\nthe steps in constructing a mathematical model for the chemostat was to\ndevelop a functional form for the nutrient dependent growth rate\nfunction. In order to do so, we considered what happens at the cellular\nlevel with regard to how a cell consumes nutrient. This led us to view\nthe nutrient as a substrate\nmolecule that will bind with receptor\nproteins at the surface membrane of the cell, and in turn to the\nchemical reactions:\n\\[\\begin{align}\n&C + X_0 \\rightleftharpoons X_1\\\\\n&X_1 \\rightarrow P + X_0\n\\end{align}\\]\nwhere we denote the external nutrient by \\(C\\), unoccupied receptors by \\(X_{0}\\), an occupied receptor by \\(X_{1}\\), and a nutrient molecule\nsuccessfully transported in the cell body by \\(P\\). From this we then applied the law of\nmass action (without really understanding what the law of mass action\nis) to derive a system of ordinary differential equations:\n\\[\n\\begin{align}\n  \\frac{dc}{dt} & = -k_{1}cx_{0} + k_{-1}x_{1}, \\tag{1} \\\\\n  \\frac{dx_{0}}{dt} & = -k_{1}cx_{0} + k_{-1}x_{1} + k_{2}x_{1},\n\\tag{2} \\\\\n  \\frac{dx_{1}}{dt} & = k_{1}cx_{0} - k_{-1}x_{1} - k_{2}x_{1},\n\\tag{3} \\\\\n  \\frac{dp}{dt} & = k_{2}x_{1}.  \\tag{4}\n\\end{align}\n\\]\nfor the rates of change in the concentrations of the relevant\nchemical species.\nIn this section, we want to explain in more detail the process of\ntranslating a set of chemical reactions into differential equations that\nwill form (perhaps just part of) a mathematical model. Specifically,\nthis section spells out the law of mass action and some of its\napplications in more detail.\nWe note that this section sets up a sort of template for some\nmodeling approaches that are common in the field of systems\nbiology. Excellent mathematical treatments of systems biology may be\nfound in the online lecture notes of Sontag\nor Ingalls.\nChemical Reaction Kinetics\nThe law of mass action is:\n\nReaction rates are proportional to products of concentrations.\n\nThe law of mass action assumes conditions that include constant\ntemperature. Furthermore, if the medium is not “well-mixed” or if there\nare only a small number of molecules involved then mass-action kinetics\nmay not be accurate.\nThis section describes how to apply the law of mass action to derive\nrate equations for a few common simple reactions that have the general\nform\n\\[\\begin{equation}\n  \\text{reactants} \\rightarrow \\text{products}\n\\end{equation}\\]\nThroughout this section, we make use of the following convention:\nCapital letters \\(A\\), \\(B\\), etc. will be used to denote a chemical\nspecies. This may be an ion or a complex molecule. We will use\nlower-case letters to denote the concentration of a chemical. For\nexample, the concentration of chemical \\(A\\) would be \\(a\\). Thus, \\(\\frac{da}{dt}\\) would be the rate of change\nof the concentration of \\(A\\) and \\(\\frac{da}{dt}\\) has unit dimensions of\nconcentration per time.\nWe will follow Section 1.2 of (Witelski and Bowen 2015) and list some\nof the more common basic chemical reaction models that occur in\nbiomathematics and systems\nbiology.\n\n\n\nFigure 1: Common basic chemical reaction models that occur in\nbiomathematics.\n\n\n\nNotice that the multiple products rule provides the correct way to\ndeal with a reaction such as\n\\[\n\\begin{equation}\n    A + A \\rightarrow C = 2A \\rightarrow C\n\\end{equation}\n\\]\nApplying the multiple products rule gives \\[\\begin{align*}\n\\frac{da}{dt} &= -2ka^2  \\\\\n\\frac{dc}{dt} &= ka^2\n\\end{align*}\\]\nWe have seen, in the derivation of Michaelis-Menten kinetics in\nrelation to the chemostat problem how the law of mass action is used to\nderive rate equations for a reaction that involves a single substrate\n(e.g., a nutrient). This sections provides another illustration\nof the application of the law of mass action to a problem involving two\nsubstrates. Here the reaction scheme becomes\n\\[\n\\begin{align}\n&C_{1} + C_{2} \\rightleftharpoons C_{3}  \\\\\n&C_{3} + C_{4} \\rightleftharpoons  C_{5}  \\\\\n&C_{5} \\rightarrow C_{1} + C_{6} + C_{7}  \n\\end{align}\n\\]\nThe law of mass action then implies\n\\[\n\\begin{align}\n\\frac{dc_{1}}{dt} &= -k_{1}c_{1}c_{2} + k_{-1}c_{3} + k_{3}c_{5}  \\\\\n\\frac{dc_{2}}{dt} &=  -k_{1}c_{1}c_{2} + k_{-1}c_{3}  \\\\\n\\frac{dc_{3}}{dt} &=  k_{1}c_{1}c_{2}  - k_{-1}c_{3} -\nk_{2}c_{3}c_{4} + k_{-2}c_{5} \\\\\n\\frac{dc_{4}}{dt} &=  -k_{2}c_{3}c_{4} + k_{-2}c_{5} \\\\\n\\frac{dc_{5}}{dt} &=  k_{2}c_{3}c_{4} - k_{-2}c_{5} - k_{3}c_{5} \\\\\n\\frac{dc_{6}}{dt} &= k_{3}c_{5}  \\\\\n\\frac{dc_{7}}{dt} &= k_{3}c_{5}    \n\\end{align}\n\\]\nHere, the analog of occupied receptors is \\(C_{3}\\) and \\(C_{5}\\) (why is this?). Thus, the\nquasi-steady-state assumption applied to this problem assumes that \\(c_{3}\\) and \\(c_{5}\\) quickly reach a steady-state so\nthat \\(\\frac{dc_{3}}{dt}=\\frac{dc_{5}}{dt}\\approx\n0\\). As a homework problem, you should solve the equations \\[\\begin{align*}\n0 &=  k_{1}c_{1}c_{2}  - k_{-1}c_{3} - k_{2}c_{3}c_{4} + k_{-2}c_{5}\n\\\\\n0 &=  k_{2}c_{3}c_{4} - k_{-2}c_{5} - k_{3}c_{5}\n\\end{align*}\\] for \\(c_{3}\\) and\n\\(c_{5}\\) and substitute the result\ninto the equations for \\(c_{2}\\) and\n\\(c_{4}\\). Doing this should lead to a\nterm of the form\n\\(v = \\frac{V_{\\text{max}}ab}{K_{AB} +\nK_{B}a + K_{A}b + ab},\\)\nwhich is analogous to the Michaelis-Menten functional form in the\ncase of a single substrate.\nFurther Reading\nThe presentation of the law of mass action and basic chemical\nreaction models given in this lecture closely follows that of Section\n1.2 from (Witelski and Bowen 2015).\nWe also recommend the lecture notes of Sontag\nor Ingalls.\nIn particular, Chapter 3 of Ingalls on biochemical kinetics derives a\nnumber of important mathematical models that are important in\nbiochemical considerations. Chapter 1 from (Keener and Sneyd 2009) develops the law\nof mass action from thermodynamic considerations and covers additional\nmaterial beyond what is introduced in this course. The later chapters of\n(Keener and Sneyd 2009) show how\nbiochemical reaction kinetics are used in mathematical modeling of\nproblems in human physiology.\n\n\n\nKeener, James, and James Sneyd. 2009. Mathematical Physiology.\nVol. I: Cellular Physiology.\nSecond. Vol. 8/. Interdisciplinary Applied Mathematics.\nSpringer, New York. https://doi.org/10.1007/978-0-387-79388-7.\n\n\nWitelski, Thomas, and Mark Bowen. 2015. Methods of Mathematical\nModelling. Springer.\n\n\n\n\n",
      "last_modified": "2022-03-05T14:28:14-05:00"
    },
    {
      "path": "notes010.html",
      "title": "Course Notes 10",
      "description": "Dimensional analysis. \n",
      "author": [
        {
          "name": "Jason M. Graham",
          "url": "https://topicsinbiomath.netlify.app/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\nContents\nGoals\nOverview\nUnit\nDimensions, Derived Units, and the Arithmetic of Units\nArithmetic of Units\nThe Unit Dimensions of\nDerivatives\n\nDimensional Analysis\nNon-dimensionalization\nDimensional\nAnalysis and Function Inputs\nApplication\nof Non-dimensionalization to the SIR Model\nGeneric Rescaling\nBuckingham \\(\\pi\\)\n\nFurther Reading\n\nGoals\nAfter reading this section of notes, you should\nunderstand the basic principles of dimensional analysis,\nand\nknow how to non-dimensionalize a mathematical model.\nOverview\nMathematical models relate various physical quantities through the\nvariables and parameters involved in expressing the model equations. As\nyou probably know well by now, physical quantities are measured in some\nset of associated units. For example, you may measure the length of an\nobject or the distance traveled in units of feet. Notice that length is\nthe basic physical quantity that is being measured while feet is the\nchosen set of units. However, units of feet is not the only valid\noption, another choice would be to use units of meters (or metres).\nFurthermore, sometimes it is convenient to work in a certain set of\nunits. For example, you will often see physicists choose units such that\nthe speed of\nlight or Plank’s\nconstant is equal to one. The point is that you are always free to\nchoose the units you work in, but you must make certain that the units\nbalance out in any mathematical expressions that involved physical\nquantities. You cannot make a mathematical statement that would imply\nsomething like a quantity with units corresponding to a length is equal\nto a quantity with units corresponding to a mass. Additionally, you\ncannot add (or subtract) two quantities that do not have the same units.\nIt doesn’t make sense to add three feet to six minutes.\nDimensional\nanalysis involves a systematic analysis of the relationships between\nthe fundamental physical quantities and units of model variables and\nparameters in order to insure consistency of units. A dimensional\nanalysis often leads to a choice of unit scaling that can help the\nmathematical modeler to better understand the significance of model\nparameters or to reduce the number of significant model parameters via\nthe process of non-dimensionalization.\nThis is important when, for example, studying the bifurcation behavior\nof a dynamical model as the value of one or more parameters is varied.\nNon-dimensionalization should be considered a basic and essential step\nas part of carrying out the basic biomathematical workflow. The moment\nyou encouter or write down a mathematical model, the next thing you\nshould do is conduct a dimensional analysis and then non-dimensionalize\nthe model equations.\nBefore we discuss dimensional analysis and non-dimensionalization in\ndetail, there are two important topics we need to cover.\nUnit dimensions and derived units. These concepts make clear the\ndistinction between fundamental quantities and the units used to measure\nthem.\nThe “arithmetic” of unit dimensions.\nThese ideas together make dimensional analysis and\nnon-dimensionalization relatively straightforward.\nUnit\nDimensions, Derived Units, and the Arithmetic of Units\nUnit dimensions are basic physical quantities that\ncan be measured. Table 1 lists the fundamental unit\ndimensions of some primary quantities along with the notation we use to\ndenote them, and their corresponding SI\nunits.\n\n\n\n\n\nTable 1: Fundamental Unit Dimensions of Primary Quantities\n\n\nUnit Dimension\n\n\nSI Unit\n\n\nmass, \\(M\\)\n\n\nkilogram, kg\n\n\nlength, \\(L\\)\n\n\nmetre, m\n\n\ntime, \\(T\\)\n\n\nsecond, s\n\n\ntemperature, \\(\\Theta\\)\n\n\nKelvin, K\n\n\namount of a substance, \\(A\\)\n\n\nmole, mol\n\n\nOf course, SI units are not the only choice of units. The point is\nthat mass, length, etc. are the quantities being measured. Furthermore,\nmass, length, etc. are fundamental in the sense that they cannot be\nviewed as being made up of more basic quantities. On the other hand, the\nquantities listed in table 2 are said to be\nderived because they can be viewed as being made up of\nmore basic quantities. For example, velocity has derived dimensions of\n\\(\\frac{\\text{length}}{{\\text{time}}}\\). In\norder to simplify the language a bit, we will often say the dimensions\nof velocity are \\(\\frac{\\text{length}}{{\\text{time}}}\\), read\n“length per time.”\n\n\n\n\n\nTable 2: Examples of Derived Units\n\n\nPhysical Quantity\n\n\nDerived Dimensions\n\n\nSI Units\n\n\ndensity, \\(\\rho\\)\n\n\n\\(\\frac{M}{L^3}\\)\n\n\nkg \\(\\text{m}^{-3}\\)\n\n\nvelocity, \\(v\\)\n\n\n\\(\\frac{L}{T}\\)\n\n\nm \\(\\text{s}^{-1}\\)\n\n\nacceleration, \\(a\\)\n\n\n\\(\\frac{L}{T^2}\\)\n\n\nm \\(\\text{s}^{-2}\\)\n\n\nforce, \\(F\\)\n\n\n\\(\\frac{ML}{T^2}\\)\n\n\nNewtons N \\(=\\) kg m \\(\\text{s}^{-2}\\)\n\n\npressure, \\(p\\)\n\n\n\\(\\frac{M}{LT^2}\\)\n\n\nPascal Pa \\(=\\) kg \\(\\text{m}^{-1}\\) \\(\\text{s}^{-2}\\)\n\n\nenergy, \\(E\\)\n\n\n\\(\\frac{ML^2}{T^2}\\)\n\n\nJoule J \\(=\\) kg \\(\\text{m}^2\\) \\(\\text{s}^{-2}\\)\n\n\nNotation: If \\(x\\)\nis a quantity, we let \\([x]\\) denote\nthe corresponding dimensions for \\(x\\).\nFor example, if \\(v\\) represents a\nvelocity, then \\([v]=\\frac{L}{T}\\).\nObserve that pure numbers (one that does not correspond to a physical\nmeasurement) like \\(6\\), \\(0.12\\), or \\(\\pi\\) are unitless. This is because pure\nnumbers are fixed and do not depend on a choice of units. We will say\nthat a pure number is non-dimensional.\nArithmetic of Units\nThere is a sort of “arithmetic” of unit dimensions that serves to\nmake dimensional analysis an algebraic process. Specifically,\nYou may only add or subtract quantities with the exact same unit\ndimensions.\nMultiplying a quantity by a pure number does not change the unit\ndimensions. We can write this in mathematical notation, suppose that\n\\(A\\) is a physical quantity with unit\ndimensions \\([A]\\) and let \\(c\\) be a pure number, then \\([cA]=[A]\\).\nDimensions multiply and divide. We can write this in mathematical\nnotation, suppose that \\(A\\) and \\(B\\) are physical quantities with unit\ndimensions \\([A]\\) and \\([B]\\) respectively. Then,\n\\([AB]=[A][B]\\), and\n\\(\\left[\\frac{A}{B}\\right] =\n\\frac{[A]}{[B]}\\).\n\nQuantities on both sides of an equality (or inequality for that\nmatter) must have the same unit dimensions. You cannot compare or equate\nquantities with different units.\nProperties 1), 2), and 4) are straightforward. We will illustrate\nproperty 3) with some examples. Suppose that \\(\\alpha\\) is a rate parameter that has unit\ndimensions \\([\\alpha]=T^{-1}\\), and\nsuppose that \\(x\\) is a physical\nquantity with \\([x]=L\\), what will be\nthe unit dimensions for \\(\\alpha x\\)?\nWe know that\n\\([\\alpha x] = [\\alpha][x] = T^{-1}L =\n\\frac{L}{T}\\)\nso \\([\\alpha x]=\\frac{L}{T}\\) which\nare the same unit dimensions as velocity (or speed). As another example,\nsuppose that \\(A\\) and \\(B\\) are quantities with \\([A]=\\frac{ML}{T^2}\\) and \\([B]=\\frac{L^2T}{M}\\) What are the unit\ndimensions of \\(\\frac{A}{B}\\)? We know\nthat\n\\[\n\\begin{align}\n\\left[\\frac{A}{B} \\right] &= \\frac{[A]}{[B]} \\\\\n&= \\frac{\\frac{ML}{T^2}}{\\frac{L^2 T}{M}}\\\\\n&= \\frac{ML}{T^2}\\frac{M}{L^2 T} \\\\\n&= \\frac{M^2}{L T^3}\n\\end{align}\n\\]\nThus, \\(\\left[\\frac{A}{B}\n\\right]=\\frac{M^2}{L T^3}\\). Observe how some units “cancel” when\nthere are reciprocals present.\nNote that we do not necessarily need to know the specific unit\ndimensions of a quantity in order to manipulate its unit dimensions. For\nexample, suppose that \\(P\\) is some\nphysical quantity. The regardless of the specifics of \\([P]\\) we can determine that the unit\ndimensions of \\(P^3\\) are \\([P]^3\\). These types of manipulations will\noften come in handy.\nThe Unit Dimensions of\nDerivatives\nSince we work a lot with differential equations, let’s take a moment\nto consider the unit dimensions of the derivative of a function.\nConsider a generic function \\(y=f(x)\\),\nwhere the variables \\(x\\) and \\(y\\) correspond to physical quantities with\nunit dimensions \\([x]\\) and \\([y]\\) respectively. By definition,\n\\(f'(x) = \\frac{dy}{dx} =\n\\lim_{h\\rightarrow 0}\\frac{f(x+h) - f(x)}{h}\\).\nSince we can only add quantities with the same unit dimensions, we\nmust have that \\([h]=[x]\\). Similarly,\nwe must have that \\([f(x+h)]=[f(x)] =\n[y]\\) and hence \\([f(x+h) - f(x)] =\n[y]\\). Therefore, for any particular value of \\(h\\), we must have\n\\(\\left[\\frac{f(x+h) - f(x)}{h}\\right] =\n\\frac{[f(x+h) - f(x)]}{[h]}=\\frac{[y]}{[x]}\\)\nSince the last equation is true for any value of \\(h\\), it must also hold in the limit so\nthat\n\\(\\left[f'(x) \\right] =\n\\left[\\frac{dy}{dx} \\right] = \\left[\\lim_{h\\rightarrow 0}\\frac{f(x+h) -\nf(x)}{h} \\right] = \\frac{[y]}{[x]}\\)\nAs a specific example, suppose that we have a function \\(y(t)\\), where \\([y]=L\\) and \\([t]=T\\), then \\(\\left[\\frac{dy}{dt}\\right]=\\frac{L}{T}\\).\nDoes this remind of anything? If \\(y(t)\\), where \\([y]=L\\) and \\([t]=T\\) then we can think of \\(y(t)\\) as an expression for the position as\na function of time, the derivative of such a function is the\ninstantaneous rate of change with respect to time, also known as\nvelocity.\nExercise: Suppose that we have a function \\(y(t)\\), where \\([y]=L\\) and \\([t]=T\\). What are the unit dimensions for\n\\(\\frac{d^2y}{dt^2}\\)? In general, if\n\\(y=f(x)\\) is a function, what would be\n\\([f^{(n)}(x)]\\)?\nDimensional Analysis\nSuppose that we have an expression \\(y =\nat^2 + bt + c\\) and we know that \\([y]=L\\) and \\([t]=T\\). We can use the known facts that\n\\([y]=L\\) and \\([t]=T\\) in order to determine the unit\ndimensions for all of the parameters (coefficients) in the equation\n\\(y = at^2 + bt + c\\). By the fourth\nrule for our arithmetic of unit dimensions, we must have that \\([y] = [at^2 + bt + c]\\) and by the first\nrule we must have that \\([at^2]=[bt]=[c]\\). Putting the last two\nobservations together tells us that\n\\[\\begin{align}\nL &= [y] = [at^2] = [a]T^2\\\\\nL &= [y] = [bt] = [b]T   \\\\\nL &= [y] = [c]\n\\end{align}\\]\nThus,\nthe third equation implies that \\([c]=L\\),\nthe second equation implies that \\([b]=\\frac{L}{T}\\), and\nthe first equation implies that \\([a]=\\frac{L}{T^2}\\).\nWe have just illustrated the process of dimensional\nanalysis. Even if we don’t know the specific details of the\nunit dimensions in an equation, we can still use dimensional analysis to\ndetermine the relationship between unit dimensions of variables and\nparameters in an equation. For example, consider the differential\nequation\n\\(\\frac{dy}{dx} = \\alpha y\\)\nWe know that \\(\\left[ \\frac{dy}{dx}\\right]\n= \\frac{[y]}{[x]}\\), therefore we must have \\([\\alpha y] = \\frac{[y]}{[x]}\\). Since \\([\\alpha y] = [\\alpha][y]\\) our unit\ndimension arithmetic implies that\n\\([\\alpha][y] = \\frac{[y]}{[x]}\\ \\\n\\Rightarrow [\\alpha]=\\frac{1}{[x]}\\)\nYou should make sure that you understand what we have just done\nbecause these types of manipulations and reasoning with abstract unit\ndimensions is something we will do frequently. Moreover, it occurs often\nin the reserach literature, sometimes even without specific mention.\nLet’s look at one more example for now. Recall the logistic growth\nmodel\n\\(\\frac{dN}{dt} =\nrN\\left(1-\\frac{N}{K}\\right)\\)\nSince we know that \\(t\\) represents\ntime it should be clear that \\([t]=T\\).\nNow \\(N\\) is the size of the population\n(or sometimes population density). Rather than thinking about specific\nunit dimensions for \\(N\\), let’s just\nwork with its unit dimensions abstractly by using our notation \\([N]\\). By the development so far, we\nhave\n\\(\\left[\\frac{dN}{dt}\\right] =\n\\frac{[N]}{T}\\)\nwhich forces\n\\(\\left[rN\\left(1-\\frac{N}{K}\\right)\n\\right] = \\frac{[N]}{T}\\)\nNow 1 is a pure number and you can not add or subtract a quantity\nwith units from a pure number. This means that in order for the\nexpression \\(1-\\frac{N}{K}\\) to be\nvalid, \\(\\frac{N}{K}\\) must be\ndimensionless, and the only way that can happen is if \\([K]=[N]\\). Furthermore, since \\(1-\\frac{N}{K}\\) is dimensionless, we must\nhave\n\\(\\left[rN\\left(1-\\frac{N}{K}\\right)\n\\right] = \\left[rN\\right] = [r][N]=\\frac{[N]}{T}\\)\nTherefore, \\([r] = \\frac{1}{T}\\)\nIn summary, for the equation\n\\(\\frac{dN}{dt} =\nrN\\left(1-\\frac{N}{K}\\right)\\)\nwe must have \\([K]=[N]\\) and \\([r]=\\frac{1}{T}\\). We will make use of\nthese observations in the next section on non-dimensionalization.\nNon-dimensionalization\nThe goal of non-dimensionalization is to rescale the variables in an\nequation so that all of the variables and parameters become\ndimensionless. There are typically two general steps in the\nnon-dimensionalization process:\nRescale all of the variables in the model equation(s) to make\nthem dimensionless by making a change of variables that relates the\ndimensionless variables to the original variables and\nparameters.\nSubstitute the change of variables into the original model\nequations to find an analogous equation for the rescaled dimensionless\nvariables. This will usually reduce the number of parameters in the\nmodel equation(s).\nWe will start with a simple example. Consider again the equation\n\\(y = at^2 + bt + c\\)\nwhere \\([y]=L\\) and \\([t]=T\\). Recall that this forces \\([a]=\\frac{L}{T^2}\\), \\([b]=\\frac{L}{T}\\), and \\([c]=L\\). Now define the change of\nvariables\n\\(\\xi = \\frac{y}{c},\\ \\ \\tau =\n\\frac{b}{c}t\\)\nLet’s confirm that \\(\\xi\\) and \\(\\tau\\) are dimensionless, which is the\npoint of the exercise to render variables dimensionless. (We will come\nback and discuss this particular choice of scaling but note that in\ngeneral there isn’t necessarily a unique choice.) Notice\n\\([\\xi] = \\left[\\frac{y}{c}\\right] =\n\\frac{[y]}{[c]}=\\frac{[y]}{[y]}\\)\nand\n\\([\\tau]=\\left[\n\\frac{b}{c}t\\right]=\\frac{[b]}{[c]}[t]=\\frac{\\frac{L}{T}}{L}T =\n\\frac{[L][T]}{[L][T]}\\)\nso all units cancel in both \\([\\xi]\\) and \\([\\tau]\\) which means each of \\(\\xi\\) and \\(\\tau\\) is dimensionless. This completes\nstep 1) of the non-dimensionalization process. For step 2) notice\nthat\n\\(y=c\\xi = at^2 + bt + c =\na\\left(\\frac{c}{b}\\tau\\right)^2+b\\left(\\frac{c}{b}\\tau\\right)+c\\)\nso\n\\(c\\xi=a\\frac{c^2}{b^2}\\tau^2+c\\tau+c\\)\nor equivalently\n\\(\\xi = \\frac{ac}{b^2}\\tau^2 + \\tau +\n1\\)\nWe leave it as an exercise for the reader to show that \\(\\gamma = \\frac{ac}{b^2}\\) is a\ndimensionless quantity. We say that \\(y = at^2\n+ bt + c\\) has been non-dimensionalized to \\(\\xi = \\gamma \\tau^2 + \\tau + 1\\), where\n\\(\\gamma = \\frac{ac}{b^2}\\). Notice\nthat the process is fully invertible so the two equations\n\\(y = at^2 + bt + c\\)\nand\n\\(\\xi = \\gamma \\tau^2 + \\tau +\n1\\)\nare mathematically equivalent, all we have done is made a change of\nunits. The benefit of non-dimensionalizing is that the expression \\(\\xi = \\gamma \\tau^2 + \\tau + 1\\) has fewer\nparameters, and we have identified that the significance of the\nparameters is encapsulated in the ratio \\(\\frac{ac}{b^2}\\). (Think about why this is\ntrue, a hint is to refer to the quadratic formula.)\nQuestion: Is \\(\\xi =\n\\frac{y}{c}\\), \\(\\tau =\n\\frac{b}{c}t\\) the only valid choice of scaling in order to\nnon-dimensionalize \\(y = at^2 + bt +\nc\\)? The answer is no, in the homework you will be asked to\nverify that \\(\\xi = \\frac{x}{c}\\) and\n\\(\\tau=\\frac{a}{b}t\\) is also a valid\nchange of variables that can be used to nondimensionalize the equation\n\\(y = at^2 + bt + c\\).\nLet’s non-dimensionalize a differential equation. Consider again the\nlogistic growth model\n\\(\\frac{dN}{dt} = rN\\left(1 -\n\\frac{N}{K}\\right)\\)\nWe’ve already determined that \\([K]=[N]\\) and \\([r]=\\frac{1}{T}\\). Let’s define\n\\(\\xi = \\frac{N}{K}, \\ \\ \\tau = r\nt\\).\nIt’s easy to see that \\(\\xi\\) and\n\\(\\tau\\) are dimensionless. It should\nbe obvious that \\(\\xi\\) is\ndimensionless, to see that \\(\\tau\\) is\nas well notice that\n\\([\\tau] = [rt] =\n[r][t]=\\frac{1}{T}T\\)\nand the units cancel. This completes step 1) of the\nnon-dimensionalization process. To complete step 2) we need to find a\ndifferential equation that is satisfied by \\(\\xi(\\tau)\\). Let’s proceed by computing the\nderivative \\(\\frac{d\\xi}{d\\tau}\\) of\n\\(\\xi\\) with respect to \\(\\tau\\). As you will see, the technique is\nto use the chain\nrule.\n\\[\\begin{align*}\n\\frac{d\\xi}{d\\tau} &= \\frac{d\\xi}{dt}\\frac{dt}{d\\tau} \\\\\n&= \\frac{d}{dt}\\frac{N}{K}\\frac{dt}{d\\tau} \\\\\n&= \\frac{1}{K}\\frac{dN}{dt}\\frac{dt}{d\\tau} \\\\\n&= \\frac{1}{K}\\frac{dN}{dt}\\frac{1}{r} \\\\\n&= \\frac{1}{rK}\\frac{dN}{dt} \\\\\n&= \\frac{1}{rK}rN\\left(1 - \\frac{N}{K}\\right) \\\\\n&= \\frac{N}{K}\\left(1 - \\frac{N}{K}\\right) \\\\\n&= \\xi(1-\\xi)\n\\end{align*}\\]\nThus, \\(\\frac{d\\xi}{d\\tau}=\\xi(1-\\xi)\\) is the\nnon-dimensionalization of \\(\\frac{dN}{dt} =\nrN\\left(1 - \\frac{N}{K}\\right)\\).\nWe can think of \\(\\xi=\\frac{N}{K}\\)\nas the proportion of the population relative to the carrying capacity.\nThus, our dimensionless equation \\(\\frac{d\\xi}{d\\tau}=\\xi(1-\\xi)\\)\nnormalizes the population relative to the carrying capacity.\nThe relation \\(\\tau = r t\\) establishes\nthe time-scale of the model and the non-dimensionalization essentially\ntells us that the population will always reach the maximum proportion\n(1) of the carrying capacity on the same time-scale regardless of the\nexact values of \\(r\\) and \\(K\\). This is because the rate parameter\n\\(r\\) is eliminated from the equation\nas a result of non-dimensionalization.\nNote that for the logistic growth model there is really only one\nchoice of rescaling for non-dimensionalization. This is an exception and\nnot typical. In fact, the more parameters involved in a model, the more\nchoices there will usually be for rescaling as part of\nnon-dimensionalization. However, it is always possible to choose some\n(not necessarily unique) scaling that non-dimensionalizes a model and\nresults in at most the same number of parameters (and usually fewer) as\nthe original model. This isn’t just some observation or rule or thumb it\nis in fact a rigorous mathematical theorem known as the Buckingham\n\\(\\pi\\) theorem. We will discuss\nthe Buckingham \\(\\pi\\) theorem\nsoon.\nDimensional Analysis\nand Function Inputs\nFor functions such as \\(f(x)=e^x\\),\n\\(f(x)=\\ln(x)\\), \\(f(x)=\\sin(x)\\), and \\(f(x)=\\cos(x)\\) the input value \\(x\\) must be unitless. Why is this the case?\nLet’s consider \\(f(x)=e^x\\) for\nexample. From calculus II, we know that we can express \\(f(x)=e^x\\) as a convergent power\nseries:\n\\(f(x) = e^x = 1 + x + \\frac{x^2}{2!} +\n\\frac{x^3}{3!} + \\cdots\\)\nNow each of the terms \\(1\\), \\(x\\), \\(\\frac{x^2}{2!}\\), etc. must have the same\nunit dimensions otherwise they could not be added together. Furthermore,\nsince \\(1\\) is a pure number this\nimplies that all of the terms in the series must be unitless and thus\n\\(x\\) in particular must be unitless.\nSimilar reasoning leads us to conclude that the other functions \\(f(x)=\\ln(x)\\), \\(f(x)=\\sin(x)\\), and \\(f(x)=\\cos(x)\\) can only take pure numbers\nas inputs.\nSometimes you will see functions like \\(y(t) = \\sin(t)\\) where the variable \\(t\\) is interpreted as time but this is\nincorrect based on what we have just discussed. If you want the\nindependent variable in a function like \\(f(x)=e^x\\) or \\(f(x)=\\sin(x)\\) to be a physical quantity,\nthey you must include a parameter with appropriate unit dimensions. For\nexample, it is okay to use \\(y(t) =\n\\sin(at)\\) and have \\([t]=T\\) as\nlong as \\([a]=\\frac{1}{T}\\) so that\n\\(at\\) taken as the input is\nunitless.\nQuestion: What does dimensional analysis suggest\nabout the unit dimensions for the output of a function like \\(f(x)=e^x\\), \\(f(x)=\\ln(x)\\), \\(f(x)=\\sin(x)\\), or \\(f(x)=\\cos(x)\\)?\nIt is a common mistake to use a function to model some process\nwithout taking care to make sure that the input(s) or output(s) are\nunitless, or at least has the appropriate unit dimensions, watch out for\nthis in the literature and don’t make the mistake yourself.\nApplication\nof Non-dimensionalization to the SIR Model\nRecall the SIR model for the spread of an infectious disease:\n\\[\\begin{align}\n\\frac{dS}{dt} &= -\\beta SI, \\\\\n\\frac{dI}{dt} &= \\beta SI - \\gamma I, \\\\\n\\frac{dR}{dt} &= \\gamma I.\n\\end{align}\\]\nRemember that \\(S\\), \\(I\\), and \\(R\\) denote the population of susceptible,\ninfected, and recovered individuals, respectively; and \\(\\beta\\) is the rate of infection of\nsusceptible individuals per number of infected and \\(\\gamma\\) is the recovery rate.\nAdditionally, remember that we observed that \\(S+I+R=N\\), where \\(N\\) is the constant total population. By\ndimensional analysis, we must have\n\\([S]=[I]=[R]=[N]\\),\n\\([t]=T\\) (since \\(t\\) represents time),\n\\([\\beta]=\\frac{1}{[N]T}\\),\nand\n\\([\\gamma]=\\frac{1}{T}\\).\nNext, let\n\\(x=\\frac{S}{N},\\ \\ y=\\frac{I}{N},\\ \\\nz=\\frac{R}{N}, \\ \\ \\tau=\\gamma t\\)\nand let’s use these rescalings to non-dimensionalize the SIR model\nequations. You should take a moment to convince yourself that \\(x\\), \\(y\\), \\(z\\), and \\(\\tau\\) are each dimensionless. Applying the\nchain rule we have\n\\[\n\\begin{align}\n\\frac{dx}{d\\tau} &= \\frac{dx}{dt}\\frac{dt}{d\\tau} \\\\\n&= \\frac{d}{dt}\\frac{S}{N}\\frac{dt}{d\\tau} \\\\\n&= \\frac{1}{N}\\frac{dS}{dt}\\frac{1}{\\gamma} \\\\\n&= \\frac{1}{\\gamma N}\\left(-\\beta SI \\right) \\\\\n&= -\\frac{\\beta}{\\gamma N}\\left(xNyN \\right) \\\\\n&= -\\frac{\\beta N}{\\gamma} xy\n\\end{align}\n\\]\n\\[\n\\begin{align}\n\\frac{dy}{d\\tau} &= \\frac{dy}{dt}\\frac{dt}{d\\tau} \\\\\n&= \\frac{d}{dt}\\frac{I}{N}\\frac{dt}{d\\tau} \\\\\n&= \\frac{1}{N}\\frac{dI}{dt}\\frac{1}{\\gamma} \\\\\n&= \\frac{1}{\\gamma N}\\left(\\beta SI - \\gamma I \\right) \\\\\n&= \\frac{1}{\\gamma N}\\left(\\beta xN yN - \\gamma zN \\right) \\\\\n&= \\frac{\\beta N}{\\gamma}xy - z\n\\end{align}\n\\]\n\\[\n\\begin{align}\n\\frac{dz}{d\\tau} &= \\frac{dz}{dt}\\frac{dt}{d\\tau} \\\\\n&= \\frac{d}{dt}\\frac{R}{N}\\frac{dt}{d\\tau} \\\\\n&= \\frac{1}{N}\\frac{dR}{dt}\\frac{1}{\\gamma} \\\\\n&= \\frac{1}{\\gamma N}\\left( \\gamma I\\right) \\\\\n&= \\frac{1}{\\gamma N}\\left(\\gamma zN \\right) \\\\\n&= z\n\\end{align}\n\\]\nTherefore,\n\\[\\begin{align*}\n\\frac{dx}{d\\tau}&= -R_{0}xy \\\\\n\\frac{dy}{d\\tau}&= R_{0}xy - z \\\\\n\\frac{dz}{d\\tau}&= z\n\\end{align*}\\]\nwhere \\(R_{0}=\\frac{\\beta\nN}{\\gamma}\\), is the non-dimensionalization of the SIR model\nequations. The number \\(R_{0}\\)\n(pronounced R naught or R zero) is a dimensionless quantity called the\nbasic reproductive ratio. Observe that \\(R_{0}\\) is the ratio of the per-capita\ninfection rate and the per-capita recovery rate. We will see later that\nthe magnitude of \\(R_{0}\\) determines\nwhether the termination of the spread of the infection “occurs only when\nno susceptible individuals are left, or whether the interplay of the\nvarious factors of infectivity, recovery and mortality, may result in\ntermination, whilst many susceptible individuals are still present in\nthe unaffected population.” Specifically, if\n\\(R_{0} < 1\\), then\nsusceptible individuals are predicted to still be present in the\nunaffected population, while if\n\\(R_{0} > 1\\), then\ntermination of the spread of the infection is predicted to occur only\nwhen no susceptible individuals are left.\nWe will prove points 1) and 2) later after we have discussed\nphase-plane methods. Notice that dimensional analysis and\nnon-dimensionalization have lead us to the conclusion that it is the\nratio \\(\\frac{\\beta N}{\\gamma}\\) that\nis important.\nGeneric Rescaling\nHow do you choose an appropriate rescaling for the\nnon-dimensionalization process? The answer is that it depends on the\nsituation. For example, in a model there may be some parameters that\nhave well-established values say from experiment or the literature. In\nsuch a case, you may want to use known parameter values to set the\nrescaling. In other cases, you might want to set a particular time-scale\nin which case that would play a role in your choice of rescaling.\nAnother approach is to start with a generic rescaling and then\nproceed with the non-dimensionalization with the specific relationship\nbetween the model variables and parameters to be determined after\nnon-dimensionalizing. Let’s look at some examples of this idea.\nReconsider the equation \\(y=at^2+bt+c\\). Assume that \\([y]=L\\) and \\([t]=T\\). Let \\(\\tilde{L}\\) and \\(\\tilde{T}\\) denote some characteristic\nlength and time, respectively. Now set\n\\(\\xi = \\frac{y}{\\tilde{L}}, \\ \\ \\tau =\n\\frac{t}{\\tilde{T}}\\)\nNotice that \\(\\xi\\) and \\(\\tau\\) are dimensionless because we have\ndefined \\(\\tilde{L}\\) and \\(\\tilde{T}\\) to have the same unit dimesions\nas \\(y\\) and \\(t\\), respectively. Next, substitute \\(y=\\tilde{L}\\xi\\) and \\(t=\\tilde{T}\\tau\\) into \\(y=at^2+bt+c\\). We get\n\\(\\tilde{L}\\xi =\na(\\tilde{T}\\tau)^2+b(\\tilde{T}\\tau)+c\\)\nor equivalently\n\\(\\xi =\n\\frac{a\\tilde{T}^2}{\\tilde{L}}\\tau^2+\\frac{b\\tilde{T}}{\\tilde{L}}\\tau+\\frac{c}{\\tilde{L}}\\)\nWe can see that there are multiple choices for \\(\\tilde{L}\\) and \\(\\tilde{T}\\) that can be made in order to\nnon-dimensionalize \\(y=at^2+bt+c\\). For\nexample, suppose we want to work in units such that the constant term in\n\\(\\xi =\n\\frac{a\\tilde{T}^2}{\\tilde{L}}\\tau^2+\\frac{b\\tilde{T}}{\\tilde{L}}\\tau+\\frac{c}{\\tilde{L}}\\)\nis \\(1\\). Choosing \\(\\tilde{L} = c\\) will accomplish that,\ngiving\n\\(\\xi =\n\\frac{a\\tilde{T}^2}{c}\\tau^2+\\frac{b\\tilde{T}}{c}\\tau+\\frac{c}{c}=\\frac{a\\tilde{T}^2}{c}\\tau^2+\\frac{b\\tilde{T}}{c}\\tau+1\\)\nbut now we still need to choose an expression for \\(\\tilde{T}\\) in terms of the original\nparameters. We see that one option is \\(\\tilde{T} = \\frac{c}{b}\\), giving\n\\(\\xi =\n\\frac{a\\left(\\frac{c}{b}\\right)^2}{c}\\tau^2+\\frac{b\\frac{c}{b}}{c}\\tau+1=\\frac{ac}{b^2}\\tau^2+\\tau+1\\)\nwhich is the same non-dimesionalization we obtained before.\nNon-dimensionalization using a generic rescaling works similarly for\ndifferential equations. A detailed example of this may be seen in the\nblog post on non-dimensionalization\nthe chemostat model. Note that this example is very much along the\nlines of what you will do in research. While dimensional analysis and\nnon-dimesionalization may seem to be a bit of a nuisance or even\nunnecessary, we can not over emphasize how important these techniques\nare in mathematical modeling.\nBuckingham \\(\\pi\\)\nThe Buckingham \\(\\pi\\) theorem is a\ntheoretical result and is not typically used directly in\nnon-dimensionalizing a problem. However, it places dimensional analysis\non a firm theoretical foundation so we take the time to describe the\nresult here. Before stating the theorem we need to establish some\nterminology and notation which we will illustrate in the context of our\nreoccurring example \\(y=at^2+bt+c\\).\nFor this problem, there are\n5 physical quantities \\(q_{1}=y\\), \\(q_{2}=t\\), \\(q_{3}=a\\), \\(q_{4}=b\\), and \\(q_{5}=c\\); and\n2 relevant dimensions \\(d_{1}=L\\) and \\(d_{2}=T\\).\nFurthermore, the nondimesionalization of \\(y=at^2+bt+c\\) to \\(\\xi = \\gamma \\tau^2 + \\tau + 1\\), where\n\\(\\gamma=\\frac{ac}{b^2}\\) via the\nscaling\n\\(\\xi = \\frac{y}{c},\\ \\ \\tau =\n\\frac{b}{c}t\\)\nwe end up with 3 dimensionless \\(\\Pi\\)-numbers (also called\ndimensionless groups) \\(\\Pi_1=\\xi\\), \\(\\Pi_2=\\tau\\), and \\(\\Pi_3=\\gamma\\). Notice that each \\(\\Pi\\)-number is expressed as a product of\n(rational number) powers of the original physical quantities.\nSpecifically,\n\\[\\begin{align*}\n\\Pi_1&= \\xi = yc^{-1}, \\\\\n\\Pi_2&= \\tau = tbc^{-1}, \\\\\n\\Pi_3&= \\gamma = acb^{-2}\n\\end{align*}\\]\nFinally, observe that\n\\(\\text{number of $\\Pi$-numbers} =\n\\text{number of physical quantities} - \\text{number of relevant\ndimensions}\\)\nWhat the Buckingham \\(\\pi\\) theorem\nproves is that the relationship between \\(\\Pi\\)-numbers, physical quantities, and\nrelevant dimensions is a general phenomenon. Furthermore, this\nrelationship between \\(\\Pi\\)-numbers,\nphysical quantities, and relevant dimensions does not depend on the\nparticular scaling used for non-dimensionalization. In fact,\nBuckingham \\(\\pi\\)\nIf a physical problem is described by \\(n\\) variables and parameters with every\nvariable or parameter expressed in terms of \\(r\\) independent relevant dimensions, then\nthe number of different \\(\\Pi\\)-numbers\nis at most \\(n-r\\).\nThe practical consequence of the Buckingham \\(\\pi\\) theorem is that we can predict by how\nmuch non-dimensionalization will simplify the expression of a model in\nterms of how many non-dimensional variables or parameters will remain\nafter non-dimensionalizing. The astute reader with a good background in\nlinear algebra may feel a sense of familiarity in the statement of the\nBuckingham \\(\\pi\\) theorem, in\nparticular regarding the resemblance of the identity\n\\(\\text{number of $\\Pi$-numbers} =\n\\text{number of physical quantities} - \\text{number of relevant\ndimensions}\\)\nwith the identity in the rank-nullity\ntheorem. In fact, the Buckingham \\(\\pi\\) theorem is a consequence of the\nrank-nullity theorem. For the linear algebra based proof of Buckingham\n\\(\\pi\\), see Chapter 4 of (Calvetti and Somersalo 2013).\nFurther Reading\nBoth of the texts (Calvetti and Somersalo 2013; Witelski and Bowen 2015) cover\ndimensional analysis in detail including the Buckingham \\(\\pi\\) theorem.\nAn excellent exercise is to attempt to reproduce the\nnon-dimensionalization found in research articles. As a first try, see\nif you can follow or work out on your own the non-dimensionalization\nfrom one of the following papers: (d’Onofrio 2005; Edelstein-Keshet 1994; Herald 2010).\n\n\n\nCalvetti, Daniela, and Erkki Somersalo. 2013. Computational\nMathematical Modeling. Mathematical Modeling and\nComputation. Society for Industrial and Applied\nMathematics (SIAM), Philadelphia, PA. https://mathscinet.ams.org/mathscinet-getitem?mr=3013353.\n\n\nEdelstein-Keshet, Leah. 1994. “Simple Models for Trail-Following\nBehaviour; Trunk Trails Versus Individual Foragers.” Journal\nof Mathematical Biology 32 (4): 303–28.\n\n\nHerald, Meagan C. 2010. “General Model of Inflammation.”\nBulletin of Mathematical Biology 72 (4): 765–79. https://doi.org/10.1007/s11538-009-9468-9.\n\n\nOnofrio, Alberto d’. 2005. “A General Framework for Modeling\nTumor-Immune System Competition and Immunotherapy: Mathematical Analysis\nand Biomedical Inferences.” Physica D. Nonlinear\nPhenomena 208 (3-4): 220–35. https://doi.org/10.1016/j.physd.2005.06.032.\n\n\nWitelski, Thomas, and Mark Bowen. 2015. Methods of Mathematical\nModelling. Springer.\n\n\n\n\n",
      "last_modified": "2022-03-05T14:28:16-05:00"
    },
    {
      "path": "notes011.html",
      "title": "Course Notes 11",
      "description": "Review of linear systems. \n",
      "author": [
        {
          "name": "Jason M. Graham",
          "url": "https://topicsinbiomath.netlify.app/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\nContents\nGoals\nBackground\nThe Trace-Determinant\nPlane\nExamples\n\nGeneral Linear Systems\nFurther Reading\n\nGoals\nAfter reading this section of notes, you should\nunderstand the trace-determinant classification of the\nqualitative behavior of dynamics for two-dimensional linear\nsystems,\nknow how to use phaseR to obtain phase-portraits for\ntwo-dimensional linear systems, and\nknow how to compute numerical solutions for initial value\nproblems for linear systems using deSolve.\nBackground\nOver the course of our discussions on mathematical modeling and\nmodels in biomathematics, we have encountered systems\nof coupled differential equations. For example, problems involving\npopulations of interacting species and the study of the spread of\ninfectious diseases resulted in systems of greater than one-dimension.\nThus, we will take a short amount of time to review some mathematical\ntechniques that are commonly used in the analysis or evaluation of\nbiomathematical models.\nThe simplest class of systems of coupled differential equations are\nlinear constant-coefficient systems. Such systems have the form\n\\[\n\\frac{d}{dt}\\left(\\begin{array}{c} x_{1} \\\\ x_{2} \\\\ \\vdots \\\\\nx_{n}  \\end{array}\\right) = \\left(\\begin{array}{cccc} a_{11} &\na_{12} & \\cdots & a_{1n} \\\\ a_{21} & a_{22} & \\cdots\n& a_{2n} \\\\ \\vdots & \\ddots & \\cdots & \\vdots \\\\ a_{n1}\n& a_{n2} & \\cdots & a_{nn}\n\\end{array}\\right)\\left(\\begin{array}{c} x_{1} \\\\ x_{2} \\\\ \\vdots \\\\\nx_{n}   \\end{array}\\right)\n\\]\nThis can be written more succinctly if we use matrix-vector notation\nas\n\\[\n\\frac{d}{dt}{\\bf x} = A {\\bf x}\n\\]\nwhere \\(A\\) is an \\(n\\times n\\) matrix and \\({\\bf x}\\) is an \\(n\\times 1\\) column vector. Note that such\nsystems are autonomous because the right-hand-side does\nnot depend explicitly on the independent variable \\(t\\). Furthermore, if \\(\\text{det}(A)\\neq 0\\), then the zero vector\n\\({\\bf 0}\\) is a unique equilibrium for\na linear system. When this is the case, it is possible to classify the\ndynamics of a linear system by examining it’s eigenvalues and\neigenvectors. The full details of this fact are beyond the scope of this\ncourse but we make the following observation: it is an easy exercise to\nshow that if \\(\\lambda\\), \\({\\bf v}\\) is an eigenvalue-eigenvector pair\nfor the matrix \\(A\\), then\n\\[{\\bf x}(t) = ce^{\\lambda t}{\\bf\nv}\\]\nwhere \\(c\\) is any real number is a\nsolution to the system \\(\\frac{d}{dt}{\\bf x} =\nA {\\bf x}\\). Further, a linear combination of solutions to a\nlinear system is also a linear system. This is sometimes known as the\nprinciple of superposition. These observations suggest why it is\npossible to classify the dynamics of a linear system by examining it’s\neigenvalues and eigenvectors.\nWe spend this time on the qualitative theory of linear systems\nbecause it is key to understanding the qualitative behavior of the\ndynamics of the types of nonlinear systems that arise frequently as\nbiomathematical models. Thus, we proceed by looking in detail at the\ntwo-dimensional case.\nThe Trace-Determinant Plane\nConsider a two-dimensional linear system\n\\[\n\\frac{d}{dt}\\left(\\begin{array}{c} x_{1} \\\\ x_{2}  \\end{array}\\right) =\n\\left(\\begin{array}{cc} a_{11} & a_{12} \\\\ a_{21} & a_{22}\n\\end{array}\\right)\\left(\\begin{array}{c} x_{1} \\\\ x_{2}\n\\end{array}\\right)\n\\]\nwhich for the remainder of this section we write as \\(\\frac{d}{dt}{\\bf x} = A {\\bf x}\\) with the\nunderstanding that \\(A\\) is a \\(2\\times 2\\) matrix. Additionally, we will\nassume that \\(\\text{det}(A)\\neq0\\) and\nhence that \\(A\\) is nonsingular. In\norder to determine the eigenvalues for \\(A\\), we must solve the characteristic\npolynomial\n\\[\n0=\\text{det}(A-\\lambda I) = \\text{det}\\left(\\begin{array}{cc} a_{11} -\n\\lambda & a_{12} \\\\ a_{21} & a_{22}-\\lambda\n\\end{array}\\right)=(a_{11}-\\lambda)(a_{22}-\\lambda)-a_{12}a_{21}\n\\] which leads to \\((a_{11}-\\lambda)(a_{22}-\\lambda)-a_{12}a_{21}=0\\).\nWe next demonstrate that this quadratic equation can by rewritten in\nterms of the trace \\(\\tau=a_{11}+a_{22}\\) and determinant \\(\\delta=a_{11}a_{22}-a_{12}a_{21}\\) of the\nmatrix \\(A\\). Specifically,\n\\[\n\\begin{align}\n(a_{11}-\\lambda)(a_{22}-\\lambda)-a_{12}a_{21} &=\na_{11}a_{22}-a_{11}\\lambda - a_{22}\\lambda + \\lambda^2 - a_{12}a_{21} \\\\\n&= \\lambda^{2} - (a_{11}+a_{22})\\lambda + (a_{11}a_{22}-\na_{12}a_{21}) \\\\\n&= \\lambda^{2} - \\tau \\lambda + \\delta\n\\end{align}\n\\] We can now see that in the \\(2\\times\n2\\) case, the characteristic polynomial \\(\\text{det}(A-\\lambda I) = \\lambda^{2} - \\tau\n\\lambda + \\delta = 0\\) has solutions\n\\(\\lambda = \\frac{\\tau \\pm \\sqrt{\\tau^2 -\n4\\delta}}{2}\\)\nfrom which we determine that \\(A\\)\nhas\ntwo distinct real eigenvalues if \\(\\delta > 0\\) and \\(\\tau^2 - 4\\delta > 0\\),\na complex conjugate pair of eigenvalues if \\(\\tau^2 - 4\\delta < 0\\) and \\(\\tau \\neq 0\\), and\npure imaginary eigenvlaues if \\(\\delta\n> 0\\) and \\(\\tau =\n0\\).\nFurthermore, the eigenvalues of \\(A\\) are\nboth positive if \\(\\tau >\n0\\), \\(\\delta > 0\\), and\n\\(\\tau^2 - 4\\delta > 0\\),\nboth negative if \\(\\tau <\n0\\), \\(\\delta > 0\\), and\n\\(\\tau^2 - 4\\delta > 0\\)\none positive, one negative if \\(\\delta\n< 0\\)\ncomplex conjugate pair if \\(\\tau^2 -\n4\\delta < 0\\) and \\(\\tau \\neq\n0\\), and\npure imaginary if \\(\\tau = 0\\)\nand \\(\\delta > 0\\).\nNotice that in the case that \\(A\\)\nhas a complex conjugate pair of eigenvlaue, then \\(\\tau\\) determines the sign of the real\npart. Finally, the curve\n\\[\n\\delta = \\frac{1}{4}\\tau^2\n\\] in the trace-determinant plane is the divider between real and\ncomplex eigenvalues.\nFrom a course in differential equations, we recall that for a\ntwo-dimensional system, the origin \\({\\bf\n0}\\) is classified as\na stable node if both eigenvalues are negative,\nan unstable node if both eigenvalues are positive,\na saddle if one eigenvalue if positive and one is\nnegative,\na stable spiral if the eigenvalues are complex conjugate with\nnegative real part,\nan unstable spiral if the eigenvalues are complex conjugate with\npositive real part, and\na center if the eigenvalues are pure imaginary.\nThis is summarized graphically in Figure 1:\n\nThis figure is linked from Pruffle.\n\n\n\nFigure 1: Trace-determinant plane classification of\ntwo-dimensional linear systems. Image from Pruffle.\n\n\n\nThus, the values of the trace \\(\\tau\\) and determinant \\(\\delta\\) completely specify the qualitative\nbehavior of the dynamics for a two-dimensional linear system. Let us\nexamine some examples. In each case, we use R to compute the trace,\ndeterminant, and eigenvalues of the \\(2\\times\n2\\) matrix; and we use phaseR to plot the\ncorresponding phase portrait.\nExamples\nWe code a general linear system in R as\n\n\nlin_sys <- function(t,state,parameters){\n  with(as.list(c(state,parameters)),{\n    \n    dx <- A %*% state\n    \n    list(dx)\n  })\n}\n\n\n\nStable Node Example\nConsider the linear system with \\(\\frac{d}{dt}{\\bf x} = A {\\bf x}\\)\n\\[\nA = \\left(\\begin{array}{cc} -2 & -1 \\\\ 2 & -5 \\end{array}\\right)\n\\]\nWe compute the trace, determinant, and eigenvalues as\n\n\nShow code\n\nA <- matrix(c(-2,-1,2,-5),2,2,byrow=TRUE)\n(sum(diag(A)))\n\n\n[1] -7\n\nShow code\n\n(det(A))\n\n\n[1] 12\n\nShow code\n\n(eigen(A)$values)\n\n\n[1] -4 -3\n\nThus, we predict a stable spiral. Let’s see the phase portrait:\n\n\nShow code\n\nparms_mat <- list(A=A)\nlinear_flowField  <- flowField(lin_sys,\n                                       xlim       = c(-2, 2),\n                                       ylim       = c(-2, 2),\n                                       parameters = parms_mat,\n                                       points     = 19,\n                                       add = FALSE)\nstate                        <- matrix(c(1,1,1,-1,-1,1,-1,-1,0,2,0,-2,-1,0,1,0,1,2,-1,-2),\n                                    10, 2, byrow = TRUE)\nlinear_trajectory <- trajectory(lin_sys,\n                                        y0         = state,\n                                        tlim       = c(0, 10),\n                                        parameters = parms_mat,\n                                        add=TRUE)\n\n\n\n\nSaddle Example\nConsider the linear system with \\(\\frac{d}{dt}{\\bf x} = A {\\bf x}\\)\n\\[\nA = \\left(\\begin{array}{cc} 2 & 3 \\\\ 1 & 0 \\end{array}\\right)\n\\]\nWe compute the trace, determinant, and eigenvalues as\n\n\nShow code\n\nA <- matrix(c(2,3,1,0),2,2,byrow=TRUE)\n(sum(diag(A)))\n\n\n[1] 2\n\nShow code\n\n(det(A))\n\n\n[1] -3\n\nShow code\n\n(eigen(A)$values)\n\n\n[1]  3 -1\n\nThus, we predict a saddle. Let’s see the phase portrait:\n\n\nShow code\n\nparms_mat <- list(A=A)\nlinear_flowField  <- flowField(lin_sys,\n                                       xlim       = c(-2, 2),\n                                       ylim       = c(-2, 2),\n                                       parameters = parms_mat,\n                                       points     = 19,\n                                       add = FALSE)\nstate                        <- matrix(c(0.09487,0.03162,-0.09487,-0.03162,-0.7071,0.7071,0.7071,-0.7071,\n                                         -1,1.8,-1.75,0.5,1,-1.5,1,-0.7),\n                                    8, 2, byrow = TRUE)\nlinear_trajectory <- trajectory(lin_sys,\n                                        y0         = state,\n                                        tlim       = c(0, 10),\n                                        parameters = parms_mat,\n                                        add=TRUE)\n\n\n\n\nNote that a saddle possesses a stable direction and an unstable\ndirection.\nStable Spiral Example\nConsider the linear system with \\(\\frac{d}{dt}{\\bf x} = A {\\bf x}\\)\n\\[\nA = \\left(\\begin{array}{cc} -2 & -3 \\\\ 3 & -2 \\end{array}\\right)\n\\]\nWe compute the trace, determinant, and eigenvalues as\n\n\nShow code\n\nA <- matrix(c(-2,-3,3,-2),2,2,byrow=TRUE)\n(sum(diag(A)))\n\n\n[1] -4\n\nShow code\n\n(det(A))\n\n\n[1] 13\n\nShow code\n\n(eigen(A)$values)\n\n\n[1] -2+3i -2-3i\n\nThus, we predict a stable spiral. Let’s see the phase portrait:\n\n\nShow code\n\nparms_mat <- list(A=A)\nlinear_flowField  <- flowField(lin_sys,\n                                       xlim       = c(-2, 2),\n                                       ylim       = c(-2, 2),\n                                       parameters = parms_mat,\n                                       points     = 19,\n                                       add = FALSE)\nstate                        <- matrix(c(0.09487,0.03162,-0.09487,-0.03162,-0.7071,0.7071,0.7071,-0.7071,\n                                         -1,1.8,-1.75,0.5,1,-1.5,1,-0.7),\n                                    8, 2, byrow = TRUE)\nlinear_trajectory <- trajectory(lin_sys,\n                                        y0         = state,\n                                        tlim       = c(0, 10),\n                                        parameters = parms_mat,\n                                        add=TRUE)\n\n\n\n\nCenter Example\nConsider the linear system with \\(\\frac{d}{dt}{\\bf x} = A {\\bf x}\\)\n\\[\nA = \\left(\\begin{array}{cc} -3 & 10 \\\\ -1 & 3 \\end{array}\\right)\n\\] We compute the trace, determinant, and eigenvalues as\n\n\nShow code\n\nA <- matrix(c(-3,10,-1,3),2,2,byrow=TRUE)\n(sum(diag(A)))\n\n\n[1] 0\n\nShow code\n\n(det(A))\n\n\n[1] 1\n\nShow code\n\n(eigen(A)$values)\n\n\n[1] 0+1i 0-1i\n\nThus, we predict a center. Let’s see the phase portrait:\n\n\nShow code\n\nparms_mat <- list(A=A)\nlinear_flowField  <- flowField(lin_sys,\n                                       xlim       = c(-5, 5),\n                                       ylim       = c(-4, 4),\n                                       parameters = parms_mat,\n                                       points     = 19,\n                                       add = FALSE)\nstate                        <- matrix(c(0.1,0.1,0.5,0.5,1,1,2,2),\n                                    4, 2, byrow = TRUE)\nlinear_trajectory <- trajectory(lin_sys,\n                                        y0         = state,\n                                        tlim       = c(0, 10),\n                                        parameters = parms_mat,\n                                        add=TRUE)\n\n\n\n\nNotice that a system with a center possesses periodic solutions\nbecause closed curves in the plane correspond to periodic functions.\nGeneral Linear Systems\nFor an \\(n\\times n\\) matrix with\n\\(n > 2\\) it becomes difficult to\nvisualize the dynamics as we can with the phase line for one-dimensional\nsystems or the phase plane for two-dimensional systems. Thus, when\ndealing with higher dimensional systems it is common to simply compute\nnumerical solutions to initial value problems using a numerical method\nsuch as those available using the deSolve package. Here, we\nillustrate how to do this.\nIn R, we code a general linear system as\n\n\nlin_sys <- function(t,state,parameters){\n  with(as.list(c(state,parameters)),{\n    \n    dx <- A %*% state\n    \n    list(dx)\n  })\n}\n\n\n\nSuppose we want to solve the initial value problem\n\\[\n\\begin{align}\n\\frac{d}{dt}{\\bf x} &= A {\\bf x}, \\\\\n{\\bf x}(0) = {\\bf x}_{0}\n\\end{align}\n\\] with\n\\[\nA = \\left(\\begin{array}{ccc} -3 & -1 & -1\\\\2 & -1 & 3 \\\\\n4 & -1 & -2 \\end{array}\\right)\n\\]\nand\n\\({\\bf x}_{0} = (-1,1,2)^{T}\\). This\nis done as follows:\n\n\nA <- matrix(c(-3,-1,-1,2,-1,3,4,-1,-2),3,3,byrow=TRUE)\nparms_mat <- list(A=A)\nstate <- c(-1,1,2)\ntimes <- seq(0,10,by=0.1)\nsol <- ode(y=state,times=times,func=lin_sys,parms=parms_mat)\nplot(sol)\n\n\n\n\nFurther Reading\nFor more information on the dynamics of linear systems, we recommend\nthe following sources (Allen 2007), (Barnes and Fulford 2015), (Britton 2003), (de\nVries et al. 2006), (Edelstein-Keshet 2005), (Hirsch\nand Smale 1974), (Jones, Plank, and Sleeman 2010), (Strogatz 2015).\n\n\n\nAllen, Linda J. S. 2007. Introduction to Mathematical Biology.\nPearson/Prentice Hall. https://agris.fao.org/agris-search/search.do?recordID=US201300115181.\n\n\nBarnes, B., and G. R. Fulford. 2015. Mathematical Modelling with\nCase Studies. Third. Textbooks in Mathematics.\nCRC Press, Boca Raton, FL. https://mathscinet.ams.org/mathscinet-getitem?mr=3288754.\n\n\nBritton, Nicholas F. 2003. Essential Mathematical Biology.\nSpringer Undergraduate Mathematics Series.\nSpringer-Verlag London, Ltd., London. https://doi.org/10.1007/978-1-4471-0049-2.\n\n\nEdelstein-Keshet, Leah. 2005. Mathematical Models in Biology.\nVol. 46. Classics in Applied Mathematics. Society for\nIndustrial and Applied Mathematics (SIAM), Philadelphia, PA. https://doi.org/10.1137/1.9780898719147.\n\n\nHirsch, Morris W., and Stephen Smale. 1974. Differential Equations,\nDynamical Systems, and Linear Algebra. Pure and Applied\nMathematics, Vol. 60. Academic Press [Harcourt Brace Jovanovich,\nPublishers], New York-London.\n\n\nJones, D. S., M. J. Plank, and B. D. Sleeman. 2010. Differential\nEquations and Mathematical Biology. Chapman &\nHall/CRC Mathematical and Computational\nBiology Series. CRC Press, Boca Raton, FL. https://mathscinet.ams.org/mathscinet-getitem?mr=2573923.\n\n\nStrogatz, Steven H. 2015. Nonlinear Dynamics and Chaos. Second.\nWestview Press, Boulder, CO. https://mathscinet.ams.org/mathscinet-getitem?mr=3837141.\n\n\nVries, Gerda de, Thomas Hillen, Mark Lewis, Johannes Müller, and Birgitt\nSchönfisch. 2006. A Course in Mathematical Biology. Vol. 12.\nMathematical Modeling and Computation.\nSociety for Industrial and Applied Mathematics (SIAM),\nPhiladelphia, PA. https://doi.org/10.1137/1.9780898718256.\n\n\n\n\n",
      "last_modified": "2022-03-05T14:28:24-05:00"
    },
    {
      "path": "notes012.html",
      "title": "Course Notes 12",
      "description": "Review of nonlinear systems. \n",
      "author": [
        {
          "name": "Jason M. Graham",
          "url": "https://topicsinbiomath.netlify.app/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\nContents\nGoals\nBackground\nEquilibria for Nonlinear\nSystems\n\nTwo-Dimensional Case\nPhase-Portaits\nA Gallery of\nTwo-Dimensional Systems\n\nHigher Dimensional Systems\nHodgkin-Huxley Model\n\nFurther Reading\n\nGoals\nAfter reading this section of notes, you should\nbe able to conduct a linear stability analysis for a nonlinear\nautonomous system,\nknow how to use phaseR to obtain phase-portraits for\ntwo-dimensional nonlinear systems, and\nknow how to compute numerical solutions for initial value\nproblems for nonlinear systems using deSolve.\nBackground\nPreviously, we have reviewed mathematical techniques for the analysis\nof one-dimensional autonomous systems and linear systems. In this\nsection, we consider the analogous techniques for nonlinear autonomous\nsystems of the form\n\\[\n\\frac{d}{dt}{\\bf x} = {\\bf F}({\\bf x})\n\\]\nwhere \\({\\bf x} \\in \\mathbb{R}^n\\)\nand \\({\\bf F}:\\mathbb{R}^n \\rightarrow\n\\mathbb{R}^n\\). Such a system is sometimes called a\nnonlinear vector field.\nWe have already encountered some nonlinear autonomous systems as\nmathematical models. For example, the predator-prey model, SIR model,\nand chemostat model are all nonlinear autonomous systems.\nEquilibria for Nonlinear\nSystems\nIf \\(\\frac{d}{dt}{\\bf x} = {\\bf F}({\\bf\nx})\\) is a nonlinear autonomous system, then we say that a vector\n\\({\\bf x}^{\\ast}\\) is an\nequilibrium if it satisfies \\({\\bf F}({\\bf x}^{\\ast}) = {\\bf 0}\\). A\ntypical problem is to determine the stability properties of equilibria\nfor nonlinear systems. In general this can be a difficult problem.\nHowever, in some cases when can use linearization to say something about\nthe stability of equilibria. We begin by reviewing this technique in the\ntwo-dimensional case.\nTwo-Dimensional Case\nWe can write a two-dimensional nonlinear autonomous system as\n\\[\n\\begin{align*}\n\\frac{dx}{dt} &= f(x,y) \\\\\n\\frac{dy}{dt} &= g(x,y)\n\\end{align*}\n\\]\nThen an equilibrium is a point \\((x^{\\ast},y^{\\ast})\\) satisfying the\nsimultaneous system\n\\[\n\\begin{align*}\nf(x^{\\ast},y^{\\ast}) &= 0 \\\\\ng(x^{\\ast},y^{\\ast}) &= 0\n\\end{align*}\n\\]\nFor example, the system\n\\[\n\\begin{align*}\n\\frac{dx}{dt} &= 2x - 3xy \\\\\n\\frac{dy}{dt} &= xy - 4y\n\\end{align*}\n\\]\nhas two equilibria, \\((0,0)\\) and\n\\((4,\\frac{3}{2})\\).\nIf \\((x^{\\ast},y^{\\ast})\\) is an\nequilibrium point for a two-dimensional nonlinear autonomous system,\nthen we call the matrix\n\\[\nJ_{(x^{\\ast},y^{\\ast})} = \\left(\\begin{array}{cc}\nf_{x}(x^{\\ast},y^{\\ast}) & f_{y}(x^{\\ast},y^{\\ast}) \\\\\ng_{x}(x^{\\ast},y^{\\ast}) & g_{y}(x^{\\ast},y^{\\ast}) \\end{array}\n\\right)\n\\]\nthe linearization of the system at the equilibrium\n\\((x^{\\ast},y^{\\ast})\\). It turns out\nthat in some cases, the linearization can be used to determine the\nstability of the equilibrium \\((x^{\\ast},y^{\\ast})\\). Specifically, if the\neigenvalues of \\(J_{(x^{\\ast},y^{\\ast})}\\) have\nnonzero real part, then near the equilibrium, the\nsystem behaves exactly as the corresponding linear system \\(\\frac{d}{dt}{\\bf x}= J_{(x^{\\ast},y^{\\ast})}{\\bf\nx}\\) behaves. This is a result known as the Hartman-Grobman\ntheorem.\nConsider again the example system\n\\[\n\\begin{align*}\n\\frac{dx}{dt} &= 2x - 3xy \\\\\n\\frac{dy}{dt} &= xy - 4y\n\\end{align*}\n\\]\nwhich possesses equilibria \\((0,0)\\)\nand \\((4,\\frac{3}{2})\\). Then\n\\[\nJ(0,0) = \\left(\\begin{array}{cc} 2 & 0 \\\\ 0 & -4 \\end{array}\n\\right), \\ \\ \\ J(4,\\frac{3}{2}) = \\left(\\begin{array}{cc} 0 & -12 \\\\\n\\frac{3}{2} & 0 \\end{array} \\right)\n\\] For the linearization \\(J(0,0)\\), the eigenvalues are \\(2\\) and \\(-4\\). Thus, we conclude that there is a\nsaddle at \\((0,0)\\). On the other hand,\nthe eigenvalues of \\(J(4,\\frac{3}{2})\\)\nare \\(\\pm i 3\\sqrt{2}\\) which have zero\nreal part and thus are pure imaginary. The Hartman-Grobman theorem does\nno apply and does not allow us to conclude the dynamics near \\((4,\\frac{3}{2})\\).\nPhase-Portaits\nIt is possible to study two-dimensional autonomous systems\ngeometrically analogous to what we did with one-dimesional autonomous\nsystems. But in this case, we draw a phase-plane instead of a\nphase-line. To understand this, first note that a solution to the\nsystem\n\\[\n\\begin{align*}\n\\frac{dx}{dt} &= f(x,y) \\\\\n\\frac{dy}{dt} &= g(x,y)\n\\end{align*}\n\\] with initial condition \\((x_{0},y_{0})\\) will be a parametric curve\nin the plane passing through the point \\((x_{0},y_{0})\\). We refer to such as curve\nas a trajectory of the system, The right hand side of\nthe system determines a vector field and these vectors are tangent to\ntrajectories. Thus, if we plot the vector field, then we can see all of\nthe trajectories by following vectors tangentially.\nFor example, the following plot shows the vector field for\n\\[\n\\begin{align*}\n\\frac{dx}{dt} &= 2x - 3xy \\\\\n\\frac{dy}{dt} &= xy - 4y\n\\end{align*}\n\\]\n\n\nShow code\n\nnonlinear_example <- function(t,state,parameters){\n  with(as.list(c(state,parameters)),{\n    \n    dx <- 2*state[1] - 3*state[1]*state[2]\n    dy <- state[1]*state[2] - 4*state[2]\n    \n    list(c(dx,dy))\n  })\n}\n\nnonlinear_flowfield  <- flowField(nonlinear_example,\n                                       xlim       = c(-0.5, 4.5),\n                                       ylim       = c(-0.5, 3),\n                                       parameters = NULL,\n                                       points     = 17,\n                                       add = FALSE)\n\n\n\n\nIt is easy to see that there is a saddle point at \\((0,0)\\). Furthermore, from the vector field\nit appears that there are rotations around \\((4,\\frac{3}{2})\\) which suggests either a\nsprial or perhaps a nonlinear center. We will explore this further soon.\nFirst, reacll that if \\[\n\\begin{align*}\n\\frac{dx}{dt} &= f(x,y) \\\\\n\\frac{dy}{dt} &= g(x,y)\n\\end{align*}\n\\]\nis a nonlinear system, the setting each component of the vector field\nto zero determines curves. Thus there are \\(f(x,y)=0\\) curves and \\(g(x,y)=0\\) curves. Such curves are called\nnullclines. This is due to the fact that along a \\(f(x,y)=0\\) curve, we have that \\(\\frac{dx}{dt}=0\\) and hence there is no\nchange in the \\(x\\) direction. On the\nother hand, along a \\(g(x,y)=0\\) curve,\nwe have that \\(\\frac{dy}{dt}=0\\) and\nhence there is no change in the \\(y\\)\ndirection. Note that equilibria points are exactly intersectoin points\nof distinct nullclines. The following plot shows the nullclines for the\nexample system\n\\[\n\\begin{align*}\n\\frac{dx}{dt} &= 2x - 3xy \\\\\n\\frac{dy}{dt} &= xy - 4y\n\\end{align*}\n\\]\n\n\nShow code\n\nnonlinear_flowfield  <- flowField(nonlinear_example,\n                                       xlim       = c(-0.5, 4.5),\n                                       ylim       = c(-0.5, 3),\n                                       parameters = NULL,\n                                       points     = 17,\n                                       add = FALSE)\nnonlinear_nullclines  <- nullclines(nonlinear_example,\n                                       xlim       = c(-0.5, 4.5),\n                                       ylim       = c(-0.5, 3),\n                                       points=100,add.legend=FALSE)\neq1 <- findEquilibrium(nonlinear_example, y0 = c(0,0),\n  plot.it = TRUE,summary=FALSE)\neq2 <- findEquilibrium(nonlinear_example, y0 = c(4,3/2),\n  plot.it = TRUE,summary=FALSE)\n\n\n\n\nWe can see the equilibrium points at the intersection of distinct\nnullclines. Let’s plot several trajectories to obtain a\nphase-portrait.\n\n\nShow code\n\nnonlinear_flowfield  <- flowField(nonlinear_example,\n                                       xlim       = c(-0.5, 4.5),\n                                       ylim       = c(-0.5, 3),\n                                       parameters = NULL,\n                                       points     = 17,\n                                       add = FALSE)\nnonlinear_nullclines  <- nullclines(nonlinear_example,\n                                       xlim       = c(-0.5, 4.5),\n                                       ylim       = c(-0.5, 3),\n                                       points=100,add.legend=FALSE)\neq1 <- findEquilibrium(nonlinear_example, y0 = c(0,0),\n  plot.it = TRUE,summary=FALSE)\neq2 <- findEquilibrium(nonlinear_example, y0 = c(4,3/2),\n  plot.it = TRUE,summary=FALSE)\nstate <- matrix(c(0.2,0.2,0.5,0.5,0,3,0,-1,0.01,0,-0.01,0,4,1.25),7,2,byrow = TRUE)\nnonlinear_trajs <- trajectory(nonlinear_example,\n                                        y0         = state,\n                                        tlim       = c(0, 10),\n                                        parameters = NULL,add=TRUE)\n\n\n\n\nNotice that this system has trajectories that are closed curves in\nthe plane. Thus, this system possesses periodic solutions. To confirm\nthis, let’s plot the time-series for one of the trajectories that\nappears to correspond to a periodic solution. Namely, let’s plot the\nsolution corresponding to initical condition \\((4,1.25)\\).\n\n\nShow code\n\nnum_sol <- numericalSolution(nonlinear_example,y0=c(4,1.25),tlim=c(0,10))\n\n\n\n\nWe will return to the topic of periodic solutions to nonlinear\nsystems later. For now, note that linearization cannot typically be used\nto detect the existence of periodic solutions.\nA Gallery of\nTwo-Dimensional Systems\nWhat follows is a sequence of examples of using phaseR\nto produce a phase portrait for a two-dimensional nonlinear autonomous\nsystem. As an exercise, you should attempt to determine the equilibria\nand their stability properties for each system.\n\n\\[\n\\begin{align*}\n\\frac{dx}{dt} &= x\\left(1 - \\frac{x}{2} - y \\right) \\\\\n\\frac{dy}{dt} &= y\\left(x - 1 - \\frac{y}{2} \\right)\n\\end{align*}\n\\]\n\n\nShow code\n\ngallery_example_1 <- function(t,state,parameters){\n  with(as.list(c(state,parameters)),{\n    \n    dx <- state[1]*(1 - 0.5*state[1] - state[2])\n    dy <- state[2]*(state[1] - 1 - 0.5*state[2])\n    \n    list(c(dx,dy))\n  })\n}\n\nnonlinear_flowfield  <- flowField(gallery_example_1,\n                                       xlim       = c(-3, 3),\n                                       ylim       = c(-3, 3),\n                                       parameters = NULL,\n                                       points     = 17,\n                                       add = FALSE)\nnonlinear_nullclines  <- nullclines(gallery_example_1,\n                                       xlim       = c(-3, 3),\n                                       ylim       = c(-3, 3),\n                                       points=100,add.legend=FALSE)\neq1 <- findEquilibrium(gallery_example_1, y0 = c(0,0),\n  plot.it = TRUE,summary=FALSE)\neq2 <- findEquilibrium(gallery_example_1, y0 = c(2,0),\n  plot.it = TRUE,summary=FALSE)\neq3 <- findEquilibrium(gallery_example_1, y0 = c(0,-2),\n  plot.it = TRUE,summary=FALSE)\neq4 <- findEquilibrium(gallery_example_1, y0 = c(6/5,2/5),\n  plot.it = TRUE,summary=FALSE)\nstate <- matrix(c(-0.1,-1,-0.1,2,\n                  0.01,-1,0.01,2,\n                  0.1,-1,0.1,2,-0.05,-2,\n                  0.5,1,0.05,-2,0.5,2,\n                  2,1,2,2,-1,2),13,2,byrow = TRUE)\nnonlinear_trajs <- trajectory(gallery_example_1,\n                                        y0         = state,\n                                        tlim       = c(0, 10),\n                                        parameters = NULL,add=TRUE)\n\n\n\n\n\n\\[\n\\begin{align*}\n\\frac{dx}{dt} &= y \\\\\n\\frac{dy}{dt} &= x(1-x^2) + y\n\\end{align*}\n\\]\n\n\nShow code\n\ngallery_example_2 <- function(t,state,parameters){\n  with(as.list(c(state,parameters)),{\n    \n    dx <- state[2]\n    dy <- state[1]*(1 - state[1]^2) + state[2]\n    \n    list(c(dx,dy))\n  })\n}\n\nnonlinear_flowfield  <- flowField(gallery_example_2,\n                                       xlim       = c(-3, 3),\n                                       ylim       = c(-3, 3),\n                                       parameters = NULL,\n                                       points     = 17,\n                                       add = FALSE)\nnonlinear_nullclines  <- nullclines(gallery_example_2,\n                                       xlim       = c(-3, 3),\n                                       ylim       = c(-3, 3),\n                                       points=100,add.legend=FALSE)\neq1 <- findEquilibrium(gallery_example_2, y0 = c(0,0),\n  plot.it = TRUE,summary=FALSE)\neq2 <- findEquilibrium(gallery_example_2, y0 = c(1,0),\n  plot.it = TRUE,summary=FALSE)\neq3 <- findEquilibrium(gallery_example_2, y0 = c(-1,0),\n  plot.it = TRUE,summary=FALSE)\nstate <- matrix(c(0.01,0.01,0.01,-0.01,-0.01,0.01,-0.01,-0.01,\n                  -0.5,0.0,0.5,0.0,\n                  -1,-0.1,-1,0.1,1,-0.1,1,0.1),10,2,byrow = TRUE)\nnonlinear_trajs <- trajectory(gallery_example_2,\n                                        y0         = state,\n                                        tlim       = c(0, 10),\n                                        parameters = NULL,add=TRUE)\n\n\n\n\n\n\\[\n\\begin{align*}\n\\frac{dx}{dt} &= y \\\\\n\\frac{dy}{dt} &= -x - (x^2 - 1)y\n\\end{align*}\n\\]\n\n\nShow code\n\ngallery_example_3 <- function(t,state,parameters){\n  with(as.list(c(state,parameters)),{\n    \n    dx <- state[2]\n    dy <- -state[1] + (1 - state[1]^2) * state[2]\n    \n    list(c(dx,dy))\n  })\n}\n\nnonlinear_flowfield  <- flowField(gallery_example_3,\n                                       xlim       = c(-3, 3),\n                                       ylim       = c(-3, 3),\n                                       parameters = NULL,\n                                       points     = 17,\n                                       add = FALSE)\nnonlinear_nullclines  <- nullclines(gallery_example_3,\n                                       xlim       = c(-3, 3),\n                                       ylim       = c(-3, 3),\n                                       points=100,add.legend=FALSE)\neq1 <- findEquilibrium(gallery_example_3, y0 = c(0,0),\n  plot.it = TRUE,summary=FALSE)\nstate <- matrix(c(0.01,0.01,0,2.5,2.5,-2.5),3,2,byrow = TRUE)\nnonlinear_trajs <- trajectory(gallery_example_3,\n                                        y0         = state,\n                                        tlim       = c(0, 50),\n                                        parameters = NULL,add=TRUE)\n\n\n\n\nHigher Dimensional Systems\nAs the dimension of a nonlinear system increases so does the\ndifficulty in analyzing the equilibria and their stability properties.\nOnce the dimension is three or greater, geometric analysis ranges from\nvery difficult to impossible. Thus, in Topics in Biomathematics\nwe will resign ourselves to handling larger nonlinear systems with\nnumerical computing using the deSolve package. We\nillustrate this with an example.\nHodgkin-Huxley Model\nNeuronal dynamics is concerned with the dynamical behavior of\ncomponents of the nervous system and forms the basis for computational\nneuroscience. The starting point for this field of research is the Hodgkin-Huxley\nmodel for the neuron action potential. We will discuss this model in\ndetail later. For now, we write down the equations mostly to note that\nthe model is made up of a system of four nonlinear differential\nequations:\n\\[\n\\begin{align*}\nC \\frac{d}{dt}v &= g_{\\text{na}} m^3 h (v_{\\text{na}} - v) +\ng_{\\text{k}} n^4 (v_{\\text{k}} - v) + g_{\\text{l}} (v_{\\text{l}} - v) +\ni_{\\text{ext}} \\\\\n\\frac{d}{dt}h &= \\frac{h_{\\text{inf}} - h}{\\tau_{h}} \\\\\n\\frac{d}{dt}m &= \\frac{m_{\\text{inf}} - m}{\\tau_{m}} \\\\\n\\frac{d}{dt}n &= \\frac{n_{\\text{inf}} - n}{\\tau_{n}}\n\\end{align*}\n\\] The first equation is for the neuron action potential and the\nother equations are called gating variables. The gating variables relate\nto probabilities for various ions (electrically charged molecules) to\npass through the neuronal cell membrane. Here, we solve these equations\nnumerically just to illustrate how this can be done with\ndeSolve.\n\n\nShow code\n\nsource(\"./R/gatingVariables.R\")\n\n# parameters\nparameters <- list(C=1,gk=36,gna=120,gl=0.3,vk=-82,vna=45,vl=-59,iext=10)\n\n# initial conditions\nv0 <- -50\nm0 <- alpha_m(v0)/(alpha_m(v0)+beta_m(v0));\n\nyini <- c(v=v0, h=1, m=m0, n=0.4)\n\n\nt_initial <- 0\nt_final <- 75\ntimes <- seq(from = t_initial, to = t_final, by = 0.08)\n\n\n# define function to be in the format that `ode` uses\nHH <- function (t, y, parameters) {\n   with(as.list(c(y,parameters)),{\n    # variables\n    v <- y[1]\n    h <- y[2]\n    m <- y[3]\n    n <- y[4]\n    # functional forms\n    h_inf <- alpha_h(v)/(alpha_h(v) + beta_h(v))\n    m_inf <- alpha_m(v)/(alpha_m(v) + beta_m(v))\n    n_inf <- alpha_n(v)/(alpha_n(v) + beta_n(v))\n    \n    tau_h <- 1/(alpha_h(v) + beta_h(v))\n    tau_m <- 1/(alpha_m(v) + beta_m(v))\n    tau_n <- 1/(alpha_n(v) + beta_n(v))\n  \n    dv <- (gna*m^3*h*(vna - v) + gk*n^4*(vk - v) + gl*(vl - v) + iext)/C\n    dh <- (h_inf - h)/tau_h\n    dm <- (m_inf - m)/tau_m\n    dn <- (n_inf - n)/tau_n\n    \n    return(list(c(dv, dh, dm, dn)))\n  })\n}\n\nout <- ode(y = yini, times = times, func = HH,\n           parms = parameters,method = \"ode45\")\n\n\n\nIn order to run the code above, you need an R script\ngatingVariables.R which is available here.\nLet’s plot our results:\n\n\nShow code\n\nHHsol <- data.frame(t=out[,\"time\"],v=out[,\"v\"],h=out[,\"h\"],m=out[,\"m\"],n=out[,\"n\"])\n\n\np1 <- HHsol %>%\n  ggplot(aes(x = t, y = v)) +\n  geom_line(aes(x = t, y = v),lwd=1) +\n  labs(x=\"time [ms]\",y = \"v [mV]\") +\n  theme_bw() + theme(text=element_text(size=20))\n\np2 <- HHsol %>%\n  gather(Column, Value, -t,-v) %>%\n  ggplot(aes(x = t, y = Value, color = Column)) +\n  geom_line(aes(x = t, y = Value),lwd=1) +\n  labs(x=\"time [ms]\",y = \" \") +\n  guides(color=guide_legend(title=\"Gating variable\")) + \n  theme_bw() + theme(text=element_text(size=20))\n\n(p1 + p2)\n\n\n\n\nA distinct feature of the dynamics is the periodic nonlinear\noscillations. We will have more to say about this later. From now on,\nanytime you encounter a model that is made up of large system of\nequations in Topics in Biomathematics, you should try to\nexplore the model behavior by producing numerical solutions as we have\ndone here with the Hodgkin-Huxley\nmodel.\nFurther Reading\nFor more information on the dynamics of nonlinear systems, we\nrecommend the following sources (Allen 2007), (Barnes and Fulford 2015), (Britton 2003), (de\nVries et al. 2006), (Edelstein-Keshet 2005), (Hirsch\nand Smale 1974), (Jones, Plank, and Sleeman 2010), (Strogatz 2015).\nA good reference for the Hodgkin-Huxley model is (Börgers 2017).\n\n\n\nAllen, Linda J. S. 2007. Introduction to Mathematical Biology.\nPearson/Prentice Hall. https://agris.fao.org/agris-search/search.do?recordID=US201300115181.\n\n\nBarnes, B., and G. R. Fulford. 2015. Mathematical Modelling with\nCase Studies. Third. Textbooks in Mathematics.\nCRC Press, Boca Raton, FL. https://mathscinet.ams.org/mathscinet-getitem?mr=3288754.\n\n\nBörgers, Christoph. 2017. An Introduction to Modeling Neuronal\nDynamics. Vol. 66. Texts in Applied Mathematics.\nSpringer, Cham. https://doi.org/10.1007/978-3-319-51171-9.\n\n\nBritton, Nicholas F. 2003. Essential Mathematical Biology.\nSpringer Undergraduate Mathematics Series.\nSpringer-Verlag London, Ltd., London. https://doi.org/10.1007/978-1-4471-0049-2.\n\n\nEdelstein-Keshet, Leah. 2005. Mathematical Models in Biology.\nVol. 46. Classics in Applied Mathematics. Society for\nIndustrial and Applied Mathematics (SIAM), Philadelphia, PA. https://doi.org/10.1137/1.9780898719147.\n\n\nHirsch, Morris W., and Stephen Smale. 1974. Differential Equations,\nDynamical Systems, and Linear Algebra. Pure and Applied\nMathematics, Vol. 60. Academic Press [Harcourt Brace Jovanovich,\nPublishers], New York-London.\n\n\nJones, D. S., M. J. Plank, and B. D. Sleeman. 2010. Differential\nEquations and Mathematical Biology. Chapman &\nHall/CRC Mathematical and Computational\nBiology Series. CRC Press, Boca Raton, FL. https://mathscinet.ams.org/mathscinet-getitem?mr=2573923.\n\n\nStrogatz, Steven H. 2015. Nonlinear Dynamics and Chaos. Second.\nWestview Press, Boulder, CO. https://mathscinet.ams.org/mathscinet-getitem?mr=3837141.\n\n\nVries, Gerda de, Thomas Hillen, Mark Lewis, Johannes Müller, and Birgitt\nSchönfisch. 2006. A Course in Mathematical Biology. Vol. 12.\nMathematical Modeling and Computation.\nSociety for Industrial and Applied Mathematics (SIAM),\nPhiladelphia, PA. https://doi.org/10.1137/1.9780898718256.\n\n\n\n\n",
      "last_modified": "2022-03-05T14:28:40-05:00"
    },
    {
      "path": "r_for_biomath.html",
      "title": "R for Biomathematics",
      "description": "An Introduction to R for Biomathematics\n",
      "author": [
        {
          "name": "Jason M. Graham",
          "url": "https://topicsinbiomath.netlify.app/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\nContents\nComputation in\nBiomathematics\nWhat is R?\nWhy R?\nAn Introduction to R\nInstalling R and\nRStudio\nR as a Calculator\nData in R\nLinear Algebra in R\nFunctions in R\nR Packages\nVisualization in R\nNumerical\nSolution of Differential Equations in R\nPhase-Plane Methods in\nR\n\nConclusion\n\nComputation in\nBiomathematics\nAs in other scientific disciplines, numerical and scientific\ncomputing play a central role in biomathematics. For the purposes of\nTopics in Biomathematics, we are mainly interested in the\nnumerical solution of mathematical problems, e.g., ordinary\ndifferential equations, and scientific visualization, e.g.,\nplotting functions. Numerous computing platforms or environments are\nused in biomathematics. Some notable options include\nMATLAB or Octave,\nMaple,\nPython,\nXPPAUT,\nR, and\nJulia.\nThe purpose of this document is to provide an introduction to parts\nof the R computing ecosystem that are particularly useful for\nbiomathematics.\nWhat is R?\nR is\nan open-source statistical computing platform that was developed as an\nalternative to proprietary statistical software. In the years since it’s\ninitial release, R has become immensely popular and a vast ecosystem of\nopen-source software has developed around R that greatly enhances it’s\nutility in science.\nWhy R?\nGiven many other options, why do we focus on R as the computing tool\nof choice in Topics in Biomathematics? The principal reasons\nare:\nR is free but also well-developed and widely-supported.\nEven though it was developed for statistical applications, R\nworks well for numerical computing of the sort that is useful in\nbiomathematics.\nThe RStudio integrated\ndevelopment environment (IDE) facilitates not only coding in R but also\npresenting and sharing results so as to align nicely with the course\nobjective “Communicate effectively in writing their work in applying the\ntechniques of applied mathematics to problems arising in the life\nsciences.”.\nMany biologists “speak” R and it is very helpful to have a common\nlanguage when collaborating on interdisciplinary problems.\nAn Introduction to R\nIn what follows, we illustrate some R commands that will be used\ncommonly throughout the Topics in Biomathematics course. This\ndocument is by no means comprehensive. The best ways to learn more about\nR are\nby using the swirl package,\nand\nsearching the web for specific topics.\nHere is a short video about swirl:\n\n\n\n\n\n\n\nInstalling R and RStudio\nR and RStudio are both free and easy to install. The videos below can\nserve as a helpful guide if you want to use them. Alternatively, you can\naccess R and RStudio through a web browser without direct installation\nvia RStudio Cloud. This does\nrequire an account but is free to set up.\nInstallation on Mac\nRead this\narticle or watch this video:\n\n\n\n\n\n\n\nInstallation on PC\nRead this\narticle or watch this video:\n\n\n\n\n\n\n\nRStudio Cloud\nHere is an intro to RStudio Cloud:\n\n\n\n\n\n\n\nR as a Calculator\nR can be used for basic arithmetic calculations:\n\n\n(1 + 2) # addition\n\n\n[1] 3\n\n(6 - 4) # subtraction \n\n\n[1] 2\n\n(3*5) # multiplication \n\n\n[1] 15\n\n(8/3) # division\n\n\n[1] 2.666667\n\n(2^3) # exponentiation\n\n\n[1] 8\n\nThere are also a number of mathematical functions:\n\n\n(exp(1))\n\n\n[1] 2.718282\n\n(log(1))\n\n\n[1] 0\n\n(log(exp(2)))\n\n\n[1] 2\n\n(log10(10))\n\n\n[1] 1\n\n(sin(pi/4))\n\n\n[1] 0.7071068\n\n(cos(pi/3))\n\n\n[1] 0.5\n\nSometimes it is convenient to store a value as a variable. The follow\ncode stores the value of 3 as a variable x and then\nmultiplies it by 1.5:\n\n\nx <- 3\n1.5*x\n\n\n[1] 4.5\n\nIn R, the notation <- is the assignment operator.\nYou can do arithmetic with variables just like you can with numbers.\nFor example,\n\n\nx <- 3\ny <- 10\n(x + y)\n\n\n[1] 13\n\n(x*y)\n\n\n[1] 30\n\n(y^x)\n\n\n[1] 1000\n\nYou should always pay close attention to the order of operations when\ndoing arithmetic in R. Use parentheses to make sure you compute what you\nmean to compute. For example,\n\n\n((3 - 2) * 6)\n\n\n[1] 6\n\nversus\n\n\n(3 - (2 * 6))\n\n\n[1] -9\n\nData in R\nThere are several common ways to represent different types of data in\nR. In this section we cover those that are most relevant to\nbiomathematics.\nNumeric Vectors\nIn R, we create a vector or array of values using concatenation with\nthe operator c. For example,\n\n\n(a <- c(1,5,-7))\n\n\n[1]  1  5 -7\n\ncreates a numeric vector with entries 1, 5, and -7, then we store the\nresult as a variable called a.\nWe can perform arithmetic operations on vectors. For example,\n\n\nb <- c(2,-1,6)\n(a + b) # vector addition\n\n\n[1]  3  4 -1\n\n(a-b) # vector subtraction\n\n\n[1]  -1   6 -13\n\n(a*b) # elementwise vector multiplication \n\n\n[1]   2  -5 -42\n\n(a^b) # elementwise vector exponentiation \n\n\n[1]      1.0      0.2 117649.0\n\nQuestion: In the last code block, what is happening\nto produce the result corresponding to a^b?\nWe can also call math functions on vectors. For example,\n\n\nx <- c(1,2,3)\n(exp(x))\n\n\n[1]  2.718282  7.389056 20.085537\n\n(cos(pi*x))\n\n\n[1] -1  1 -1\n\nNote that these math functions are “vectorized” in that the operate\nelementwise on a vector.\nCharacter Vectors\nWe can also create so-called character vectors in R. For example,\n\n\n(A <- c(\"calculus\",\"linear algebra\", \"differential equations\"))\n\n\n[1] \"calculus\"               \"linear algebra\"        \n[3] \"differential equations\"\n\nWe won’t make extensive use of character vectors in Topics in\nBiomathematics but it is useful to know that they exist.\nMatrices in R\nThe matrix functions allows us to create a matrix in R.\nFor example,\n\n\n(M <- matrix(c(1,2,3,4),2,2))\n\n\n     [,1] [,2]\n[1,]    1    3\n[2,]    2    4\n\n(N <- matrix(c(1,2,3,4,5,6),2,3))\n\n\n     [,1] [,2] [,3]\n[1,]    1    3    5\n[2,]    2    4    6\n\n(P <- matrix(c(1,2,3,4,5,6),3,2))\n\n\n     [,1] [,2]\n[1,]    1    4\n[2,]    2    5\n[3,]    3    6\n\n(Q <- matrix(c(1,2,3,4,5,6),2,3,byrow=TRUE))\n\n\n     [,1] [,2] [,3]\n[1,]    1    2    3\n[2,]    4    5    6\n\nLists in R\nAll of the entries in a vector or a matrix must by of the same type.\nFor example, all numeric values or all characters. In R, lists are a\ndata structure that allow us to store data of mixed types. For\nexample,\n\n\n(l1 <- list(c(1,2,3),c(\"jason\",\"graham\"),matrix(c(1,2,3,4),2,2)))\n\n\n[[1]]\n[1] 1 2 3\n\n[[2]]\n[1] \"jason\"  \"graham\"\n\n[[3]]\n     [,1] [,2]\n[1,]    1    3\n[2,]    2    4\n\n(l2 <- list(initial=c(1,12),times=seq(0,10,by=1),values=matrix(1:22,11,2))) # list with names\n\n\n$initial\n[1]  1 12\n\n$times\n [1]  0  1  2  3  4  5  6  7  8  9 10\n\n$values\n      [,1] [,2]\n [1,]    1   12\n [2,]    2   13\n [3,]    3   14\n [4,]    4   15\n [5,]    5   16\n [6,]    6   17\n [7,]    7   18\n [8,]    8   19\n [9,]    9   20\n[10,]   10   21\n[11,]   11   22\n\nNote that the entries of a list can be accessed using either indexing\nor names (provided that the list entries are named). For example,\n\n\n(l1[[2]])\n\n\n[1] \"jason\"  \"graham\"\n\n(l2[[1]])\n\n\n[1]  1 12\n\n(l2$initial)\n\n\n[1]  1 12\n\nIf a list has named elements, we can access the names using the\nnames function. For example,\n\n\nnames(l2)\n\n\n[1] \"initial\" \"times\"   \"values\" \n\nHere is a helpful video on R lists:\n\n\n\n\n\n\n\nData Frames in R\nA data frame in R is a data structure that corresponds to something\nlike a spreadsheet. A data frame is a special type of list object. You\ncan think of a data frame as a cross between a list and a matrix. Here\nis how you ceate a data frame:\n\n\n(my_data <- data.frame(course=c(\"MATH 114\",\"MATH 221\",\"MATH 222\",\"MATH 351\", \"MATH 341\"),\n                       num_students=c(10,12,8,5,7),\n                       level=c(\"F\",\"F\",\"S\",\"S\",\"T\")))\n\n\n    course num_students level\n1 MATH 114           10     F\n2 MATH 221           12     F\n3 MATH 222            8     S\n4 MATH 351            5     S\n5 MATH 341            7     T\n\nNote that a data frame contains rows and columns, every column is a\nvector (either numeric or character), and every column has the same\nnumber of entries. The columns of a data frame all have names. We can\nalso use the names function to determine the column names\nof a data frame. For example,\n\n\nnames(my_data)\n\n\n[1] \"course\"       \"num_students\" \"level\"       \n\nTypically we do not create a data frame by hand, but data is often\nread in as a data frame. The principal use of data frames in R is that\nthey are the best way to provide data to plotting functions.\nHere is a helpful video on R data frames:\n\n\n\n\n\n\n\nLinear Algebra in R\nLinear algebra plays a central role in solving problem in\nbiomathematics. This section demonstrates some linear algebra\ncomputations that will be used frequently in Topics in\nBiomathematics performed in R.\nMatrix Arithmetic\nIf \\(A\\) and \\(B\\) are matrices of the same size then we\ncan add them. Matrix addition is computed elementwise. We demonstrate\nthis in R.\n\n\n(A <- matrix(c(1,2,-1,3,1,0,2,-1,2),3,3,byrow = TRUE))\n\n\n     [,1] [,2] [,3]\n[1,]    1    2   -1\n[2,]    3    1    0\n[3,]    2   -1    2\n\n(B <- matrix(c(3,2,-1,2,1,-1,2,-3,1),3,3,byrow = TRUE))\n\n\n     [,1] [,2] [,3]\n[1,]    3    2   -1\n[2,]    2    1   -1\n[3,]    2   -3    1\n\nA + B # matrix addition\n\n\n     [,1] [,2] [,3]\n[1,]    4    4   -2\n[2,]    5    2   -1\n[3,]    4   -4    3\n\nWe can also multiply a matrix by a number (scalar multiplication). In\nR\n\n\n3 * A\n\n\n     [,1] [,2] [,3]\n[1,]    3    6   -3\n[2,]    9    3    0\n[3,]    6   -3    6\n\nRecall that if \\(A\\) is an \\(m\\times n\\) matrix and \\(B\\) is an \\(n\n\\times p\\) matrix, then we can form the matrix\nproduct \\(AB\\) which will be a\nmatrix of size \\(m\\times p\\). We\ndemonstrate this in R.\n\n\n(A <- matrix(c(1,2,-1,3,1,0,2,-1,2),3,3,byrow = TRUE))\n\n\n     [,1] [,2] [,3]\n[1,]    1    2   -1\n[2,]    3    1    0\n[3,]    2   -1    2\n\n(B <- matrix(c(3,2,-1,2,1,-1),3,2,byrow = TRUE))\n\n\n     [,1] [,2]\n[1,]    3    2\n[2,]   -1    2\n[3,]    1   -1\n\nA %*% B # matrix multiplication\n\n\n     [,1] [,2]\n[1,]    0    7\n[2,]    8    8\n[3,]    9    0\n\nA special case of matrix multiplication is matrix-vector\nmultiplication. For example,\n\n\n(v <- c(1,-1,1))\n\n\n[1]  1 -1  1\n\nA %*% v # matrix-vector multiplication \n\n\n     [,1]\n[1,]   -2\n[2,]    2\n[3,]    5\n\nMatrix Transpose and\nDeterminant\nIn R, the transpose of a matrix is obtained as follows:\n\n\nt(B)\n\n\n     [,1] [,2] [,3]\n[1,]    3   -1    1\n[2,]    2    2   -1\n\nand the determinant of a square matrix is computed as\n\n\ndet(A)\n\n\n[1] -5\n\nEigenvalues and Eigenvectors\nRecall that if \\(A\\) is a square\nmatrix (\\(n\\times n\\)), then an\neigenvalue-eigenvector pair is a number \\(\\lambda\\) and a non-zero vector \\(v\\) satisfying \\(Av=\\lambda v\\). In R, we can compute the\neigenvalues and eigenvectors for a square matrix as\n\n\n(evals_evects <- eigen(A))\n\n\neigen() decomposition\n$values\n[1]  3.1986912  1.7135379 -0.9122292\n\n$vectors\n           [,1]      [,2]       [,3]\n[1,] -0.5640780 0.1133046  0.4488745\n[2,] -0.7696551 0.4763782 -0.7042167\n[3,] -0.2990769 0.8719093 -0.5500823\n\nNote that the result is an R list that consists of\na vector that contains the eigenvalues, and\na matrix, the columns of which are the eigenvectors.\nIt is a fact from linear algebra that the determinant of a square\nmatrix is the product of its eigenvalues. Let’s confirm this with our\nexample matrix:\n\n\n(det(A))\n\n\n[1] -5\n\n(prod(evals_evects$values))\n\n\n[1] -5\n\nLet’s also confirm that \\(Av=\\lambda\nv\\) for the first eigenvalue-eigenvector pair we just\ncomputed.\n\n\n(A %*% evals_evects$vectors[ ,1])\n\n\n           [,1]\n[1,] -1.8043114\n[2,] -2.4618891\n[3,] -0.9566547\n\n(evals_evects$values[1] * evals_evects$vectors[ ,1])\n\n\n[1] -1.8043114 -2.4618891 -0.9566547\n\nFunctions in R\nA function is a programming construct that takes some number of\ninputs (possibly zero), performs some operations, and returns a value\n(which may be null). Writing functions is useful in general because it\nsaves from having to rewrite the same code over and over again, makes\ncode easier to read, and facilitates reproducibility. Additionally, code\nto compute numerical solutions to differential equations requires us to\nwrite a function specifying the differential equation. Thus, we are\nmotivated to learn a little about writing functions in R. Suppose we\nwant to create a function that inputs a number, multiplies that number\nby 2, and returns the result. Here is how you do this:\n\n\nmult_by_two <- function(x){\n  return(2*x)\n}\n\n\n\nLet’s call our function:\n\n\nmult_by_two(3)\n\n\n[1] 6\n\nWe can also do the following:\n\n\nx <- 3\nmult_by_two(x)\n\n\n[1] 6\n\nWhat if we want to multiply by an arbitrary number? One way to do\nthis is as follows:\n\n\nmult_by_a <- function(x,a=2){\n  return(a*x)\n}\n\n\n\nIn the function mult_by_a we have an optional argument\nwith a default value. If a is not specified, we multiply by\n2, if a value for a is given then it is used. For\nexample:\n\n\n(mult_by_a(3))\n\n\n[1] 6\n\n(mult_by_a(3,a=4)) # a is given by name\n\n\n[1] 12\n\nx <- 4\na <- 6\n(mult_by_a(x))\n\n\n[1] 8\n\n(mult_by_a(x,a)) # a is given by position \n\n\n[1] 24\n\nLet’s try something a little more interesting. Suppose we want to\ncompute the value of an arbitrary polynomial function. Since the\ncoefficients uniquely determine the polynomial and since R can perform\nvectorized operations, we can do the following:\n\n\npoly_func <- function(x,coeff_vect=c(1)){\n  degree <- length(coeff_vect) - 1 \n  powers <- 0:degree\n  x_powers <- x^powers\n  return(sum(coeff_vect*x_powers))\n}\n\n\n\nLet’s test our function:\n\n\n(poly_func(2))\n\n\n[1] 1\n\n(poly_func(2,coeff_vect=c(3)))\n\n\n[1] 3\n\n(poly_func(2,coeff_vect=c(0,1)))\n\n\n[1] 2\n\n(poly_func(2,coeff_vect=c(0,0,1)))\n\n\n[1] 4\n\n(poly_func(2,coeff_vect=c(1,2,3)))\n\n\n[1] 17\n\nLater we will see more examples of functions in R. In you want to\nlearn more before then, here is a helpful video on writing functions in\nR:\n\n\n\n\n\n\n\nR Packages\nR packages extend the functionality of R by implementing functions\nfor various tasks. Packages must be installed before they can be used.\nInstalling packages is easy to do. Either use the\ninstall.packages function or in RStudio use the Install\nicon on the Packages tab.\nOnce you have installed the package or packages you want to use, you\ncan load them with the library function. For Topics in\nBiomathematics we will make heavy use of the plotting packages ggplot2 and ggformula,\nand the packages deSolve\nand phaseR\nfor working with differential equations. To install these packages one\ncan use\n\n\ninstall.packages(c(\"ggplot2\",\"ggformula\",\"deSolve\",\"phaseR\"))\n\n\n\nYou only ever have to install a package once. To load these packages,\nyou run\n\n\nlibrary(ggplot2)\nlibrary(ggformula)\nlibrary(deSolve)\nlibrary(phaseR)\n\n\n\nPackages must be loaded every time you begin a new R session.\nVisualization in R\nWhen you present your work you should use figures and plots to\nclearly convey your results. As mentioned, the two packages ggplot2 and ggformula\nmake it possible to create high-quality plots in R. These packages are\npowerful and extensive so we will not be able to cover their full\nfunctionality here. Hopefully what is included here is enough to get you\nstarted, at least for the purposes of Topics in Biomathematics.\nIt should be noted that ggformula is built on top of\nggplot2.\nPlotting a Function\nHere are two ways to plot a simple mathematical function of the form\n\\(y=f(x)\\) in R:\nSuppose we want to plot \\(f(x) =\nx\\cos(x)\\) over \\([0,4\\pi]\\).\nThen we can do\n\n\ngf_function(fun = function(x){x*cos(x)},xlim=c(0,4*pi))\n\n\n\n\nor\n\n\nggplot(data.frame(x=c(0,4*pi)),aes(x=x)) + \n  geom_function(fun = function(x){x*cos(x)})\n\n\n\n\nWe can modify our plots in various ways. For example,\n\n\ngf_function(fun = function(x){x*cos(x)},xlim=c(0,4*pi),color=\"blue\",lwd=2)\n\n\n\n\nor\n\n\nggplot(data.frame(x=c(0,4*pi)),aes(x=x)) + \n  geom_function(fun = function(x){x*cos(x)},color=\"blue\",lwd=2)\n\n\n\n\nMore on Plots\nIt is possible to create a variety of different types of plots using\nggplot2 and ggformula,\nand plots creating using these packages can be highly customized. As we\ngo through the Topics in Biomathematics course we will learn a\nlittle more about the utility of these packages. For now, we refer\nanyone interested to learn more to this helpful video on\nggplot2:\n\n\n\n\n\n\n\nThis\narticle provides more information on ggformula.\nNumerical\nSolution of Differential Equations in R\nA problem that we will often encounter is to obtain a numerical\nsolution to an initial value problem (IVP) for an ordinary differential\nequation (ODE) or a system of ordinary differential equations (ODEs). An\nIVP for an ODE or ODEs typically takes the form\n\\(\\frac{d{\\bf x}}{dt} = {\\bf F}({\\bf\nx}(t),t)\\),\n\\({\\bf x}(t_{0}) = {\\bf\nx}_{0}\\).\nHere \\({\\bf x}\\) is the unknown\nfunction of time and \\({\\bf F}\\) is the\nright hand side function. These may be scalars (in case of a single ODE)\nor vectors (in case of a system of ODEs). First, we will focus on the\ncase of solving a single scalar ODE, then we will examine systems on\nODEs.\nFor example, we might want to obtain a numerical solution to\n\\(\\frac{dN}{dt} = r N\\),\n\\(N(0) = 10\\),\nwith \\(r=0.5\\) and over the time\ninterval \\([0, 5]\\).\nIn order to obtain a numerical solution to an IVP for ODEs we must\nprovide at minimum the following information to the computer:\nA function that describes the right hand side \\({\\bf F}({\\bf x}(t),t)\\). Note that \\({\\bf F}\\) may involve parameters whose\nvalues will also need to be specified.\nA time interval, \\([t_{0},t_{f}]\\), over which to obtain a\nnumerical solution.\nInitial conditions \\({\\bf\nx}_{0}\\).\nFinally, once we have obtained numerical solutions to an IVP for ODEs\nit is typically desirable to plot these solutions in one way or another.\nWe will also see examples of ways to plot our numerical solutions in\nR.\nSolving a Single ODE\nTo use the methods described in this section you must make sure that\nthe deSolve package is installed and loaded. The main\nfunction for obtaining numerical solutions in the deSolve\npackage is the ode function. In order to use it, we must\nwrite a function in R syntax that describes the right hand side of our\ndifferential equation. Let’s do this for our example problem\n\\(\\frac{dN}{dt} = r N\\),\n\\(N(0) = 10\\),\nwith \\(r=0.5\\) and over the time\ninterval \\([0, 5]\\).\n\n\nMy_RHS <- function(t,state,parameters){\n  with(as.list(c(state,parameters)),{\n    dN <- r*N\n    \n    list(c(dN))\n  })\n}\n\n\n\nIn addition to describing the right hand side of the differential\nequation, we must also specify the times at which to obtain the\nnumerical solution and the initial condition. This is done as\nfollows:\n\n\nstate <- c(N=10)\ntimes <- seq(0,5,by=0.1)\n\n\n\nNow we are ready to obtain the numerical solution:\n\n\nsolN <- ode(y=state,times=times,func=My_RHS,parms=c(r=0.5))\n\n\n\nLet’s look at what has been returned by our call to the numerical\nsolver, the results of which are stored in the variable\nsolN.\n\n\nsolN\n\n\n   time         N\n1   0.0  10.00000\n2   0.1  10.51272\n3   0.2  11.05171\n4   0.3  11.61834\n5   0.4  12.21403\n6   0.5  12.84026\n7   0.6  13.49859\n8   0.7  14.19068\n9   0.8  14.91825\n10  0.9  15.68313\n11  1.0  16.48722\n12  1.1  17.33254\n13  1.2  18.22120\n14  1.3  19.15542\n15  1.4  20.13754\n16  1.5  21.17001\n17  1.6  22.25542\n18  1.7  23.39648\n19  1.8  24.59604\n20  1.9  25.85711\n21  2.0  27.18283\n22  2.1  28.57652\n23  2.2  30.04167\n24  2.3  31.58194\n25  2.4  33.20118\n26  2.5  34.90344\n27  2.6  36.69298\n28  2.7  38.57427\n29  2.8  40.55202\n30  2.9  42.63116\n31  3.0  44.81691\n32  3.1  47.11472\n33  3.2  49.53034\n34  3.3  52.06982\n35  3.4  54.73950\n36  3.5  57.54605\n37  3.6  60.49650\n38  3.7  63.59822\n39  3.8  66.85897\n40  3.9  70.28690\n41  4.0  73.89059\n42  4.1  77.67904\n43  4.2  81.66173\n44  4.3  85.84862\n45  4.4  90.25017\n46  4.5  94.87740\n47  4.6  99.74186\n48  4.7 104.85574\n49  4.8 110.23181\n50  4.9 115.88351\n51  5.0 121.82499\n\nThe method from the deSolve package returns a\nmatrix where the first column contains the time values\nat which we obtained numerical solution values and another column that\ncontains the solution values corresponding to each of the time points.\nWe can easily plot the solution values versus the time points as\nfollows:\n\n\nplot(solN,col=\"blue\")\n\n\n\n\nA nicer plot can be obtained as follows:\n\n\nggplot(as.data.frame(solN),aes(x=time,y=N)) + geom_point()\n\n\n\n\nIf we want a curve instead:\n\n\nggplot(as.data.frame(solN),aes(x=time,y=N)) + geom_line(lwd=1)\n\n\n\n\nWe can plot the numerical solution together with the analytical\nsolution \\(N(t) = 10e^{0.5 t}\\) as\nfollows:\n\n\nggplot(as.data.frame(solN),aes(x=time,y=N)) + geom_point() + \n  geom_function(fun=function(t) 10*exp(0.5*t),color=\"blue\")\n\n\n\n\nExercise: Modify what we have done using the\ndeSolve package to obtain and plot a numerical solution to\nthe IVP\n\\(\\frac{dN}{dt} = r N\\),\n\\(N(0) = 5\\),\nwith \\(r=2.5\\) and over the time\ninterval \\([0, 10]\\).\nSolving a System of ODEs\nConsider the following problem:\n\\(\\frac{dx}{dt}=-R_{0}xy\\)\n\\(\\frac{dy}{dt}=R_{0}xy - y\\)\nwith \\(R_{0} = 0.2\\) and \\(x_{0} = 0.95\\) and \\(y_{0} = 0.05\\).\nWe can code this system of ODEs in R as:\n\n\nMy_RHS <- function(t,state,parameters){\n  with(as.list(c(state,parameters)),{\n    dx <- -R0*x*y\n    dy <- R0*x*y - y\n    \n    list(c(dx,dy))\n  })\n}\n\n\n\nWe must specify our time interval and initial conditions:\n\n\nstate <- c(x=0.95,y=0.05)\ntimes <- seq(0,20,by=0.1)\n\n\n\nNow, we are ready to obtain the numerical solution:\n\n\nSIR_sol <- ode(y=state,times=times,func=My_RHS,parms=c(R0=0.2))\n\n\n\nAgain, the method from the deSolve package returns a\nmatrix where the first column contains the time values at which we\nobtained numerical solution values and another column that contains the\nsolution values corresponding to each of the time points. We can easily\nplot the solution values versus the time points as follows:\n\n\nplot(SIR_sol,col=\"blue\")\n\n\n\n\nQuestion: Again, what happens if we change the value\nof \\(R_{0}\\) to \\(R_{0}=1.5\\)?\nOften we want to have greater control over our plots and to be able\nto make high quality figures. The best way to do this in R is to use the\ncapabilities of the ggplot2 package. In order to do this,\nwe will first convert the matrix of solutions returned by the\node function from the deSolve package into a\ndata frame. This is basically like an spread sheet format for data.\n\n\nSIR_sol_df <- as.data.frame(SIR_sol)\n\n\n\nWe can get a sense of the structure of this data by viewing the first\nfew rows:\n\n\nhead(SIR_sol_df)\n\n\n  time         x          y\n1  0.0 0.9500000 0.05000000\n2  0.1 0.9490877 0.04610860\n3  0.2 0.9482474 0.04251971\n4  0.3 0.9474732 0.03921021\n5  0.4 0.9467598 0.03615738\n6  0.5 0.9461024 0.03334179\n\nIt is convenient to change the names of the columns to something more\nmeaningful as follows:\n\n\nnames(SIR_sol_df) <- c(\"time\",\"susceptible\",\"infected\")\n\n\n\nLet’s look at the first few rows again:\n\n\nhead(SIR_sol_df)\n\n\n  time susceptible   infected\n1  0.0   0.9500000 0.05000000\n2  0.1   0.9490877 0.04610860\n3  0.2   0.9482474 0.04251971\n4  0.3   0.9474732 0.03921021\n5  0.4   0.9467598 0.03615738\n6  0.5   0.9461024 0.03334179\n\nNow, we can obtain plots by doing commands like:\n\n\nggplot(data=SIR_sol_df,mapping=aes(x=time,y=susceptible)) + geom_line()\n\n\n\n\nor\n\n\nggplot(data=SIR_sol_df,mapping=aes(x=time,y=infected)) + geom_line()\n\n\n\n\nHere are some other plotting alternatives:\n\n\n SIR_df_long <- pivot_longer(SIR_sol_df,-time,names_to = \"compartment\",values_to = \"population\")\nggplot(SIR_df_long,aes(x=time,y=population,color=compartment)) + geom_line(lwd=1)\n\n\n\n\nor\n\n\nggplot(SIR_df_long,aes(x=time,y=population)) + geom_line(lwd=1) + facet_wrap(~compartment)\n\n\n\n\nWe can also plot \\(x(t)\\) and \\(y(t)\\) together as parametric curves:\n\n\nggplot(SIR_sol_df,aes(x=susceptible,y=infected)) + geom_path(lwd=1)\n\n\n\n\nUsing color to indicate increasing values of time can be\ninteresting:\n\n\nggplot(SIR_sol_df,aes(x=susceptible,y=infected,color=time)) + geom_path(lwd=1)\n\n\n\n\nThis color scale may not be the best, let’s change it:\n\n\nggplot(SIR_sol_df,aes(x=susceptible,y=infected,color=time)) + \n  geom_path(lwd=1) +\n  scale_color_viridis_c()\n\n\n\n\nThe book (Soetaert, Cash,\nand Mazzia 2012) covers much more on numerical computing with\ndifferential equations in R.\nPhase-Plane Methods in R\nThe phaseR package facilitates the mix of qualitative\nand quantitative methods for the analysis of 1- and 2-dimensional\nautonomous systems of ODEs. We illustrate its usage.\nPhaseR for Scalar Equations\nA first-order autonmous scalar ordinary differential equation is one\nwith the general form\n\\(\\frac{dx}{dt} = f(x)\\),\nwhere \\(f(x)\\) is a continuous\n(usually even differentiable) function that does not depend explicitly\non time \\(t\\) (this is the reason for\nthe word autonomous). Most often, we are interested in the case when\n\\(f(x)\\) is a nonlinear function and we\nsometimes refer to \\(\\frac{dx}{dt} =\nf(x)\\) as a one-dimensional system.\nExample\nConsider as an example the equation\n\\(\\frac{dx}{dt} = x(1-x)\\).\nThe left hand side is the derivative \\(\\frac{dx}{dt}\\) and hence the (local) rate\nof change of \\(x\\) as a function of\ntime \\(t\\). Therefore, because of the\nequal sign, \\(f(x)\\) must also provide\ninformation about the (local) rate of change of \\(x\\) but now for various “state” values,\nthat is, values of \\(x\\).\nWe can use phaseR to analyze this problem.\nFirst we need to describe the differential equation:\n\n\nnondim_logistic <- function (t, x, parameters) \n{\n    list(x * (1 - x))\n}\n\n\n\nNow we plot what is called the phase portrait:\n\n\nnondim_logistic_phasePortrait <- phasePortrait(nondim_logistic,\n                                        ylim   = c(-0.5, 1.5),\n                                        points = 10,\n                                        frac   = 0.5)\n\n\n\n\nThe arrows here tell us, starting from an initial state value \\(x\\), whether the solution to the\ndifferential equation will increase as a function of time or decrease as\na function of time.\nFurther, we can use phaseR to obtain some “trajectories”\nto our ODE:\n\n\nnondim_logistic_flow <- flowField(nondim_logistic,\n                                 xlim       = c(0, 10),\n                                 ylim       = c(-0.5, 1.5),\n                                 parameters = NULL,\n                                 points     = 15,\n                                 system     = \"one.dim\",add=FALSE)\nnondim_logistic_solutions <- trajectory(nondim_logistic,\n                                        y0   = c(0,0.5,1,1.5),\n                                        tlim=c(0,10),\n                                        system = \"one.dim\")\n\n\n\n\nThere is an general function in phaseR that will carry\nout a complete qualitative analysis for an autonomous system (either\none-dimensional or two-dimensional). For example, call the following\nfunction in the R console:\n\n\nphasePlaneAnalysis(nondim_logistic,xlim = c(0,10),ylim = c(-1.5,1.5),system = \"one.dim\")\n\n\n\nPhaseR for Two-Dimensional\nSystems\nLet’s use phaseR to explore the dynamics of\ntwo-dimensional linear autonomous systems.\nConsider for example:\n\\(\\frac{d{\\bf x}}{dt} = A {\\bf\nx}\\),\nwhere \\(A\\) is a \\(2\\times 2\\) matrix of the form\n\\(A = \\left(\\begin{array}{cc} a & 0 \\\\\n0 & -1 \\end{array}\\right)\\).\nLet’s examine how various values of \\(a\\) change the dynamics (specifically the\nphase portraits) of the systems. Observe that as long as \\(a\\neq 0\\) there is a unique steady-state\n\\({\\bf x}^{\\ast}={\\bf 0}\\).\nPhase Portraits for Varying \\(a\\)\n\n\nsimple_linear <- function(t,state,parameters){\n  with(as.list(c(state,parameters)),{\n    dx <- a*state[1]\n    dy <- -state[2]\n    \n    list(c(dx,dy))\n  })\n}\n\n\n\n\n\na_val <- -2\n\n\n\n\n\nsimpleLinear_flowField  <- flowField(simple_linear,\n                                       xlim       = c(-2, 2),\n                                       ylim       = c(-2, 2),\n                                       parameters = c(a=a_val),\n                                       points     = 19,\n                                       add = FALSE)\n\n\n\n\nLet’s add some solution curves:\n\n\nsimpleLinear_flowField  <- flowField(simple_linear,\n                                       xlim       = c(-2, 2),\n                                       ylim       = c(-2, 2),\n                                       parameters = c(a=a_val),\n                                       points     = 19,\n                                       add = FALSE)\nstate                        <- matrix(c(1,1,1,-1,-1,1,-1,-1,0,2,0,-2,-1,0,1,0),\n                                    8, 2, byrow = TRUE)\nsimpleLinear_trajectory <- trajectory(simple_linear,\n                                        y0         = state,\n                                        tlim       = c(0, 10),\n                                        parameters = c(a=a_val),add=TRUE)\n\n\n\n\nLet’s plot the numerical solutions as a function of time for specific\ninitial conditions:\n\n\nstate <- c(x=1,y=1)\ntimes <- seq(0,10,by=0.05)\nsimple_linear_sol <- ode(y=state,times=times,func=simple_linear,parms=c(a=a_val))\nplot(simple_linear_sol,col=\"blue\")\n\n\n\n\nTwo-dimensional\nNon-Linear Autonomous Systems\nGenerally, a two-dimensional autonomous system has the form\n\\[\n\\begin{align*}\n\\frac{dx}{dt} &= f(x,y) \\\\\n\\frac{dy}{dt} &= g(x,y),\n\\end{align*}\n\\] Such as system is sometimes called a vector field.\nLet’s adapt our code to examine some phase portraits for a nonlinear\nsystem.\n\n\nnon_linear <- function(t,state,parameters){\n  with(as.list(c(state,parameters)),{\n    x <- state[1]\n    y <- state[2]\n    dx <- -x + x^3\n    dy <- -2*y\n    \n    list(c(dx,dy))\n  })\n}\n\n\n\nFirst we plot the vector field:\n\n\nnonLinear_flowField  <- flowField(non_linear,\n                                       xlim       = c(-2, 2),\n                                       ylim       = c(-2, 2),\n                                       parameters = NULL,\n                                       points     = 19,\n                                       add = FALSE)\n\n\n\n\nNow we can obtain a more detailed picture of the phase portrait:\n\n\nnonLinear_flowField  <- flowField(non_linear,\n                                       xlim       = c(-2, 2),\n                                       ylim       = c(-2, 2),\n                                       parameters = NULL,\n                                       points     = 19,\n                                       add = FALSE)\nnonLinear_nullclines <- nullclines(non_linear,\n                                        xlim       = c(-2, 2),\n                                        ylim       = c(-2, 2),\n                                        parameters = NULL,\n                                        points     = 500)\nstate                        <- matrix(c(1.5,1,1.5,-1,-1.5,1,-1.5,-1,\n                                         -0.5,1,0.5,1,-0.5,-1,0.5,-1,-1,0,1,0,0,0),\n                                    11, 2, byrow = TRUE)\nnonLinear_trajectory <- trajectory(non_linear,\n                                        y0         = state,\n                                        tlim       = c(0, 10),\n                                        parameters = NULL,add=TRUE)\n\n\n\n\nObserve that steady-states occur where nullclines intersect.\nLet’s look at the solution curves \\(x(t)\\) and \\(y(t)\\):\n\n\nstate <- c(x=-0.5,y=1)\ntimes <- seq(0,10,by=0.05)\nnon_linear_sol <- ode(y=state,times=times,func=non_linear,parms=NULL)\nplot(non_linear_sol,col=\"blue\")\n\n\n\n\nYou can learn more about the functionality of phaseR by\nreading this\npage or this\narticle.\nConclusion\nWe have very briefly touched on the basics of R that is useful in\nTopics in Biomathematics. If there are specific topics that\ninterest you or there is a specific type of problem you want to try to\nuse R to solve, we recommend searching the web as there is a plethora of\ntutorials, documentation, and helpful discussions to be found\nonline.\n\n\n\nSoetaert, Karline, Jeff Cash, and Francesca Mazzia. 2012. Solving\nDifferential Equations in R. Use r! Springer, New\nYork. https://doi.org/10.1007/978-3-642-28070-2.\n\n\n\n\n",
      "last_modified": "2022-03-05T14:29:02-05:00"
    }
  ],
  "collections": ["posts/posts.json"]
}
