<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Topics in Biomathematics: Course Notes 14</title>

  <meta property="description" itemprop="description" content="An introduction to linear difference equations."/>

  <link rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-03-16"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-03-16"/>
  <meta name="article:author" content="Jason M. Graham"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Topics in Biomathematics: Course Notes 14"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="An introduction to linear difference equations."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Topics in Biomathematics"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Topics in Biomathematics: Course Notes 14"/>
  <meta property="twitter:description" content="An introduction to linear difference equations."/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Introduction to mathematical biology;citation_publication_date=2007;citation_publisher=Pearson/Prentice Hall;citation_author=Linda J. S. Allen"/>
  <meta name="citation_reference" content="citation_title=A course in mathematical biology;citation_publication_date=2006;citation_publisher=Society for Industrial and Applied Mathematics (SIAM), Philadelphia, PA;citation_volume=12;citation_doi=10.1137/1.9780898718256;citation_author=Gerda Vries;citation_author=Thomas Hillen;citation_author=Mark Lewis;citation_author=Johannes Müller;citation_author=Birgitt Schönfisch"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","creative_commons","bibliography"]}},"value":[{"type":"character","attributes":{},"value":["Course Notes 14"]},{"type":"character","attributes":{},"value":["An introduction to linear difference equations. \n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Jason M. Graham"]},{"type":"character","attributes":{},"value":["https://topicsinbiomath.netlify.app/"]},{"type":"character","attributes":{},"value":["University of Scranton"]},{"type":"character","attributes":{},"value":["https://sites.google.com/site/jasonmgrahamus/"]}]}]},{"type":"character","attributes":{},"value":["2022-03-16"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[2]}]}]},{"type":"character","attributes":{},"value":["CC BY-NC"]},{"type":"character","attributes":{},"value":["topics_in_biomath.bib"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
  <script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
  <script src="site_libs/viz-1.8.2/viz.js"></script>
  <link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
  <script src="site_libs/grViz-binding-1.0.9/grViz.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Course Notes 14","description":"An introduction to linear difference equations.","authors":[{"author":"Jason M. Graham","authorURL":"https://topicsinbiomath.netlify.app/","affiliation":"University of Scranton","affiliationURL":"https://sites.google.com/site/jasonmgrahamus/","orcidID":""}],"publishedDate":"2022-03-16T00:00:00.000-04:00","citationText":"Graham, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">Topics in Biomathematics</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<a href="about.html">Syllabus</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Notes
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="notes001.html">Notes 1</a>
<a href="notes002.html">Notes 2</a>
<a href="notes003.html">Notes 3</a>
<a href="notes004.html">Notes 4</a>
<a href="notes005.html">Notes 5</a>
<a href="notes006.html">Notes 6</a>
<a href="notes007.html">Notes 7</a>
<a href="notes008.html">Notes 8</a>
<a href="notes009.html">Notes 9</a>
<a href="notes010.html">Notes 10</a>
<a href="notes011.html">Notes 11</a>
<a href="notes012.html">Notes 12</a>
<a href="notes013.html">Notes 13</a>
<a href="notes014.html">Notes 14</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Case Studies
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="case_study_01.html">Case Study 1</a>
</div>
</div>
<a href="r_for_biomath.html">R for Biomath</a>
<a href="course_blog.html">Course Blog</a>
<a href="https://github.com/jmgraham30">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Course Notes 14</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>An introduction to linear difference equations.</p></p>
</div>

<div class="d-byline">
  Jason M. Graham <a href="https://topicsinbiomath.netlify.app/"
class="uri">https://topicsinbiomath.netlify.app/</a> (University of
Scranton)<a href="https://sites.google.com/site/jasonmgrahamus/"
class="uri">https://sites.google.com/site/jasonmgrahamus/</a>
  
<br/>2022-03-16
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#goals">Goals</a></li>
<li><a href="#background">Background</a></li>
<li><a href="#analysis-of-linear-difference-equations">Analysis of
Linear Difference Equations</a>
<ul>
<li><a
href="#eigenvalue-analysis-of-linear-difference-equations">Eigenvalue
Analysis of Linear Difference Equations</a></li>
</ul></li>
<li><a href="#application-age-structured-models">Application:
Age-Structured Models</a>
<ul>
<li><a href="#analyzing-the-leslie-matrix-model">Analyzing the Leslie
Matrix Model</a></li>
</ul></li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#further-reading">Further Reading</a></li>
</ul>
</nav>
</div>
<h1 id="goals">Goals</h1>
<p>After reading this section of notes, you should</p>
<ol type="1">
<li><p>know what is a discrete-time model,</p></li>
<li><p>know what is a linear difference equation,</p></li>
<li><p>know how to use linear algebra techniques to analyze a linear
difference equation, and</p></li>
<li><p>be aware of some biomathematical applications of linear
difference equations.</p></li>
</ol>
<h1 id="background">Background</h1>
<p>Let <span class="math inline">\(N(t)\)</span> denote the number of a
single isolated and homogeneous population at time <span
class="math inline">\(t\)</span>. A common question is how does the
population change over time? Early on, we argued that a general model
for this is</p>
<p><span class="math inline">\(N(t+\Delta t) = N(t) + G(N(t),\Delta
t)\)</span></p>
<p>which essentially states that the change (increase or decrease) in
the population from <span class="math inline">\(t\)</span> to <span
class="math inline">\(t+\Delta t\)</span> is determined by the current
population <span class="math inline">\(N(t)\)</span> incremented by some
“growth” function <span class="math inline">\(G(N(t),\Delta t)\)</span>
which could be positive or negative. A first order approximation for
<span class="math inline">\(G\)</span> is</p>
<p><span class="math inline">\(G(N(t),\Delta t) = r \Delta t
N(t)\)</span></p>
<p>where we do not make any assumptions about the sign of <span
class="math inline">\(r\)</span>. This leads to</p>
<p><span class="math inline">\(N(t+\Delta t) = N(t) + r \Delta t
N(t)\)</span></p>
<p>Previously, we rewrote the last expression as</p>
<p><span class="math inline">\(\frac{N(t+\Delta t) - N(t)}{\Delta t} = r
N(t)\)</span></p>
<p>and took the limit as <span class="math inline">\(\Delta t
\rightarrow 0\)</span> which lead to the exponential growth model. This
involves making an assumption. Specifically, we assume that time <span
class="math inline">\(t\)</span> can be reasonably treated as a
continuous variable. There are many situations where this an appropriate
assumption. On the other hand, there are situations in which it is more
reasonable to view time as a discrete variable. Let’s now make this
assumption in the context of our population growth model. To denote this
distinction mathematically, we write <span
class="math inline">\(N(t)=N_{t}\)</span>, then our simple first-order
population growth model becomes</p>
<p><span class="math inline">\(N_{t+\Delta t} = (1+r\Delta
t)N_{t}\)</span></p>
<p>If we increment over a fixed-size time step for <span
class="math inline">\(\Delta t\)</span>, then we can write the previous
equation as</p>
<p><span class="math inline">\(N_{t+1} = \lambda N_{t}\)</span></p>
<p>This is an example of a discrete time model. In general, a discrete
time model is a sequence <span class="math inline">\(x_{0}\)</span>,
<span class="math inline">\(x_{1}\)</span>, <span
class="math inline">\(\ldots\)</span>, <span
class="math inline">\(x_{n}\)</span>, <span
class="math inline">\(x_{n+1}\)</span>, <span
class="math inline">\(\ldots\)</span>, where</p>
<p><span class="math inline">\(x_{i}\in \mathbb{R}^{p}\)</span> for all
<span class="math inline">\(i=0,1,\ldots\)</span> and for some <span
class="math inline">\(p\in \mathbb{Z}^{+}\)</span>, and</p>
<p><span
class="math inline">\(x_{i+1}=f(x_{i},x_{i-1},x_{i-2},\ldots,x_{i-k})\)</span>
for all <span class="math inline">\(i=1,2,\ldots\)</span> and some fixed
<span class="math inline">\(k\geq 0\)</span>.</p>
<p>Typically, we treat the <span class="math inline">\(x_{i}\)</span> as
unknowns and refer to the expression <span
class="math inline">\(x_{i+1}=f(x_{i},x_{i-1},x_{i-2},\ldots,x_{i-k})\)</span>
as a <strong>difference equation</strong>. A <strong>solution</strong>
of the difference equation is any sequence <span
class="math inline">\(x_{0},x_{1},\ldots\)</span> that satisfies the
recurrence defined by the difference equation.</p>
<p>If <span class="math inline">\(k=0\)</span>, then we have</p>
<p><span class="math inline">\(x_{i+1}=f(x_{i})\)</span></p>
<p>and the discrete time model is said to be
<strong>first-order</strong>.</p>
<p>In our example model <span class="math inline">\(N_{t+1} = \lambda
N_{t}\)</span> we have <span class="math inline">\(f(N_{t})=\lambda
N_{t}\)</span> with <span class="math inline">\(\lambda\)</span> a
constant. It is obviously a first-order model. Moreover, it is linear.
In general, if a discrete time model can be written as</p>
<p><span class="math inline">\(x_{t+1}= A x_{t}\)</span></p>
<p>where <span class="math inline">\(x_{t}\in \mathbb{R}^{n}\)</span>
for all <span class="math inline">\(t\)</span> and <span
class="math inline">\(A\)</span> is an <span
class="math inline">\(n\times n\)</span> matrix then we say it is a
<strong>linear difference equation</strong>.</p>
<h1 id="analysis-of-linear-difference-equations">Analysis of Linear
Difference Equations</h1>
<p>Suppose we have a linear difference equation</p>
<p><span class="math inline">\(x_{t+1}= A x_{t}\)</span></p>
<p>where <span class="math inline">\(x_{t}\in \mathbb{R}^{n}\)</span>
for all <span class="math inline">\(t\)</span> and <span
class="math inline">\(A\)</span> is an <span
class="math inline">\(n\times n\)</span> matrix, and let <span
class="math inline">\(x_{0}\)</span> be some given initial vector.
Then,</p>
<p><span class="math inline">\(x_{1} = Ax_{0},\)</span></p>
<p><span class="math display">\[
\begin{align}
x_{2} &amp;= Ax_{1} \\
&amp;= A(Ax_{0}) \\
&amp;= A^2x_{0}
\end{align}
\]</span></p>
<p>and generally,</p>
<p><span class="math display">\[
\begin{align}
x_{i+1} &amp;= Ax_{i} \\
&amp;= A(Ax_{i-1}) = A^2x_{i-1} \\
&amp;= A(A(Ax_{i-2})) = A^3x_{i-2} \\
&amp;= \ldots \\
&amp;= A^{k+1}x_{i-k} \\
&amp;= \ldots \\
&amp;= A^{i+1}x_{0}
\end{align}
\]</span></p>
<p>Thus, the solution to a linear difference equation <span
class="math inline">\(x_{t+1}=Ax_{t}\)</span> is a sequence <span
class="math inline">\(x_{0}\)</span>, <span
class="math inline">\(x_{1}=Ax_{0}\)</span>, <span
class="math inline">\(x_{2}=A^2x_{0}\)</span>, <span
class="math inline">\(\ldots\)</span>, <span
class="math inline">\(x_{n}=A^{n}x_{0}\)</span>, <span
class="math inline">\(\ldots\)</span>. Notice that to compute each term
in the sequence, we must compute the <span
class="math inline">\(n\)</span>-fold matrix power <span
class="math inline">\(A^n\)</span>. Typically, this is not convenient to
compute. Our goal is to show that there is another approach that can be
taken.</p>
<h2 id="eigenvalue-analysis-of-linear-difference-equations">Eigenvalue
Analysis of Linear Difference Equations</h2>
<p>Let <span class="math inline">\(A\)</span> be an <span
class="math inline">\(n\times n\)</span> matrix and suppose that <span
class="math inline">\(A\)</span> has a complete set of eigenvectors.
That is, suppose that <span class="math inline">\(A\)</span> has <span
class="math inline">\(n\)</span> linearly independent eigenvectors <span
class="math inline">\(v_{1},v_{2},\ldots, v_{n}\)</span> with
corresponding eigenvalues <span
class="math inline">\(\lambda_{1},\lambda_{2}\ldots,\lambda_{n}\)</span>.
Now, let <span class="math inline">\(x_0\)</span> be a vector in <span
class="math inline">\(\mathbb{R}^{n}\)</span>. We may write</p>
<p><span class="math inline">\(x_{0}=c_{1}v_{1}+c_{2}v_{2}+\cdots
+c_{n}v_{n}\)</span></p>
<p>where the <span class="math inline">\(c_{i}\)</span> are uniquely
determined scalars. Further, if <span
class="math inline">\(\lambda\)</span>, <span
class="math inline">\(v\)</span> is an eigenvalue-eigenvector pair for
<span class="math inline">\(A\)</span>, then</p>
<p><span class="math inline">\(A^n v = \lambda^n v,\)</span></p>
<p>an identity you may derive as an exercise. Using this, we see
that</p>
<p><span class="math inline">\(x_{i} = A^{i}x_{0}=c_{1}\lambda_{1}^i
v_{1} + c_{2}\lambda_{2}^i v_{2} + \cdots + c_{n}\lambda_{n}^i
v_{n}\)</span></p>
<p>and this provides another way to express a solution to a linear
difference equation. The benefit is that this does not require us to
compute matrix powers, only powers of scalars.</p>
<h3 id="example">Example</h3>
<p>Consider the linear difference equation <span
class="math inline">\(x_{t+1}=Ax_{t}\)</span> with</p>
<p><span class="math inline">\(A = \left(\begin{array}{cc} 2 &amp; 3 \\
2 &amp; 1 \end{array}\right),\)</span></p>
<p>the eigenvalues of <span class="math inline">\(A\)</span> are</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>A</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>2</span>,<span class='fl'>1</span><span class='op'>)</span>,<span class='fl'>2</span>,<span class='fl'>2</span>,byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/eigen.html'>eigen</a></span><span class='op'>(</span><span class='va'>A</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span>
</code></pre>
</div>
</details>
<pre><code>[1]  4 -1</code></pre>
</div>
<p>One can also see that if <span
class="math inline">\(\lambda_{1}=4\)</span> and <span
class="math inline">\(\lambda_{2}=-1\)</span>, then <span
class="math inline">\(v_{1}=(3,2)^{T}\)</span> and <span
class="math inline">\(v_{2}=(1,-1)^{T}\)</span> are corresponding
eigenvectors. Thus, the general solution to this example linear
difference equation is</p>
<p><span class="math inline">\(x_{i} =
c_{1}(4)^{i}\left(\begin{array}{c} 3 \\2 \end{array} \right) +
c_{2}(-1)^i\left(\begin{array}{c} 1 \\ -1 \end{array}
\right)\)</span></p>
<p>Suppose for example that <span
class="math inline">\(x_{0}=(1,1)^{T}\)</span>. To find the solution
with this particular initial condition we must find scalars <span
class="math inline">\(c_{1}\)</span> and <span
class="math inline">\(c_{2}\)</span> so that</p>
<p><span class="math inline">\(\left(\begin{array}{c} 1 \\1 \end{array}
\right) = c_{1}\left(\begin{array}{c} 3 \\ 2 \end{array} \right) +
c_{2}\left(\begin{array}{c} 1 \\ -1 \end{array} \right)\)</span></p>
<p>this can be done by solving the linear system</p>
<p><span class="math inline">\(\left(\begin{array}{cc} 3 &amp; 1 \\ 2
&amp; -1 \end{array}\right)\left(\begin{array}{c} c_{1} \\ c_{2}
\end{array} \right) = \left(\begin{array}{c} 1 \\1 \end{array}
\right)\)</span></p>
<p>which is</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>V</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>,<span class='fl'>2</span>,<span class='fl'>2</span>,byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>b</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>
<span class='op'>(</span><span class='va'>x</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/solve.html'>solve</a></span><span class='op'>(</span><span class='va'>V</span>,<span class='va'>b</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>[1]  0.4 -0.2</code></pre>
</div>
<p>So, the solution to <span
class="math inline">\(x_{t+1}=Ax_{t}\)</span> with</p>
<p><span class="math inline">\(A = \left(\begin{array}{cc} 2 &amp; 3 \\
2 &amp; 1 \end{array}\right),\)</span></p>
<p>and <span class="math inline">\(x_{0}=(1,1)^{T}\)</span> is</p>
<p><span class="math inline">\(x_{t}=\frac{2}{5}(4)^t
\left(\begin{array}{c} 3 \\ 2 \end{array} \right) - \frac{1}{5}(-1)^t
\left(\begin{array}{c} 1 \\ -1 \end{array} \right) = (4)^t
\left(\begin{array}{c} \frac{6}{5} \\ \frac{4}{5} \end{array} \right) +
(-1)^t \left(\begin{array}{c} -\frac{1}{5} \\ \frac{1}{5} \end{array}
\right)\)</span></p>
<p>An interesting question about the dynamics of discrete time models
is, what happens to the system as <span
class="math inline">\(t\rightarrow \infty\)</span>. Note that in the
expression</p>
<p><span class="math inline">\(x_{i} = c_{1}\lambda_{1}^i v_{1} +
c_{2}\lambda_{2}^i v_{2} + \cdots + c_{n}\lambda_{n}^i
v_{n}\)</span></p>
<p>if all of the eigenvalues satisfy <span
class="math inline">\(|\lambda_{i}|&lt;1\)</span>, then <span
class="math inline">\(x_{i} \rightarrow 0\)</span> as <span
class="math inline">\(i \rightarrow \infty\)</span>. Thus, if <span
class="math inline">\(x_{t+1}=Ax_{t}\)</span> is a linear difference
equation, we expect <span class="math inline">\(x_{t} \rightarrow
0\)</span> in the long-term whenever all of the eigenvalues of <span
class="math inline">\(A\)</span> have absolute value less than 1.</p>
<p>We can apply the result we just derived to our simple population
growth model <span class="math inline">\(N_{t+1}=\lambda N_{t}\)</span>
by observing that it is a one-dimensional linear difference equation.
Therefore, the general solution is <span
class="math inline">\(N_{t}=c\lambda^t N_{0}\)</span> and then the
population will die out if <span class="math inline">\(|\lambda| &lt;
1\)</span>. On the other hand, what will happen if <span
class="math inline">\(|\lambda| &gt; 1\)</span>? In the one-dimensional
case it is pretty clear, the magnitude of the population will grow
without bound. What happens in the general case <span
class="math inline">\(x_{t+1}=Ax_{t}\)</span> whenever <span
class="math inline">\(A\)</span> is an <span
class="math inline">\(n\times n\)</span> matrix?</p>
<p>To answer this question, suppose that our eigenvalues are ordered so
that <span class="math inline">\(|\lambda_1| &gt; |\lambda_2| &gt;
\cdots &gt; |\lambda_{n}|\)</span> and then rewrite</p>
<p><span class="math display">\[
\begin{align}
x_{t} &amp;= c_{1}(\lambda_{1})^tv_{1} + c_{2}(\lambda_{2})^tv_{2} +
\cdots + c_{n}(\lambda_{n})^tv_{n} \\
&amp;= \lambda_{1}^t\left(c_{1} v_{1} +
c_{2}\left(\frac{\lambda_{2}}{\lambda_{1}}\right)^t v_{2} + \cdots +
c_{n}\left( \frac{\lambda_{n}}{\lambda_{1}}\right)^t v_{n}\right)
\end{align}
\]</span></p>
<p>Now, for <span class="math inline">\(j=2,\ldots n\)</span> we have
that <span class="math inline">\(\left|
\frac{\lambda_{j}}{\lambda_{1}}\right| &lt; 1\)</span>. So, we expect
that as <span class="math inline">\(t\rightarrow \infty\)</span> each of
these terms will go to zero and <span
class="math inline">\(x_{t}\)</span> will asymptotically approach the
line determined by the vector <span
class="math inline">\(v_{1}\)</span>. For a matrix <span
class="math inline">\(A\)</span>, we call the eigenvalue of <span
class="math inline">\(A\)</span> that is largest in absolute value the
<strong>dominant eigenvalue</strong>. Thus, the dominant eigenvalue and
corresponding eigenvector determine the long-term dynamics of a discrete
dynamical system determined by a linear difference equation.</p>
<h3 id="example-1">Example</h3>
<p>Consider again the linear difference equation <span
class="math inline">\(x_{t+1}=Ax_{t}\)</span> with</p>
<p><span class="math inline">\(A = \left(\begin{array}{cc} 2 &amp; 3 \\
2 &amp; 1 \end{array}\right)\)</span></p>
<p>This matrix has dominant eigenvalue <span
class="math inline">\(\lambda_{1}=4\)</span> with corresponding
eigenvector <span class="math inline">\(v_{1}=(3,2)^{T}\)</span>. The
following figure shows the points <span
class="math inline">\(x_{t}\)</span> in the plane determined by the
sequence <span class="math inline">\(x_{t}=A^{t}x_{0}\)</span> together
with the line through the vector <span
class="math inline">\(v_{1}\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="notes014_files/figure-html5/unnamed-chunk-3-1.png" width="624" /></p>
</div>
<p>Note that we have plotted on the log scale because there is
exponential growth in the magnitude of points in the sequence of vectors
<span class="math inline">\(x_{t}\)</span>. This plot clearly shows how
the asymptotic dynamics of the discrete time model “follows” the
direction of the eigenvector corresponding with the dominant
eigenvalue.</p>
<h1 id="application-age-structured-models">Application: Age-Structured
Models</h1>
<p>An important application of linear difference equations as a discrete
time model for population growth is provided by the so-called <a
href="https://en.wikipedia.org/wiki/Leslie_matrix">Leslie matrix
model</a>. The utility of this model is that it allows us to incorporate
additional biologically interesting structure into a population model.
By “structure” we mean a feature or features that subsets of a
population may or may not have but that plays a distinguishing role in
the ecology of the species whose population growth we want to model.</p>
<p>For example, many insects progress through distinct, discrete
developmental stages such as egg, larva, pupa, adult. The reproductive
behavior and survival rate is different within each of these different
developmental stages. Thus, there is a clear age-structure involved in
the growth of such species. How does one incorporate such additional
structure into a mathematical model for the growth of a population? It
is clear that age is temporal phenomenon but aging may occur on a
different time-scale than the overall change in the size of a
population. This makes it challenging to incorporate age-structure into
a continuous-time model although this can be done. On the other hand, it
is fairly simple to develop discrete time models that include
age-structure or other similar population structures. This is done
classically using the Leslie matrix model.</p>
<p>Here is the general idea. To start with the simplest case we assume
that we have a single population that is closed to migration and we only
model females. The population is divided up into discrete groups, say
for example into <span class="math inline">\(N\)</span> groups. Denote
by <span class="math inline">\((x_{i})_{t}\)</span> the number of
individuals in group <span class="math inline">\(i\)</span> at time
<span class="math inline">\(t\)</span>. We assume that group 1
corresponds to offspring. Thus, new individuals are “born into” group 1.
For each of the groups <span class="math inline">\(i=1,2,\ldots,
N\)</span>, there is a chance of progressing from group <span
class="math inline">\(i\)</span> to group <span
class="math inline">\(i+1\)</span> determined by a value <span
class="math inline">\(s_{i}\)</span>. Further, for <span
class="math inline">\(i=1,2,\ldots, N\)</span> we let <span
class="math inline">\(b_{i}\geq 0\)</span> denote the average number of
newborn females produced by one female in the <span
class="math inline">\(i\)</span>-th age group that survive through the
time interval in which they were born. Then,</p>
<p><span class="math inline">\((x_{1})_{t+1} = b_{1}(x_{1})_{t} +
b_{2}(x_{2})_{t} + \cdots + b_{N}(x_{N})_{t}\)</span></p>
<p><span class="math inline">\((x_{i+1})_{t+1} =
s_{i}(x_{i})_{t}\)</span>, for <span
class="math inline">\(i=1,\ldots,N-1\)</span></p>
<p>We can rewrite this in matrix-vector notation as</p>
<p><span class="math display">\[
X_{t+1} = \left(\begin{array}{c} (x_{1})_{t+1}\\ (x_{2})_{t+1} \\
(x_{3})_{t+1} \\ \vdots \\ (x_{N})_{t+1}\end{array}\right) =
\left(\begin{array}{ccccc} b_{1} &amp; b_{2} &amp; \cdots &amp; b_{N-1}
&amp; b_{N} \\ s_{1} &amp; 0 &amp; \cdots &amp; 0 &amp; 0 \\ 0 &amp;
s_{2} &amp; \cdots &amp; 0 &amp; 0 \\ \vdots &amp; \vdots &amp; \ddots
&amp; \vdots &amp; \vdots \\ 0 &amp; 0 &amp; \cdots &amp; s_{N-1} &amp;
0 \end{array}\right)\left(\begin{array}{c} (x_{1})_{t}\\ (x_{2})_{t} \\
(x_{3})_{t} \\ \vdots \\ (x_{N})_{t} \end{array}\right) = LX_{t}
\]</span></p>
<p>where we call the matrix <span class="math inline">\(L\)</span> the
Leslie matrix. Here is a diagram that illustrates the Leslie matrix
model idea in the case where <span
class="math inline">\(N=4\)</span>:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>a_graph</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/pkg/DiagrammeR/man/create_graph.html'>create_graph</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/pkg/DiagrammeR/man/add_n_nodes.html'>add_n_nodes</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fl'>4</span>,label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1"</span>,<span class='st'>"2"</span>,<span class='st'>"3"</span>,<span class='st'>"4"</span><span class='op'>)</span>,
              node_aes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/DiagrammeR/man/node_aes.html'>node_aes</a></span><span class='op'>(</span>shape<span class='op'>=</span><span class='st'>"circle"</span>,color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/pkg/DiagrammeR/man/add_edges_w_string.html'>add_edges_w_string</a></span><span class='op'>(</span>edges <span class='op'>=</span> <span class='st'>"1-&gt;2 2-&gt;3 3-&gt;4 4-&gt;1 3-&gt;1 2-&gt;1 1-&gt;1"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/pkg/DiagrammeR/man/select_edges_by_edge_id.html'>select_edges_by_edge_id</a></span><span class='op'>(</span>edges <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>7</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/pkg/DiagrammeR/man/set_edge_attrs_ws.html'>set_edge_attrs_ws</a></span><span class='op'>(</span>
    edge_attr <span class='op'>=</span> <span class='va'>color</span>,
    value <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span>


<span class='fu'><a href='https://rdrr.io/pkg/DiagrammeR/man/render_graph.html'>render_graph</a></span><span class='op'>(</span><span class='va'>a_graph</span>, layout <span class='op'>=</span> <span class='st'>"circle"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div id="htmlwidget-f2c39a97204b21de7091" style="width:624px;height:384px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-f2c39a97204b21de7091">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"1\", shape = \"circle\", color = \"black\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"1.25,0!\"] \n  \"2\" [label = \"2\", shape = \"circle\", color = \"black\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"7.65404249467096e-17,1.25!\"] \n  \"3\" [label = \"3\", shape = \"circle\", color = \"black\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"-1.25,1.53080849893419e-16!\"] \n  \"4\" [label = \"4\", shape = \"circle\", color = \"black\", fillcolor = \"#F0F8FF\", fontcolor = \"#000000\", pos = \"-2.29621274840129e-16,-1.25!\"] \n\"1\"->\"2\" [color = \"black\"] \n\"2\"->\"3\" [color = \"black\"] \n\"3\"->\"4\" [color = \"black\"] \n\"4\"->\"1\" [color = \"black\"] \n\"3\"->\"1\" [color = \"black\"] \n\"2\"->\"1\" [color = \"black\"] \n\"1\"->\"1\" [color = \"black\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<p>This diagram shows the relationships among the (four in the example)
different age groups.</p>
<p>Before we proceed to consider the analysis of the dynamics of a
Leslie matrix model, note that for any Leslie matrix <span
class="math inline">\(L\)</span>, all of the entries will be
<strong>nonnegative</strong>.</p>
<h2 id="analyzing-the-leslie-matrix-model">Analyzing the Leslie Matrix
Model</h2>
<p>Given an <span class="math inline">\(n\times n\)</span> Leslie matrix
<span class="math inline">\(L\)</span>, a typical problem is to
determine if its coefficients are such that <span
class="math inline">\(L\)</span> has a <strong>strictly dominant
eigenvalue</strong> <span class="math inline">\(\lambda_{1}\)</span>.
That is, a unique eigenvalue <span
class="math inline">\(\lambda_{1}\)</span> such that <span
class="math inline">\(|\lambda_{1}| &gt; |\lambda_{j}|\)</span> for
<span class="math inline">\(j=2,3,\ldots, n\)</span>. As we have seen in
a previous section, if this is the case then <span
class="math inline">\(\lambda_{1}\)</span> and its corresponding
eigenvector <span class="math inline">\(v_{1}\)</span> determine the
long-term dynamics of the Leslie model. In the context of Leslie models,
an eigenvector <span class="math inline">\(v_{1}\)</span> associated
with a strictly dominant eigenvalue <span
class="math inline">\(\lambda_{1}\)</span> is called <strong>stable age
distribution</strong>.</p>
<p>We suspect from our previous analysis of linear difference equations
that if <span class="math inline">\(\lambda_{1}\)</span> is a strictly
dominant eigenvalue, then</p>
<ul>
<li><p>if <span class="math inline">\(|\lambda_{1}| &lt; 1\)</span>,
then the overall population size will decrease over time, and</p></li>
<li><p>if <span class="math inline">\(|\lambda_{1}| &gt; 1\)</span>,
then the population increases over time in the direction of the stable
age distribution <span class="math inline">\(v_{1}\)</span>.</p></li>
</ul>
<p>Note that if <span class="math inline">\(L\)</span> is a Leslie
matrix with a strictly dominant eigenvalue <span
class="math inline">\(\lambda_{1}\)</span>, then the entries of the
stable age distribution <span class="math inline">\(v_{1}\)</span> will
be positive.</p>
<p>Much theory has been developed for a general analysis of Leslie
matrix models, see section 1.7 of <span class="citation"
data-cites="allenIntroductionMathematicalBiology2007">(<a
href="#ref-allenIntroductionMathematicalBiology2007"
role="doc-biblioref">Allen 2007</a>)</span> for the details. Here we
will simply consider some examples.</p>
<h3 id="example-1-1">Example 1</h3>
<p>Suppose that we have a population with two age groups where only one
of the two ages is reproducing. Then the Leslie matrix model has</p>
<p><span class="math inline">\(L = \left(\begin{array}{cc} 0 &amp; b_{2}
\\ s_{1} &amp; 0 \end{array} \right)\)</span></p>
<p>where <span class="math inline">\(b_{2}\)</span> and <span
class="math inline">\(s_{1}\)</span> are positive real values. The
eigenvalues for this <span class="math inline">\(L\)</span> are obtained
by solving the quadratic polynomial</p>
<p><span class="math inline">\(\lambda^{2} - 0 \lambda + (-b_{2}s_{1}) =
0\)</span></p>
<p>and thus are <span
class="math inline">\(\lambda_{1,2}=\pm\sqrt{b_{2}s_{1}}\)</span></p>
<p>In this case, there is no strictly dominant eigenvalue because <span
class="math inline">\(|\lambda_{1,2}|=\sqrt{b_{2}s_{1}}\)</span> and
there is not a unique eigenvalue with the largest magnitude.</p>
<h3 id="example-2">Example 2</h3>
<p>Suppose that we have a population with two age groups where both are
reproducing. Then the Leslie matrix model has</p>
<p><span class="math inline">\(L = \left(\begin{array}{cc} b_{1} &amp;
b_{2} \\ s_{1} &amp; 0 \end{array} \right)\)</span></p>
<p>where <span class="math inline">\(b_{1}\)</span>, <span
class="math inline">\(b_{2}\)</span>, and <span
class="math inline">\(s_{1}\)</span> are positive real values. The
eigenvalues for this <span class="math inline">\(L\)</span> are obtained
by solving the quadratic polynomial</p>
<p><span class="math inline">\(\lambda^{2} - b_{1} \lambda +
(-b_{2}s_{1}) = 0\)</span></p>
<p>and thus are</p>
<p><span class="math inline">\(\lambda_{1,2}=\frac{b_{1} \pm
\sqrt{b_{1}^2 + 4b_{2}s_{1}}}{2}\)</span></p>
<p>Thus, there is a strictly dominant eigenvalue <span
class="math inline">\(\lambda_{1} = \frac{b_{1} + \sqrt{b_{1}^2 +
4b_{2}s_{1}}}{2}\)</span> and we have that <span
class="math inline">\(\lambda_{1} &gt; 0\)</span>. Furthermore,</p>
<p><span class="math inline">\(\lambda_{1} = \frac{b_{1} + \sqrt{b_{1}^2
+ 4b_{2}s_{1}}}{2} &gt; \frac{b_{1} + \sqrt{b_{1}^2}}{2} =
b_{1}\)</span></p>
<p>from which we see that if <span class="math inline">\(b_{1} &gt;
1\)</span>, then <span class="math inline">\(\lambda_{1} &gt;
1\)</span>. Note however that this is not the only situation in which we
can have <span class="math inline">\(\lambda_{1} &gt; 1\)</span>.</p>
<p>Let’s find the eigenvalue <span class="math inline">\(v_{1}\)</span>
corresponding to <span class="math inline">\(\lambda_{1} = \frac{b_{1} +
\sqrt{b_{1}^2 + 4b_{2}s_{1}}}{2}\)</span>. Such a vector will
satisfy</p>
<p><span class="math display">\[
(L-\lambda_{1} I)v_{1} = \left(\begin{array}{cc}
\frac{b_{1}-\sqrt{b_{1}^2+4b_{2}s_{1}}}{2}  &amp; b_{2}  \\
s_{1}  &amp;  \frac{-b_{1}-\sqrt{b_{1}^2+4b_{2}s_{1}}}{2} \end{array}
\right)\left(\begin{array}{c} x \\ y \end{array} \right) =
\left(\begin{array}{c} 0 \\ 0 \end{array}\right)
\]</span></p>
<p>and you can show (for homework) that</p>
<p><span class="math inline">\(v_{1} = \left(\begin{array}{c} 1 \\
\frac{s_{1}}{\lambda_{1}} \end{array}\right) = \left(\begin{array}{c} 1
\\ \frac{2s_{1}}{b_{1} + \sqrt{b_{1}^2 + 4b_{2}s_{1}}}
\end{array}\right)\)</span></p>
<p>satisfies the above equation. Thus,</p>
<p><span class="math inline">\(L = \left(\begin{array}{cc} b_{1} &amp;
b_{2} \\ s_{1} &amp; 0 \end{array} \right)\)</span></p>
<p>has strictly dominant eigenvalue <span
class="math inline">\(\lambda_{1} = \frac{b_{1} + \sqrt{b_{1}^2 +
4b_{2}s_{1}}}{2}\)</span> with stable age structure</p>
<p><span class="math inline">\(v_{1} = \left(\begin{array}{c} 1 \\
\frac{s_{1}}{\lambda_{1}} \end{array}\right) = \left(\begin{array}{c} 1
\\ \frac{2s_{1}}{b_{1} + \sqrt{b_{1}^2 + 4b_{2}s_{1}}}
\end{array}\right)\)</span></p>
<h3 id="example-3">Example 3</h3>
<p>Consider the following three-stage Leslie matrix</p>
<p><span class="math display">\[
L = \left(\begin{array}{ccc} 0 &amp; 9 &amp; 12\\ \frac{1}{3} &amp; 0
&amp; 0 \\ 0 &amp; \frac{1}{2} &amp; 0 \end{array}\right)
\]</span></p>
<p>We can compute the eigenvalues and eigenvectors for <span
class="math inline">\(L\)</span> with R:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>L</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>9</span>,<span class='fl'>12</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>3</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span>,<span class='fl'>0</span><span class='op'>)</span>,<span class='fl'>3</span>,<span class='fl'>3</span>,byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>(</span><span class='va'>Ls</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/eigen.html'>eigen</a></span><span class='op'>(</span><span class='va'>L</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>eigen() decomposition
$values
[1]  2+0i -1+0i -1-0i

$vectors
               [,1]          [,2]          [,3]
[1,] -0.98556187+0i  0.9370426+0i  0.9370426+0i
[2,] -0.16426031+0i -0.3123475-0i -0.3123475+0i
[3,] -0.04106508+0i  0.1561738+0i  0.1561738-0i</code></pre>
</div>
<p>From this, we see that <span class="math inline">\(L\)</span> has a
strictly dominant eigenvalue <span
class="math inline">\(\lambda_{1}=2\)</span> with corresponding stable
stage distribution -0.985561874823818+0i, -0.164260312470636+0i,
-0.0410650781176591+0i. Let’s simulate the dynamics of <span
class="math inline">\(X_{t+1}=LX_{t}\)</span> for many times-steps and
compare the last values with <span
class="math inline">\(v_{1}\)</span>:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>5</span>,<span class='fl'>2</span><span class='op'>)</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>N</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>L</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>x</span>
<span class='op'>}</span>
<span class='va'>x</span>
</code></pre>
</div>
</details>
<pre><code>             [,1]
[1,] 2.929681e+31
[2,] 4.882802e+30
[3,] 1.220701e+30</code></pre>
</div>
<p>We see that the population grows over time. Do the population values
grow in the direction of <span class="math inline">\(v_{1}\)</span>? In
order to determine this, we can determine the distance between our last
iterate and the line through <span class="math inline">\(v_{1}\)</span>,
or equivalently, we can compute the angle between the two vectors.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] 3.141593+0i</code></pre>
</div>
<p>If the angle between two vectors is 0 or <span
class="math inline">\(\pi\)</span> then they lie on the same line. We
see that our two vectros are essentially parallel. We can confirm this
by normalizing each of the vectors:</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] -0.98556187+0i -0.16426031+0i -0.04106508+0i</code></pre>
<pre><code>           [,1]
[1,] 0.98556187
[2,] 0.16426031
[3,] 0.04106508</code></pre>
</div>
<p>These vectors are obviously nearly parallel.</p>
<h1 id="conclusion">Conclusion</h1>
<p>We’ve introduced linear difference equations as an example of
discrete time systems and derived the role that the eigenvalues and
eigenvectors play in analyzing the dynamics of such systems. Notice that
much of this analysis closely parallels the analysis of continuous-time
linear autonomous systems. An important example of linear difference
equations in biomathematics is the Leslie matrix model approach to
representing the populatio dynamics for a structured population. Next,
we will study another class of discrete time systems by looking at
first-order nonlinear difference equations. As we will see, even very
simple nonlinear difference equations can exihibit very complex
dynamics.</p>
<h1 id="further-reading">Further Reading</h1>
<p>For more on discrete time models and linear difference equations in
particular, see chapter 1 from either <span class="citation"
data-cites="allenIntroductionMathematicalBiology2007">(<a
href="#ref-allenIntroductionMathematicalBiology2007"
role="doc-biblioref">Allen 2007</a>)</span> or <span class="citation"
data-cites="devriesCourseMathematicalBiology2006">(<a
href="#ref-devriesCourseMathematicalBiology2006" role="doc-biblioref">de
Vries et al. 2006</a>)</span>. Both of these books also contain
references to further reading on the topics of difference equations and
their applications within biomathematics.</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent"
role="doc-bibliography">
<div id="ref-allenIntroductionMathematicalBiology2007" class="csl-entry"
role="doc-biblioentry">
Allen, Linda J. S. 2007. <em>Introduction to Mathematical Biology</em>.
<span>Pearson/Prentice Hall</span>. <a
href="https://agris.fao.org/agris-search/search.do?recordID=US201300115181">https://agris.fao.org/agris-search/search.do?recordID=US201300115181</a>.
</div>
<div id="ref-devriesCourseMathematicalBiology2006" class="csl-entry"
role="doc-biblioentry">
Vries, Gerda de, Thomas Hillen, Mark Lewis, Johannes Müller, and Birgitt
Schönfisch. 2006. <em>A Course in Mathematical Biology</em>. Vol. 12.
Mathematical <span>Modeling</span> and <span>Computation</span>.
<span>Society for Industrial and Applied Mathematics (SIAM),
Philadelphia, PA</span>. <a
href="https://doi.org/10.1137/1.9780898718256">https://doi.org/10.1137/1.9780898718256</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
