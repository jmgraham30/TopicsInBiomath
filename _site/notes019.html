<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Topics in Biomathematics: Course Notes 19</title>

  <meta property="description" itemprop="description" content="An introduction to the Hodgkin-Huxley ODEs."/>

  <link rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-04-07"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-04-07"/>
  <meta name="article:author" content="Jason M. Graham"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Topics in Biomathematics: Course Notes 19"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="An introduction to the Hodgkin-Huxley ODEs."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Topics in Biomathematics"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Topics in Biomathematics: Course Notes 19"/>
  <meta property="twitter:description" content="An introduction to the Hodgkin-Huxley ODEs."/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=An introduction to modeling neuronal dynamics;citation_publication_date=2017;citation_publisher=Springer, Cham;citation_volume=66;citation_doi=10.1007/978-3-319-51171-9;citation_author=Christoph BÃ¶rgers"/>
  <meta name="citation_reference" content="citation_title=Mathematical foundations of neuroscience;citation_publication_date=2010;citation_publisher=Springer, New York;citation_volume=35;citation_doi=10.1007/978-0-387-87708-2;citation_author=G. Bard Ermentrout;citation_author=David H. Terman"/>
  <meta name="citation_reference" content="citation_title=A quantitative description of membrane current and its application to conduction and excitation in nerve;citation_publication_date=1952;citation_volume=117;citation_issn=0022-3751;citation_author=A. L. Hodgkin;citation_author=A. F. Huxley"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","creative_commons","bibliography"]}},"value":[{"type":"character","attributes":{},"value":["Course Notes 19"]},{"type":"character","attributes":{},"value":["An introduction to the Hodgkin-Huxley ODEs. \n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Jason M. Graham"]},{"type":"character","attributes":{},"value":["https://topicsinbiomath.netlify.app/"]},{"type":"character","attributes":{},"value":["University of Scranton"]},{"type":"character","attributes":{},"value":["https://sites.google.com/site/jasonmgrahamus/"]}]}]},{"type":"character","attributes":{},"value":["2022-04-07"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[2]}]}]},{"type":"character","attributes":{},"value":["CC BY-NC"]},{"type":"character","attributes":{},"value":["topics_in_biomath.bib"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Course Notes 19","description":"An introduction to the Hodgkin-Huxley ODEs.","authors":[{"author":"Jason M. Graham","authorURL":"https://topicsinbiomath.netlify.app/","affiliation":"University of Scranton","affiliationURL":"https://sites.google.com/site/jasonmgrahamus/","orcidID":""}],"publishedDate":"2022-04-07T00:00:00.000-04:00","citationText":"Graham, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">Topics in Biomathematics</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<a href="about.html">Syllabus</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Notes
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="notes001.html">Notes 1</a>
<a href="notes002.html">Notes 2</a>
<a href="notes003.html">Notes 3</a>
<a href="notes004.html">Notes 4</a>
<a href="notes005.html">Notes 5</a>
<a href="notes006.html">Notes 6</a>
<a href="notes007.html">Notes 7</a>
<a href="notes008.html">Notes 8</a>
<a href="notes009.html">Notes 9</a>
<a href="notes010.html">Notes 10</a>
<a href="notes011.html">Notes 11</a>
<a href="notes012.html">Notes 12</a>
<a href="notes013.html">Notes 13</a>
<a href="notes014.html">Notes 14</a>
<a href="notes015.html">Notes 15</a>
<a href="notes016.html">Notes 16</a>
<a href="notes017.html">Notes 17</a>
<a href="notes018.html">Notes 18</a>
<a href="notes019.html">Notes 19</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Case Studies
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="case_study_01.html">Case Study 1</a>
</div>
</div>
<a href="r_for_biomath.html">R for Biomath</a>
<a href="course_blog.html">Course Blog</a>
<a href="https://github.com/jmgraham30">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Course Notes 19</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>An introduction to the Hodgkin-Huxley ODEs.</p></p>
</div>

<div class="d-byline">
  Jason M. Graham <a href="https://topicsinbiomath.netlify.app/"
class="uri">https://topicsinbiomath.netlify.app/</a> (University of
Scranton)<a href="https://sites.google.com/site/jasonmgrahamus/"
class="uri">https://sites.google.com/site/jasonmgrahamus/</a>
  
<br/>2022-04-07
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#goals">Goals</a></li>
<li><a href="#background">Background</a></li>
<li><a href="#a-primer-in-neural-biophysics">A Primer in Neural
Biophysics</a></li>
<li><a href="#the-hodgkin-huxley-odes">The Hodgkin-Huxley ODEs</a>
<ul>
<li><a href="#gating-variables">Gating Variables</a></li>
<li><a href="#interpretation-of-gating-variables.">Interpretation of
Gating Variables.</a></li>
</ul></li>
<li><a href="#dynamics-of-hodgkin-huxley">Dynamics of
Hodgkin-Huxley</a></li>
<li><a href="#further-reading">Further Reading</a></li>
</ul>
</nav>
</div>
<h1 id="goals">Goals</h1>
<p>After reading this section of notes, you should</p>
<ol type="1">
<li><p>know what is a membrane potential, an action potential, and an
ion channel in the context of nerve cells (neurons);</p></li>
<li><p>have an appreciation for how the classical Hodgkin-Huxley ODEs
model essential biophysics of neurons; and</p></li>
<li><p>be aware of some of the dynamics exhibited by neural systems and
how this relates to neural physiology.</p></li>
</ol>
<h1 id="background">Background</h1>
<p>Nerve cells known as <a
href="https://en.wikipedia.org/wiki/Neuron">neurons</a> can produce
electrical impulses. During the 1940s and 1950s scientists conducted and
published research results that elucidate the biophysics of nerve cell
electrical impulses. This work is remarkable for its synthesis of
experiment and theory. In particular, researchers measured electrical
output from the <a
href="https://en.wikipedia.org/wiki/Squid_giant_axon">giant axon of a
squid</a> and used these measurements as a basis for deriving a
mathematical model that captures key features of the so-called <a
href="https://en.wikipedia.org/wiki/Action_potential">action
potential</a> of the neuron.</p>
<p>Noteworthy is the paper <a
href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1392413/"><em>A
quantitative description of membrane current and its application to
conduction and excitation in nerve</em></a> by <a
href="https://en.wikipedia.org/wiki/Alan_Hodgkin">Alan Hodgkin</a> and
<a href="https://en.wikipedia.org/wiki/Andrew_Huxley">Andrew Huxley</a>
which presents equations now known as the <a
href="https://en.wikipedia.org/wiki/Hodgkin%E2%80%93Huxley_model">Hodgkin-Huxley
model</a>. This paper is one in a series of five papers presenting
research for which Hodgkin and Huxley where eventually awarded a <a
href="https://en.wikipedia.org/wiki/Nobel_Prize_in_Physiology_or_Medicine">Nobel
Prize in Physiology or Medicine</a>. The Hodgkin-Huxley model is
foundational for mathematical and <a
href="https://en.wikipedia.org/wiki/Computational_neuroscience">computational
neuroscience</a>, and the equations have generated a lot of interest in
the field of biomathematics due to the interesting dynamics they
exhibit.</p>
<p>In this section of notes, we present the classical Hodgkin-Huxley
ODEs and attempt to explain what they model. Additionally, we suggest
some other avenues of research in mathematical neuroscience. We proceed
by quickly reviewing the biophysical concepts that are most essential in
understanding the meaning of the terms in the Hodgkin-Huxley model.</p>
<h1 id="a-primer-in-neural-biophysics">A Primer in Neural
Biophysics</h1>
<p>Here we follow section 1.1 of <span class="citation"
data-cites="borgersIntroductionModelingNeuronal2017">(<a
href="#ref-borgersIntroductionModelingNeuronal2017"
role="doc-biblioref">BÃ¶rgers 2017</a>)</span> in presenting the
biophysical background and terminology needed to understand the
formulation of the classical Hodgkin-Huxley ODEs.</p>
<p>Recall from physics that <a
href="https://en.wikipedia.org/wiki/Electric_potential">electric
potential</a> is the work required to move a unit of electric charge.
Nerve and muscle cells contain and are surrounded by charged particles
in the form of ions. This may result in a difference in electric
potential between the exterior and interior of a cell that is known as a
<a href="https://en.wikipedia.org/wiki/Membrane_potential">membrane
potential</a>. Further, nerve and muscle cells are capable of generating
brief spikes in the membrane potential creating what is known as an <a
href="https://en.wikipedia.org/wiki/Action_potential">action
potential</a>. Thus, physiologists say that nerve and muscle cells are
<strong>excitable</strong>. Our goal is to understand and model the
mechanisms underlying the electrical activity in nerve cells known as
neurons.</p>
<p><a href="https://en.wikipedia.org/wiki/Neuron">Neurons</a> are one of
the primary cells in the brain. A neuron possesses a cell body known as
a <a href="https://en.wikipedia.org/wiki/Soma_(biology)">soma</a>, input
branches called <a
href="https://en.wikipedia.org/wiki/Dendrite">dendrites</a>, and an
output unit known as an <a
href="https://en.wikipedia.org/wiki/Axon">axon</a>. Moreover, neurons
are filled and surrounded by fluid containing sodium (<span
class="math inline">\(\text{Na}^{+}\)</span>), potassium (<span
class="math inline">\(\text{K}^{+}\)</span>), chloride (<span
class="math inline">\(\text{Cl}^{-}\)</span>), and calcium (<span
class="math inline">\(\text{Ca}^{2+}\)</span>) ions. The superscripts
denote the electric charge of the ion. We will denote the concentration
of ion <span class="math inline">\(\text{X}\)</span> by <span
class="math inline">\([\text{X}]_{\text{in}}\)</span> if it is within
the cell and <span class="math inline">\([\text{X}]_{\text{ex}}\)</span>
if it is outside the cell.</p>
<p>It is known that ions can pass through the cell membrane of a neuron
through so-called <a
href="https://en.wikipedia.org/wiki/Ion_channel">ion channels</a>. These
channels are typically ion specific in that a sodium ion channel only
lets sodium through, a potassium channel only lets potassium through,
and so on. Additionally, there are ion pumps at the neuron cell membrane
that actively transport ions in or out of a cell but not necessarily at
the same rate. For example, the well-known <a
href="https://en.wikipedia.org/wiki/Sodium-potassium_pump">sodium-potassium</a>
pump removes sodium and intakes potassium at a 2 potassium for 3 sodium
ratio. The point is that this prevents the occurrence of a perfect
balance of ion concentrations inside and outside of a neuron cell
membrane. Thus, we have an explanation for the membrane potential of a
neuron.</p>
<p>Going further, the membrane potential of a neuron can decrease (known
as hyperpolarization) creating a so-called inhibitory state, or increase
(known as depolarization) creating a so-called excitatory state.
Researchers have observed experimentally these changes in time of the
membrane potential of neurons. See, for example, figures in the paper of
<a href="https://academic.oup.com/brain/article/135/9/2613/326668">Han
et al,</a> where one can see a plot of a recording of membrane potential
from a neuron in the superior cervical ganglion of a rat. What is seen
is that the voltage corresponding to the membrane potential slowly rises
until it reaches a threshold level (known as a firing threshold) then a
sudden rapid increase in voltage occurs creating a action potential.
When a neuron generates an action potential, one often says that it
spikes or fires. This is all based on opening and closing of ion
channels and the ion channel activity is incorporated into the
Hodgkin-Huxley mathematical we describe next.</p>
<h1 id="the-hodgkin-huxley-odes">The Hodgkin-Huxley ODEs</h1>
<p>Let <span class="math inline">\(v(t)\)</span> denote the neuron
membrane potential at time <span class="math inline">\(t\)</span>
measured in units of millivolts (mV). For the purposes of the
Hodgkin_Huxley model, time will be measured in units of milliseconds
(ms). A principle part of the Hodgkin-Huxley models expresses how <span
class="math inline">\(v\)</span> changes over time. We start by assuming
that a nerve cell membrane acts as a <a
href="https://en.wikipedia.org/wiki/Capacitor">capacitor</a> so that</p>
<p><span class="math inline">\(Cv = Q\)</span></p>
<p>where <span class="math inline">\(C\)</span> is the (constant)
capacitance and <span class="math inline">\(Q\)</span> is the electric
charge across the membrane. Recall that the total current relates to the
charge by</p>
<p><span class="math inline">\(I_{\text{total}} =
\frac{dQ}{dt}\)</span></p>
<p>so that if we differentiate both sides of <span
class="math inline">\(Cv=Q\)</span> we obtain</p>
<p><span class="math inline">\(C\frac{dv}{dt} =
I_{\text{total}}\)</span></p>
<p>Based on experiments, Hodgkin adn Huxley determined that the total
current <span class="math inline">\(I_{\text{total}}\)</span> arises
from a combination of</p>
<ul>
<li><p>a sodium induced current <span
class="math inline">\(I_{\text{Na}}\)</span>,</p></li>
<li><p>a potassium induced current <span
class="math inline">\(I_{\text{K}}\)</span>,</p></li>
<li><p>a âleakâ current <span
class="math inline">\(I_{\text{L}}\)</span> induced by chloride and
other ions, and</p></li>
<li><p>an experimentally injected current <span
class="math inline">\(I\)</span>.</p></li>
</ul>
<p>Thus,</p>
<p><span class="math inline">\(C\frac{dv}{dt} = I_{\text{Na}} +
I_{\text{K}} + I_{\text{L}} + I\)</span></p>
<p>which is the primary equation for the time rate of chance of the
membrane potential <span class="math inline">\(v\)</span>.</p>
<p>Further, it is assumed that the sodium, potassium, and leak currents
all obey <a href="https://en.wikipedia.org/wiki/Ohm%27s_law">Ohmâs
law</a> which states that the current is proportional to a difference in
voltage leading to equations</p>
<p><span class="math display">\[
\begin{align}
I_{\text{Na}} &amp;= g_{\text{Na}}(v_{\text{Na}} - v) \\
I_{\text{K}} &amp;= g_{\text{K}}(v_{\text{K}} - v) \\
I_{\text{L}} &amp;= g_{\text{L}}(v_{\text{L}} - v)
\end{align}
\]</span> where <span class="math inline">\(v_{\text{Na}}\)</span>,
<span class="math inline">\(v_{\text{K}}\)</span>, and <span
class="math inline">\(v_{\text{L}}\)</span> are the <a
href="https://en.wikipedia.org/wiki/Reversal_potential">reversal
potential</a> values for sodium. potassium, and leak, respectively. The
values <span class="math inline">\(g_{\text{Na}}\)</span>, <span
class="math inline">\(g_{\text{K}}\)</span>, and <span
class="math inline">\(g_{\text{L}}\)</span> are the <a
href="https://en.wikipedia.org/wiki/Electrical_resistance_and_conductance">conductances</a>.
Thus, we have that</p>
<p><span class="math inline">\(C\frac{dv}{dt} =
g_{\text{Na}}(v_{\text{Na}} - v) + g_{\text{K}}(v_{\text{K}} - v) +
g_{\text{L}}(v_{\text{L}} - v) + I\)</span></p>
<p>This appears to be a fairly simple equation. However, it has been
determined that while that leak conductance <span
class="math inline">\(g_{\text{L}}=\bar{g}_{\text{L}}\)</span> with
<span class="math inline">\(\bar{g}_{\text{L}}\)</span> a constant, in
contrast, the sodium and potassium conductances change in time in
concert with the membrane potential <span
class="math inline">\(v\)</span>. Thus, it is required to derive
equations that relate how the sodium and potassium conductance functions
vary. In order to do this, we take in to account the actions of the ion
channels discussed previously.</p>
<h2 id="gating-variables">Gating Variables</h2>
<p>From an analysis of experimental results, Hodgkin and Huxley
concluded that</p>
<p><span class="math display">\[
\begin{align}
g_{\text{Na}}(t) &amp;= \bar{g}_{\text{Na}} m(t)^3 h(t) \\
g_{\text{K}}(t) &amp;= \bar{g}_{\text{K}} n(t)^4
\end{align}
\]</span> where the three <strong>gating variables</strong> <span
class="math inline">\(m\)</span>, <span
class="math inline">\(h\)</span>, and <span
class="math inline">\(n\)</span> are dimensionless time varying
functions that each satisfy a differential equation of the form</p>
<p><span class="math inline">\(\frac{dx}{dt} = \frac{x_{\infty}(v) -
x}{\tau_{x}(v)}\)</span></p>
<p>where <span class="math inline">\(x_{\infty}(v)\)</span> and <span
class="math inline">\(\tau_{x}(v)\)</span> are functional forms
depending on the membrane potential.</p>
<p>Thus, the Hodgkin-Huxley model is</p>
<p><span class="math display">\[
\begin{align}
C\frac{dv}{dt} &amp;= \bar{g}_{\text{Na}}m^3 h (v_{\text{Na}} - v) +
\bar{g}_{\text{K}}n^4(v_{\text{K}} - v) +
\bar{g}_{\text{L}}(v_{\text{L}} - v) + I \\
\frac{dm}{dt} &amp;= \frac{m_{\infty}(v) - m}{\tau_{m}(v)} \\
\frac{dh}{dt} &amp;= \frac{h_{\infty}(v) - h}{\tau_{h}(v)} \\
\frac{dn}{dt} &amp;= \frac{n_{\infty}(v) - n}{\tau_{n}(v)}
\end{align}
\]</span></p>
<p>which is a coupled system of nonlinear equations. We still need to
describe the functional forms <span
class="math inline">\(m_{\infty}(v)\)</span>, <span
class="math inline">\(\tau_{m}(v)\)</span>; <span
class="math inline">\(h_{\infty}(v)\)</span>, <span
class="math inline">\(\tau_{h}(v)\)</span>; and <span
class="math inline">\(n_{\infty}(v)\)</span>, <span
class="math inline">\(\tau_{n}(v)\)</span>, but first we consider what
is the biophysical interpretation of the gating variables <span
class="math inline">\(m\)</span>, <span
class="math inline">\(h\)</span>, and <span
class="math inline">\(n\)</span>.</p>
<h2 id="interpretation-of-gating-variables.">Interpretation of Gating
Variables.</h2>
<p>A sodium channel has four gates aligned in series such that three of
the gates are of one type (say type m), and one of the gates is of a
second type (say type h). If <span class="math inline">\(m\)</span> is
the fraction of open m-gates and <span class="math inline">\(h\)</span>
is the fraction of open h-gates, then the fraction of open sodium
channels is <span class="math inline">\(m^3h\)</span>. Similarly, we
assume that potassium has four gates aligned in series all of the same
type, type n.Â Then the fraction of open potassium channels is <span
class="math inline">\(n^4\)</span>.</p>
<h3 id="plots-of-gating-variable-functional-forms">Plots of Gating
Variable Functional Forms</h3>
<p>As mentioned, each of the gating variables <span
class="math inline">\(m\)</span>, <span
class="math inline">\(h\)</span>, and <span
class="math inline">\(n\)</span> satisfy a differential equation of the
form</p>
<p><span class="math inline">\(\frac{dx}{dt} = \frac{x_{\infty}(v) -
x}{\tau_{x}(v)}\)</span></p>
<p>where there are two functional forms for each equation. The
functional forms <span class="math inline">\(x_{\infty}(v)\)</span> for
<span class="math inline">\(x=m,h,n\)</span> can be thought of as
equilibrium values for <span class="math inline">\(m,h,n\)</span> but
ones that vary with the value of <span class="math inline">\(v\)</span>.
The functional forms <span class="math inline">\(\tau_{x}(v)\)</span>
establish the time-scale on which an equilibrium is reached. Detailed
expressions for these functional forms may be found on page 19 of <span
class="citation"
data-cites="borgersIntroductionModelingNeuronal2017">(<a
href="#ref-borgersIntroductionModelingNeuronal2017"
role="doc-biblioref">BÃ¶rgers 2017</a>)</span>. Insead of writing them
down here, we implement them in R code and display their graphs.</p>
<p>Here is the R code implementing the functional forms:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>alpha_h</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>alpha_h</span><span class='op'>&lt;-</span><span class='fl'>0.07</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='op'>(</span><span class='va'>v</span><span class='op'>+</span><span class='fl'>70</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>20</span><span class='op'>)</span>  
<span class='op'>}</span>


<span class='va'>alpha_m</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>a_m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>v</span><span class='op'>+</span><span class='fl'>45</span><span class='op'>)</span><span class='op'>&gt;</span><span class='fl'>1.0e-8</span>,<span class='op'>(</span><span class='va'>v</span><span class='op'>+</span><span class='fl'>45</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>10.</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='op'>(</span><span class='va'>v</span><span class='op'>+</span><span class='fl'>45</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>,<span class='fl'>1</span><span class='op'>)</span>
  
<span class='op'>}</span>


<span class='va'>alpha_n</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>alpha_n</span><span class='op'>&lt;-</span><span class='fl'>0.01</span><span class='op'>*</span><span class='op'>(</span><span class='op'>-</span><span class='fl'>60.0</span><span class='op'>-</span><span class='va'>v</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>(</span><span class='op'>-</span><span class='fl'>60</span><span class='op'>-</span><span class='va'>v</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>  
<span class='op'>}</span>


<span class='va'>beta_h</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>beta_h</span><span class='op'>&lt;-</span><span class='fl'>1.</span><span class='op'>/</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='op'>(</span><span class='va'>v</span><span class='op'>+</span><span class='fl'>40</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span>  
<span class='op'>}</span>


<span class='va'>beta_m</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>beta_m</span><span class='op'>&lt;-</span><span class='fl'>4</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='op'>(</span><span class='va'>v</span><span class='op'>+</span><span class='fl'>70</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>18</span><span class='op'>)</span>  
<span class='op'>}</span>


<span class='va'>beta_n</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>beta_n</span><span class='op'>&lt;-</span><span class='fl'>0.125</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='op'>(</span><span class='va'>v</span><span class='op'>+</span><span class='fl'>70</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>80</span><span class='op'>)</span>  
<span class='op'>}</span>

<span class='va'>h_inf</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>{</span><span class='fu'>alpha_h</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fu'>alpha_h</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>beta_h</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>)</span><span class='op'>}</span>
<span class='va'>m_inf</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>{</span><span class='fu'>alpha_m</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fu'>alpha_m</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>beta_m</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>)</span><span class='op'>}</span>
<span class='va'>n_inf</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>{</span><span class='fu'>alpha_n</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fu'>alpha_n</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>beta_n</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>)</span><span class='op'>}</span>
    
<span class='va'>tau_h</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>{</span><span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='fu'>alpha_h</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>beta_h</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>)</span><span class='op'>}</span>
<span class='va'>tau_m</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>{</span><span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='fu'>alpha_m</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>beta_m</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>)</span><span class='op'>}</span>
<span class='va'>tau_n</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>{</span><span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='fu'>alpha_n</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>beta_n</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>)</span><span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<p>Here are plots of the functional forms.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>v_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>100</span>,<span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p_m_inf</span> <span class='op'>&lt;-</span> <span class='va'>v_df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>v</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_function.html'>geom_function</a></span><span class='op'>(</span>fun<span class='op'>=</span><span class='va'>m_inf</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"v [mV]"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='fu'><a href='https://www.stefanom.io/latex2exp/reference/TeX.html'>TeX</a></span><span class='op'>(</span><span class='st'>r'($m_{\infty}$)'</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p_m_tau</span> <span class='op'>&lt;-</span> <span class='va'>v_df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>v</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_function.html'>geom_function</a></span><span class='op'>(</span>fun<span class='op'>=</span><span class='va'>tau_m</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"v [mV]"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='fu'><a href='https://www.stefanom.io/latex2exp/reference/TeX.html'>TeX</a></span><span class='op'>(</span><span class='st'>r'($\tau_{m}$ (ms))'</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p_h_inf</span> <span class='op'>&lt;-</span> <span class='va'>v_df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>v</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_function.html'>geom_function</a></span><span class='op'>(</span>fun<span class='op'>=</span><span class='va'>h_inf</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"v [mV]"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='fu'><a href='https://www.stefanom.io/latex2exp/reference/TeX.html'>TeX</a></span><span class='op'>(</span><span class='st'>r'($h_{\infty}$)'</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p_h_tau</span> <span class='op'>&lt;-</span> <span class='va'>v_df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>v</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_function.html'>geom_function</a></span><span class='op'>(</span>fun<span class='op'>=</span><span class='va'>tau_h</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"v [mV]"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='fu'><a href='https://www.stefanom.io/latex2exp/reference/TeX.html'>TeX</a></span><span class='op'>(</span><span class='st'>r'($\tau_{h}$ (ms))'</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p_n_inf</span> <span class='op'>&lt;-</span> <span class='va'>v_df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>v</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_function.html'>geom_function</a></span><span class='op'>(</span>fun<span class='op'>=</span><span class='va'>n_inf</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"v [mV]"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='fu'><a href='https://www.stefanom.io/latex2exp/reference/TeX.html'>TeX</a></span><span class='op'>(</span><span class='st'>r'($n_{\infty}$)'</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p_n_tau</span> <span class='op'>&lt;-</span> <span class='va'>v_df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>v</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_function.html'>geom_function</a></span><span class='op'>(</span>fun<span class='op'>=</span><span class='va'>tau_n</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"v [mV]"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='fu'><a href='https://www.stefanom.io/latex2exp/reference/TeX.html'>TeX</a></span><span class='op'>(</span><span class='st'>r'($\tau_{n}$ (ms))'</span><span class='op'>)</span><span class='op'>)</span>

<span class='op'>(</span><span class='va'>p_m_inf</span> <span class='op'>+</span> <span class='va'>p_m_tau</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>p_h_inf</span> <span class='op'>+</span> <span class='va'>p_h_tau</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>p_n_inf</span> <span class='op'>+</span> <span class='va'>p_n_tau</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="notes019_files/figure-html5/unnamed-chunk-2-1.png" width="624" /></p>
</div>
<p>A few points to take away include</p>
<ol type="1">
<li><p>The time scale corresponding to the <span
class="math inline">\(m\)</span> gating variable is an order of
magnitude smaller than for <span class="math inline">\(h\)</span> and
<span class="math inline">\(m\)</span>. The consequence of this is that
the Hodgkin-Huxley model exhibits <em>slow-fast</em> dynamics. We will
discuss what this means in a future section of notes.</p></li>
<li><p>The functions <span class="math inline">\(m_{\infty}\)</span> and
<span class="math inline">\(n_{\infty}\)</span> are increasing functions
of membrane potential while <span
class="math inline">\(h_{\infty}\)</span> is a decreasign function of
membrane potential. Due to this, <span class="math inline">\(m\)</span>
and <span class="math inline">\(n\)</span> are considered activation
variables while <span class="math inline">\(h\)</span> is considered to
be an inactivation variable.</p></li>
</ol>
<h1 id="dynamics-of-hodgkin-huxley">Dynamics of Hodgkin-Huxley</h1>
<p>The Hodgkin-Huxley ODEs are complicated and difficult to work with
analytically. Here we present some numerical solutions, discuss key
features of the dynamics, and indicate some avenues of further
study.</p>
<p>We begin by implementing the Hodgkin-Huxley equations in R code.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>HH</span> <span class='op'>&lt;-</span> <span class='kw'>function</span> <span class='op'>(</span><span class='va'>t</span>, <span class='va'>y</span>, <span class='va'>parameters</span><span class='op'>)</span> <span class='op'>{</span>
   <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>as.list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>y</span>,<span class='va'>parameters</span><span class='op'>)</span><span class='op'>)</span>,<span class='op'>{</span>
    <span class='co'># variables</span>
    <span class='va'>v</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
    <span class='va'>h</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
    <span class='va'>m</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span>
    <span class='va'>n</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span>
  
    <span class='va'>dv</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>gna</span><span class='op'>*</span><span class='va'>m</span><span class='op'>^</span><span class='fl'>3</span><span class='op'>*</span><span class='va'>h</span><span class='op'>*</span><span class='op'>(</span><span class='va'>vna</span> <span class='op'>-</span> <span class='va'>v</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>gk</span><span class='op'>*</span><span class='va'>n</span><span class='op'>^</span><span class='fl'>4</span><span class='op'>*</span><span class='op'>(</span><span class='va'>vk</span> <span class='op'>-</span> <span class='va'>v</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>gl</span><span class='op'>*</span><span class='op'>(</span><span class='va'>vl</span> <span class='op'>-</span> <span class='va'>v</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>iext</span><span class='op'>)</span><span class='op'>/</span><span class='va'>C</span>
    <span class='va'>dh</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fu'>h_inf</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>h</span><span class='op'>)</span><span class='op'>/</span><span class='fu'>tau_h</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span>
    <span class='va'>dm</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fu'>m_inf</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>m</span><span class='op'>)</span><span class='op'>/</span><span class='fu'>tau_m</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span>
    <span class='va'>dn</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fu'>n_inf</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>n</span><span class='op'>)</span><span class='op'>/</span><span class='fu'>tau_n</span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span>
    
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>dv</span>, <span class='va'>dh</span>, <span class='va'>dm</span>, <span class='va'>dn</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<p>In order to solve the equations numerically, it is necessary to list
parameter values and initial conditions. This is done in the following
code.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># parameters</span>
<span class='va'>parameters</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>C<span class='op'>=</span><span class='fl'>1</span>,gk<span class='op'>=</span><span class='fl'>36</span>,gna<span class='op'>=</span><span class='fl'>120</span>,gl<span class='op'>=</span><span class='fl'>0.3</span>,vk<span class='op'>=</span><span class='op'>-</span><span class='fl'>82</span>,vna<span class='op'>=</span><span class='fl'>45</span>,vl<span class='op'>=</span><span class='op'>-</span><span class='fl'>59</span>,iext<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>

<span class='co'># initial conditions</span>
<span class='va'>v0</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>50</span>
<span class='va'>m0</span> <span class='op'>&lt;-</span> <span class='fu'>alpha_m</span><span class='op'>(</span><span class='va'>v0</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fu'>alpha_m</span><span class='op'>(</span><span class='va'>v0</span><span class='op'>)</span><span class='op'>+</span><span class='fu'>beta_m</span><span class='op'>(</span><span class='va'>v0</span><span class='op'>)</span><span class='op'>)</span>;

<span class='va'>yini</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='va'>v0</span>, h<span class='op'>=</span><span class='fl'>1</span>, m<span class='op'>=</span><span class='va'>m0</span>, n<span class='op'>=</span><span class='fl'>0.4</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>The next step is to set time points at which a numerical solution is
desired and then to call the numerical solver. This is done in the
following code.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>t_initial</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
<span class='va'>t_final</span> <span class='op'>&lt;-</span> <span class='fl'>75</span>
<span class='va'>times</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='va'>t_initial</span>, to <span class='op'>=</span> <span class='va'>t_final</span>, by <span class='op'>=</span> <span class='fl'>0.08</span><span class='op'>)</span>

<span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/deSolve/man/ode.html'>ode</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>yini</span>, times <span class='op'>=</span> <span class='va'>times</span>, func <span class='op'>=</span> <span class='va'>HH</span>,
           parms <span class='op'>=</span> <span class='va'>parameters</span>,method <span class='op'>=</span> <span class='st'>"ode45"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Finally, we plot out numerical solutions.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>HHsol</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>t<span class='op'>=</span><span class='va'>out</span><span class='op'>[</span>,<span class='st'>"time"</span><span class='op'>]</span>,v<span class='op'>=</span><span class='va'>out</span><span class='op'>[</span>,<span class='st'>"v"</span><span class='op'>]</span>,h<span class='op'>=</span><span class='va'>out</span><span class='op'>[</span>,<span class='st'>"h"</span><span class='op'>]</span>,m<span class='op'>=</span><span class='va'>out</span><span class='op'>[</span>,<span class='st'>"m"</span><span class='op'>]</span>,n<span class='op'>=</span><span class='va'>out</span><span class='op'>[</span>,<span class='st'>"n"</span><span class='op'>]</span><span class='op'>)</span>


<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='va'>HHsol</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>t</span>, y <span class='op'>=</span> <span class='va'>v</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>t</span>, y <span class='op'>=</span> <span class='va'>v</span><span class='op'>)</span>,lwd<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='st'>"time [ms]"</span>,y <span class='op'>=</span> <span class='st'>"v [mV]"</span><span class='op'>)</span>

<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='va'>HHsol</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/gather.html'>gather</a></span><span class='op'>(</span><span class='va'>Column</span>, <span class='va'>Value</span>, <span class='op'>-</span><span class='va'>t</span>,<span class='op'>-</span><span class='va'>v</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>t</span>, y <span class='op'>=</span> <span class='va'>Value</span>, color <span class='op'>=</span> <span class='va'>Column</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>t</span>, y <span class='op'>=</span> <span class='va'>Value</span><span class='op'>)</span>,lwd<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='st'>"time [ms]"</span>,y <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Gating variable"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>p1</span> <span class='op'>/</span> <span class='va'>p2</span>
</code></pre>
</div>
</details>
<p><img src="notes019_files/figure-html5/unnamed-chunk-6-1.png" width="624" /></p>
</div>
<p>The previous plot of solutions of the Hodgkin-Huxley equations
exhibit the features of the action potential that have been observed in
physical measurements as described earlier. Notice how the membrane
potential slowly increases to a threshold level and then quickly
spikes.</p>
<p>While the Hodgkin-Huxley equations form a four-dimensional system, we
can project components into the plane two at a time. It is illuminating
to project the <span class="math inline">\(v\)</span> and <span
class="math inline">\(n\)</span> components into the plane. When this is
done, we recognize the presence of a stable limit cycle.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>HHsol</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_path</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>v</span>, y <span class='op'>=</span> <span class='va'>n</span>, color <span class='op'>=</span> <span class='va'>t</span><span class='op'>)</span>,lwd<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>xlim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>100</span>,<span class='fl'>70</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"v [mV]"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"n"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="notes019_files/figure-html5/unnamed-chunk-7-1.png" width="624" /></p>
</div>
<p>This feature of the Hodgkin-Huxley model is the inspiration for
certain reduced models for neural dynamics. Our goal moving forward will
be to develop mathematical tools that can be used to study the dynamics
of these reduced models.</p>
<h1 id="further-reading">Further Reading</h1>
<p>The Hodgkin-Huxley model originally appears in <span class="citation"
data-cites="hodgkinQuantitativeDescriptionMembrane1952">(<a
href="#ref-hodgkinQuantitativeDescriptionMembrane1952"
role="doc-biblioref">Hodgkin and Huxley 1952</a>)</span>. Our discussion
largely follows Chapters 1, 3, and 4 from <span class="citation"
data-cites="borgersIntroductionModelingNeuronal2017">(<a
href="#ref-borgersIntroductionModelingNeuronal2017"
role="doc-biblioref">BÃ¶rgers 2017</a>)</span>. The text <span
class="citation"
data-cites="ermentroutMathematicalFoundationsNeuroscience2010">(<a
href="#ref-ermentroutMathematicalFoundationsNeuroscience2010"
role="doc-biblioref">Ermentrout and Terman 2010</a>)</span> provides
similar coverage but goes further into some of the mathematics
associated with mathematical neuroscience. We also reccommend the
recorded conference talks <a
href="https://www.pathlms.com/siam/courses/1288/sections/1411/video_presentations/11633">Fields
of Dreams: Modeling and Analysis of Large Scale Activity in the
Brain</a> by <a href="https://sites.pitt.edu/~phase/">Bard
Ermentrout</a> and <a
href="https://www.pathlms.com/siam/courses/1288/sections/1425/video_presentations/11676">Brain
Control - Itâs Not Just for Mad Scientists</a> by <a
href="http://sites.me.ucsb.edu/~moehlis/">Jeff Moehlis</a>.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent"
role="doc-bibliography">
<div id="ref-borgersIntroductionModelingNeuronal2017" class="csl-entry"
role="doc-biblioentry">
BÃ¶rgers, Christoph. 2017. <em>An Introduction to Modeling Neuronal
Dynamics</em>. Vol. 66. Texts in <span>Applied Mathematics</span>.
<span>Springer, Cham</span>. <a
href="https://doi.org/10.1007/978-3-319-51171-9">https://doi.org/10.1007/978-3-319-51171-9</a>.
</div>
<div id="ref-ermentroutMathematicalFoundationsNeuroscience2010"
class="csl-entry" role="doc-biblioentry">
Ermentrout, G. Bard, and David H. Terman. 2010. <em>Mathematical
Foundations of Neuroscience</em>. Vol. 35. Interdisciplinary
<span>Applied Mathematics</span>. <span>Springer, New York</span>. <a
href="https://doi.org/10.1007/978-0-387-87708-2">https://doi.org/10.1007/978-0-387-87708-2</a>.
</div>
<div id="ref-hodgkinQuantitativeDescriptionMembrane1952"
class="csl-entry" role="doc-biblioentry">
Hodgkin, A. L., and A. F. Huxley. 1952. <span>âA Quantitative
Description of Membrane Current and Its Application to Conduction and
Excitation in Nerve.â</span> <em>The Journal of Physiology</em> 117 (4):
500â544. <a
href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1392413/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1392413/</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
