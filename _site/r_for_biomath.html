<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Topics in Biomathematics: R for Biomathematics</title>

  <meta property="description" itemprop="description" content="An Introduction to R for Biomathematics"/>

  <link rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-03-24"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-03-24"/>
  <meta name="article:author" content="Jason M. Graham"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Topics in Biomathematics: R for Biomathematics"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="An Introduction to R for Biomathematics"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Topics in Biomathematics"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Topics in Biomathematics: R for Biomathematics"/>
  <meta property="twitter:description" content="An Introduction to R for Biomathematics"/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Solving differential equations in R;citation_publication_date=2012;citation_publisher=Springer, New York;citation_doi=10.1007/978-3-642-28070-2;citation_author=Karline Soetaert;citation_author=Jeff Cash;citation_author=Francesca Mazzia"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","creative_commons","bibliography"]}},"value":[{"type":"character","attributes":{},"value":["R for Biomathematics"]},{"type":"character","attributes":{},"value":["An Introduction to R for Biomathematics\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Jason M. Graham"]},{"type":"character","attributes":{},"value":["https://topicsinbiomath.netlify.app/"]},{"type":"character","attributes":{},"value":["University of Scranton"]},{"type":"character","attributes":{},"value":["https://sites.google.com/site/jasonmgrahamus/"]}]}]},{"type":"character","attributes":{},"value":["2022-03-24"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[2]}]}]},{"type":"character","attributes":{},"value":["CC BY-NC"]},{"type":"character","attributes":{},"value":["topics_in_biomath.bib"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
  <link href="site_libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"R for Biomathematics","description":"An Introduction to R for Biomathematics","authors":[{"author":"Jason M. Graham","authorURL":"https://topicsinbiomath.netlify.app/","affiliation":"University of Scranton","affiliationURL":"https://sites.google.com/site/jasonmgrahamus/","orcidID":""}],"publishedDate":"2022-03-24T00:00:00.000-04:00","citationText":"Graham, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">Topics in Biomathematics</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<a href="about.html">Syllabus</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Notes
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="notes001.html">Notes 1</a>
<a href="notes002.html">Notes 2</a>
<a href="notes003.html">Notes 3</a>
<a href="notes004.html">Notes 4</a>
<a href="notes005.html">Notes 5</a>
<a href="notes006.html">Notes 6</a>
<a href="notes007.html">Notes 7</a>
<a href="notes008.html">Notes 8</a>
<a href="notes009.html">Notes 9</a>
<a href="notes010.html">Notes 10</a>
<a href="notes011.html">Notes 11</a>
<a href="notes012.html">Notes 12</a>
<a href="notes013.html">Notes 13</a>
<a href="notes014.html">Notes 14</a>
<a href="notes015.html">Notes 15</a>
<a href="notes016.html">Notes 16</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Case Studies
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="case_study_01.html">Case Study 1</a>
</div>
</div>
<a href="r_for_biomath.html">R for Biomath</a>
<a href="course_blog.html">Course Blog</a>
<a href="https://github.com/jmgraham30">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>R for Biomathematics</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>An Introduction to R for Biomathematics</p></p>
</div>

<div class="d-byline">
  Jason M. Graham <a href="https://topicsinbiomath.netlify.app/"
class="uri">https://topicsinbiomath.netlify.app/</a> (University of
Scranton)<a href="https://sites.google.com/site/jasonmgrahamus/"
class="uri">https://sites.google.com/site/jasonmgrahamus/</a>
  
<br/>2022-03-24
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#computation-in-biomathematics">Computation in
Biomathematics</a></li>
<li><a href="#what-is-r">What is R?</a></li>
<li><a href="#why-r">Why R?</a></li>
<li><a href="#an-introduction-to-r">An Introduction to R</a>
<ul>
<li><a href="#installing-r-and-rstudio">Installing R and
RStudio</a></li>
<li><a href="#r-as-a-calculator">R as a Calculator</a></li>
<li><a href="#data-in-r">Data in R</a></li>
<li><a href="#linear-algebra-in-r">Linear Algebra in R</a></li>
<li><a href="#functions-in-r">Functions in R</a></li>
<li><a href="#r-packages">R Packages</a></li>
<li><a href="#visualization-in-r">Visualization in R</a></li>
<li><a
href="#numerical-solution-of-differential-equations-in-r">Numerical
Solution of Differential Equations in R</a></li>
<li><a href="#phase-plane-methods-in-r">Phase-Plane Methods in
R</a></li>
</ul></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</nav>
</div>
<h1 id="computation-in-biomathematics">Computation in
Biomathematics</h1>
<p>As in other scientific disciplines, numerical and scientific
computing play a central role in biomathematics. For the purposes of
<em>Topics in Biomathematics</em>, we are mainly interested in the
numerical solution of mathematical problems, <em>e.g.,</em> ordinary
differential equations, and scientific visualization, <em>e.g.,</em>
plotting functions. Numerous computing platforms or environments are
used in biomathematics. Some notable options include</p>
<ul>
<li><p><a
href="https://www.mathworks.com/products/matlab.html">MATLAB</a> or <a
href="https://www.gnu.org/software/octave/index">Octave</a>,</p></li>
<li><p><a href="https://www.maplesoft.com/">Maple</a>,</p></li>
<li><p><a href="https://www.python.org/">Python</a>,</p></li>
<li><p><a
href="http://www.math.pitt.edu/~bard/xpp/xpp.html">XPPAUT</a>,</p></li>
<li><p><a href="https://www.r-project.org/">R</a>, and</p></li>
<li><p><a href="https://julialang.org/">Julia</a>.</p></li>
</ul>
<p>The purpose of this document is to provide an introduction to parts
of the R computing ecosystem that are particularly useful for
biomathematics.</p>
<h1 id="what-is-r">What is R?</h1>
<p><a
href="https://en.wikipedia.org/wiki/R_(programming_language)">R</a> is
an open-source statistical computing platform that was developed as an
alternative to proprietary statistical software. In the years since it’s
initial release, R has become immensely popular and a vast ecosystem of
open-source software has developed around R that greatly enhances it’s
utility in science.</p>
<h1 id="why-r">Why R?</h1>
<p>Given many other options, why do we focus on R as the computing tool
of choice in <em>Topics in Biomathematics</em>? The principal reasons
are:</p>
<ol type="1">
<li><p>R is free but also well-developed and widely-supported.</p></li>
<li><p>Even though it was developed for statistical applications, R
works well for numerical computing of the sort that is useful in
biomathematics.</p></li>
<li><p>The <a href="https://www.rstudio.com/">RStudio</a> integrated
development environment (IDE) facilitates not only coding in R but also
presenting and sharing results so as to align nicely with the course
objective “Communicate effectively in writing their work in applying the
techniques of applied mathematics to problems arising in the life
sciences.”.</p></li>
<li><p>Many biologists “speak” R and it is very helpful to have a common
language when collaborating on interdisciplinary problems.</p></li>
</ol>
<h1 id="an-introduction-to-r">An Introduction to R</h1>
<p>In what follows, we illustrate some R commands that will be used
commonly throughout the <em>Topics in Biomathematics</em> course. This
document is by no means comprehensive. The best ways to learn more about
R are</p>
<ol type="1">
<li><p>by using the <a
href="https://swirlstats.com/"><code>swirl</code></a> package,
and</p></li>
<li><p>searching the web for specific topics.</p></li>
</ol>
<p>Here is a short video about <code>swirl</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/olOJfAjzdO8" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<h2 id="installing-r-and-rstudio">Installing R and RStudio</h2>
<p>R and RStudio are both free and easy to install. The videos below can
serve as a helpful guide if you want to use them. Alternatively, you can
access R and RStudio through a web browser without direct installation
via <a href="https://rstudio.cloud/">RStudio Cloud</a>. This does
require an account but is free to set up.</p>
<h3 id="installation-on-mac">Installation on Mac</h3>
<p>Read <a
href="https://macpaw.com/how-to/download-r-on-mac?campaign=cmmx_search_dsa_us_en&amp;ci=10147083349&amp;adgroupid=123618298718&amp;adpos=&amp;ck=&amp;targetid=dsa-1280095891351&amp;match=&amp;gnetwork=s&amp;creative=523598858635&amp;placement=&amp;placecat=&amp;accname=cmm&amp;gclid=CjwKCAiA55mPBhBOEiwANmzoQjy_N3sWjtX395AVPNBDvJVDsd2mKXLboj3XikILm3OcCx7edQqcVhoC5d8QAvD_BwE">this
article</a> or watch this video:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/AEebOXiMyyI" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<h3 id="installation-on-pc">Installation on PC</h3>
<p>Read <a
href="https://medium.com/@GalarnykMichael/install-r-and-rstudio-on-windows-5f503f708027">this
article</a> or watch this video:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/GAGUDL-4aVw" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<h3 id="rstudio-cloud">RStudio Cloud</h3>
<p>Here is an intro to RStudio Cloud:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/uK1Va_UWQFc" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<h2 id="r-as-a-calculator">R as a Calculator</h2>
<p>R can be used for basic arithmetic calculations:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span> <span class='co'># addition</span>
</code></pre>
</div>
<pre><code>[1] 3</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fl'>6</span> <span class='op'>-</span> <span class='fl'>4</span><span class='op'>)</span> <span class='co'># subtraction </span>
</code></pre>
</div>
<pre><code>[1] 2</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fl'>3</span><span class='op'>*</span><span class='fl'>5</span><span class='op'>)</span> <span class='co'># multiplication </span>
</code></pre>
</div>
<pre><code>[1] 15</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fl'>8</span><span class='op'>/</span><span class='fl'>3</span><span class='op'>)</span> <span class='co'># division</span>
</code></pre>
</div>
<pre><code>[1] 2.666667</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fl'>2</span><span class='op'>^</span><span class='fl'>3</span><span class='op'>)</span> <span class='co'># exponentiation</span>
</code></pre>
</div>
<pre><code>[1] 8</code></pre>
</div>
<p>There are also a number of mathematical functions:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 2.718282</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 2</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='va'>pi</span><span class='op'>/</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.7071068</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span><span class='op'>(</span><span class='va'>pi</span><span class='op'>/</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.5</code></pre>
</div>
<p>Sometimes it is convenient to store a value as a variable. The follow
code stores the value of 3 as a variable <code>x</code> and then
multiplies it by 1.5:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>3</span>
<span class='fl'>1.5</span><span class='op'>*</span><span class='va'>x</span>
</code></pre>
</div>
<pre><code>[1] 4.5</code></pre>
</div>
<p>In R, the notation <code>&lt;-</code> is the assignment operator.</p>
<p>You can do arithmetic with variables just like you can with numbers.
For example,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>3</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
<span class='op'>(</span><span class='va'>x</span> <span class='op'>+</span> <span class='va'>y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 13</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>x</span><span class='op'>*</span><span class='va'>y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 30</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>y</span><span class='op'>^</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 1000</code></pre>
</div>
<p>You should always pay close attention to the order of operations when
doing arithmetic in R. Use parentheses to make sure you compute what you
mean to compute. For example,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='op'>(</span><span class='fl'>3</span> <span class='op'>-</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>6</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 6</code></pre>
</div>
<p>versus</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fl'>3</span> <span class='op'>-</span> <span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='fl'>6</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -9</code></pre>
</div>
<h2 id="data-in-r">Data in R</h2>
<p>There are several common ways to represent different types of data in
R. In this section we cover those that are most relevant to
biomathematics.</p>
<h3 id="numeric-vectors">Numeric Vectors</h3>
<p>In R, we create a vector or array of values using concatenation with
the operator <code>c</code>. For example,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>5</span>,<span class='op'>-</span><span class='fl'>7</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  1  5 -7</code></pre>
</div>
<p>creates a numeric vector with entries 1, 5, and -7, then we store the
result as a variable called <code>a</code>.</p>
<p>We can perform arithmetic operations on vectors. For example,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>b</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>6</span><span class='op'>)</span>
<span class='op'>(</span><span class='va'>a</span> <span class='op'>+</span> <span class='va'>b</span><span class='op'>)</span> <span class='co'># vector addition</span>
</code></pre>
</div>
<pre><code>[1]  3  4 -1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>a</span><span class='op'>-</span><span class='va'>b</span><span class='op'>)</span> <span class='co'># vector subtraction</span>
</code></pre>
</div>
<pre><code>[1]  -1   6 -13</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>a</span><span class='op'>*</span><span class='va'>b</span><span class='op'>)</span> <span class='co'># elementwise vector multiplication </span>
</code></pre>
</div>
<pre><code>[1]   2  -5 -42</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>a</span><span class='op'>^</span><span class='va'>b</span><span class='op'>)</span> <span class='co'># elementwise vector exponentiation </span>
</code></pre>
</div>
<pre><code>[1]      1.0      0.2 117649.0</code></pre>
</div>
<p><strong>Question:</strong> In the last code block, what is happening
to produce the result corresponding to <code>a^b</code>?</p>
<p>We can also call math functions on vectors. For example,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>)</span>
<span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  2.718282  7.389056 20.085537</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span><span class='op'>(</span><span class='va'>pi</span><span class='op'>*</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -1  1 -1</code></pre>
</div>
<p>Note that these math functions are “vectorized” in that the operate
elementwise on a vector.</p>
<h3 id="character-vectors">Character Vectors</h3>
<p>We can also create so-called character vectors in R. For example,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>A</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"calculus"</span>,<span class='st'>"linear algebra"</span>, <span class='st'>"differential equations"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;calculus&quot;               &quot;linear algebra&quot;        
[3] &quot;differential equations&quot;</code></pre>
</div>
<p>We won’t make extensive use of character vectors in <em>Topics in
Biomathematics</em> but it is useful to know that they exist.</p>
<h3 id="matrices-in-r">Matrices in R</h3>
<p>The <code>matrix</code> functions allows us to create a matrix in R.
For example,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>M</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span><span class='op'>)</span>,<span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>     [,1] [,2]
[1,]    1    3
[2,]    2    4</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>6</span><span class='op'>)</span>,<span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>     [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>P</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>6</span><span class='op'>)</span>,<span class='fl'>3</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>     [,1] [,2]
[1,]    1    4
[2,]    2    5
[3,]    3    6</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>Q</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>6</span><span class='op'>)</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    4    5    6</code></pre>
</div>
<h3 id="lists-in-r">Lists in R</h3>
<p>All of the entries in a vector or a matrix must by of the same type.
For example, all numeric values or all characters. In R, lists are a
data structure that allow us to store data of mixed types. For
example,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>l1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"jason"</span>,<span class='st'>"graham"</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span><span class='op'>)</span>,<span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[[1]]
[1] 1 2 3

[[2]]
[1] &quot;jason&quot;  &quot;graham&quot;

[[3]]
     [,1] [,2]
[1,]    1    3
[2,]    2    4</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>l2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>initial<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>12</span><span class='op'>)</span>,times<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>10</span>,by<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>,values<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>22</span>,<span class='fl'>11</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># list with names</span>
</code></pre>
</div>
<pre><code>$initial
[1]  1 12

$times
 [1]  0  1  2  3  4  5  6  7  8  9 10

$values
      [,1] [,2]
 [1,]    1   12
 [2,]    2   13
 [3,]    3   14
 [4,]    4   15
 [5,]    5   16
 [6,]    6   17
 [7,]    7   18
 [8,]    8   19
 [9,]    9   20
[10,]   10   21
[11,]   11   22</code></pre>
</div>
<p>Note that the entries of a list can be accessed using either indexing
or names (provided that the list entries are named). For example,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>l1</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;jason&quot;  &quot;graham&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>l2</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  1 12</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>l2</span><span class='op'>$</span><span class='va'>initial</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  1 12</code></pre>
</div>
<p>If a list has named elements, we can access the names using the
<code>names</code> function. For example,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>l2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;initial&quot; &quot;times&quot;   &quot;values&quot; </code></pre>
</div>
<p>Here is a helpful video on R lists:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/Px9VNWHja4M" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<h3 id="data-frames-in-r">Data Frames in R</h3>
<p>A data frame in R is a data structure that corresponds to something
like a spreadsheet. A data frame is a special type of list object. You
can think of a data frame as a cross between a list and a matrix. Here
is how you ceate a data frame:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>my_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>course<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"MATH 114"</span>,<span class='st'>"MATH 221"</span>,<span class='st'>"MATH 222"</span>,<span class='st'>"MATH 351"</span>, <span class='st'>"MATH 341"</span><span class='op'>)</span>,
                       num_students<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>12</span>,<span class='fl'>8</span>,<span class='fl'>5</span>,<span class='fl'>7</span><span class='op'>)</span>,
                       level<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"F"</span>,<span class='st'>"F"</span>,<span class='st'>"S"</span>,<span class='st'>"S"</span>,<span class='st'>"T"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    course num_students level
1 MATH 114           10     F
2 MATH 221           12     F
3 MATH 222            8     S
4 MATH 351            5     S
5 MATH 341            7     T</code></pre>
</div>
<p>Note that a data frame contains rows and columns, every column is a
vector (either numeric or character), and every column has the same
number of entries. The columns of a data frame all have names. We can
also use the <code>names</code> function to determine the column names
of a data frame. For example,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>my_data</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;course&quot;       &quot;num_students&quot; &quot;level&quot;       </code></pre>
</div>
<p>Typically we do not create a data frame by hand, but data is often
read in as a data frame. The principal use of data frames in R is that
they are the best way to provide data to plotting functions.</p>
<p>Here is a helpful video on R data frames:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/9f2g7RN5N0I" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<h2 id="linear-algebra-in-r">Linear Algebra in R</h2>
<p>Linear algebra plays a central role in solving problem in
biomathematics. This section demonstrates some linear algebra
computations that will be used frequently in <em>Topics in
Biomathematics</em> performed in R.</p>
<h3 id="matrix-arithmetic">Matrix Arithmetic</h3>
<p>If <span class="math inline">\(A\)</span> and <span
class="math inline">\(B\)</span> are matrices of the same size then we
can add them. Matrix addition is computed elementwise. We demonstrate
this in R.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>A</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>2</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span>,<span class='fl'>3</span>,<span class='fl'>3</span>,byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>     [,1] [,2] [,3]
[1,]    1    2   -1
[2,]    3    1    0
[3,]    2   -1    2</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>B</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>2</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='op'>-</span><span class='fl'>3</span>,<span class='fl'>1</span><span class='op'>)</span>,<span class='fl'>3</span>,<span class='fl'>3</span>,byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>     [,1] [,2] [,3]
[1,]    3    2   -1
[2,]    2    1   -1
[3,]    2   -3    1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>A</span> <span class='op'>+</span> <span class='va'>B</span> <span class='co'># matrix addition</span>
</code></pre>
</div>
<pre><code>     [,1] [,2] [,3]
[1,]    4    4   -2
[2,]    5    2   -1
[3,]    4   -4    3</code></pre>
</div>
<p>We can also multiply a matrix by a number (scalar multiplication). In
R</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fl'>3</span> <span class='op'>*</span> <span class='va'>A</span>
</code></pre>
</div>
<pre><code>     [,1] [,2] [,3]
[1,]    3    6   -3
[2,]    9    3    0
[3,]    6   -3    6</code></pre>
</div>
<p>Recall that if <span class="math inline">\(A\)</span> is an <span
class="math inline">\(m\times n\)</span> matrix and <span
class="math inline">\(B\)</span> is an <span class="math inline">\(n
\times p\)</span> matrix, then we can form the <a
href="https://en.wikipedia.org/wiki/Matrix_multiplication">matrix
product</a> <span class="math inline">\(AB\)</span> which will be a
matrix of size <span class="math inline">\(m\times p\)</span>. We
demonstrate this in R.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>A</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>2</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span>,<span class='fl'>3</span>,<span class='fl'>3</span>,byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>     [,1] [,2] [,3]
[1,]    1    2   -1
[2,]    3    1    0
[3,]    2   -1    2</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>B</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>2</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>,<span class='fl'>3</span>,<span class='fl'>2</span>,byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>     [,1] [,2]
[1,]    3    2
[2,]   -1    2
[3,]    1   -1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>A</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>B</span> <span class='co'># matrix multiplication</span>
</code></pre>
</div>
<pre><code>     [,1] [,2]
[1,]    0    7
[2,]    8    8
[3,]    9    0</code></pre>
</div>
<p>A special case of matrix multiplication is matrix-vector
multiplication. For example,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>v</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  1 -1  1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>A</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>v</span> <span class='co'># matrix-vector multiplication </span>
</code></pre>
</div>
<pre><code>     [,1]
[1,]   -2
[2,]    2
[3,]    5</code></pre>
</div>
<h3 id="matrix-transpose-and-determinant">Matrix Transpose and
Determinant</h3>
<p>In R, the transpose of a matrix is obtained as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>B</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>     [,1] [,2] [,3]
[1,]    3   -1    1
[2,]    2    2   -1</code></pre>
</div>
<p>and the determinant of a square matrix is computed as</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/det.html'>det</a></span><span class='op'>(</span><span class='va'>A</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -5</code></pre>
</div>
<h3 id="eigenvalues-and-eigenvectors">Eigenvalues and Eigenvectors</h3>
<p>Recall that if <span class="math inline">\(A\)</span> is a square
matrix (<span class="math inline">\(n\times n\)</span>), then an
eigenvalue-eigenvector pair is a number <span
class="math inline">\(\lambda\)</span> and a non-zero vector <span
class="math inline">\(v\)</span> satisfying <span
class="math inline">\(Av=\lambda v\)</span>. In R, we can compute the
eigenvalues and eigenvectors for a square matrix as</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>evals_evects</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/eigen.html'>eigen</a></span><span class='op'>(</span><span class='va'>A</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>eigen() decomposition
$values
[1]  3.1986912  1.7135379 -0.9122292

$vectors
           [,1]      [,2]       [,3]
[1,] -0.5640780 0.1133046  0.4488745
[2,] -0.7696551 0.4763782 -0.7042167
[3,] -0.2990769 0.8719093 -0.5500823</code></pre>
</div>
<p>Note that the result is an R list that consists of</p>
<ol type="1">
<li><p>a vector that contains the eigenvalues, and</p></li>
<li><p>a matrix, the columns of which are the eigenvectors.</p></li>
</ol>
<p>It is a fact from linear algebra that the determinant of a square
matrix is the product of its eigenvalues. Let’s confirm this with our
example matrix:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/det.html'>det</a></span><span class='op'>(</span><span class='va'>A</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -5</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/prod.html'>prod</a></span><span class='op'>(</span><span class='va'>evals_evects</span><span class='op'>$</span><span class='va'>values</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -5</code></pre>
</div>
<p>Let’s also confirm that <span class="math inline">\(Av=\lambda
v\)</span> for the first eigenvalue-eigenvector pair we just
computed.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>A</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>evals_evects</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'>[</span> ,<span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           [,1]
[1,] -1.8043114
[2,] -2.4618891
[3,] -0.9566547</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>evals_evects</span><span class='op'>$</span><span class='va'>values</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>*</span> <span class='va'>evals_evects</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'>[</span> ,<span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -1.8043114 -2.4618891 -0.9566547</code></pre>
</div>
<h2 id="functions-in-r">Functions in R</h2>
<p>A function is a programming construct that takes some number of
inputs (possibly zero), performs some operations, and returns a value
(which may be null). Writing functions is useful in general because it
saves from having to rewrite the same code over and over again, makes
code easier to read, and facilitates reproducibility. Additionally, code
to compute numerical solutions to differential equations requires us to
write a function specifying the differential equation. Thus, we are
motivated to learn a little about writing functions in R. Suppose we
want to create a function that inputs a number, multiplies that number
by 2, and returns the result. Here is how you do this:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mult_by_two</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>x</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Let’s call our function:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>mult_by_two</span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 6</code></pre>
</div>
<p>We can also do the following:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>3</span>
<span class='fu'>mult_by_two</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 6</code></pre>
</div>
<p>What if we want to multiply by an arbitrary number? One way to do
this is as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mult_by_a</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>a</span><span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>a</span><span class='op'>*</span><span class='va'>x</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>In the function <code>mult_by_a</code> we have an optional argument
with a default value. If <code>a</code> is not specified, we multiply by
2, if a value for <code>a</code> is given then it is used. For
example:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'>mult_by_a</span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 6</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'>mult_by_a</span><span class='op'>(</span><span class='fl'>3</span>,a<span class='op'>=</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># a is given by name</span>
</code></pre>
</div>
<pre><code>[1] 12</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>4</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fl'>6</span>
<span class='op'>(</span><span class='fu'>mult_by_a</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 8</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'>mult_by_a</span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>a</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># a is given by position </span>
</code></pre>
</div>
<pre><code>[1] 24</code></pre>
</div>
<p>Let’s try something a little more interesting. Suppose we want to
compute the value of an arbitrary polynomial function. Since the
coefficients uniquely determine the polynomial and since R can perform
vectorized operations, we can do the following:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>poly_func</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>coeff_vect</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>degree</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>coeff_vect</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1</span> 
  <span class='va'>powers</span> <span class='op'>&lt;-</span> <span class='fl'>0</span><span class='op'>:</span><span class='va'>degree</span>
  <span class='va'>x_powers</span> <span class='op'>&lt;-</span> <span class='va'>x</span><span class='op'>^</span><span class='va'>powers</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>coeff_vect</span><span class='op'>*</span><span class='va'>x_powers</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Let’s test our function:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'>poly_func</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'>poly_func</span><span class='op'>(</span><span class='fl'>2</span>,coeff_vect<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 3</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'>poly_func</span><span class='op'>(</span><span class='fl'>2</span>,coeff_vect<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 2</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'>poly_func</span><span class='op'>(</span><span class='fl'>2</span>,coeff_vect<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 4</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='fu'>poly_func</span><span class='op'>(</span><span class='fl'>2</span>,coeff_vect<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 17</code></pre>
</div>
<p>Later we will see more examples of functions in R. In you want to
learn more before then, here is a helpful video on writing functions in
R:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/p8tAQx7ijXE" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<h2 id="r-packages">R Packages</h2>
<p>R packages extend the functionality of R by implementing functions
for various tasks. Packages must be installed before they can be used.
Installing packages is easy to do. Either use the
<code>install.packages</code> function or in RStudio use the Install
icon on the Packages tab.</p>
<p>Once you have installed the package or packages you want to use, you
can load them with the <code>library</code> function. For <em>Topics in
Biomathematics</em> we will make heavy use of the plotting packages <a
href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a> and <a
href="http://www.mosaic-web.org/ggformula/"><code>ggformula</code></a>,
and the packages <a
href="https://desolve.r-forge.r-project.org/"><code>deSolve</code></a>
and <a
href="https://www.rdocumentation.org/packages/phaseR/versions/2.1.3"><code>phaseR</code></a>
for working with differential equations. To install these packages one
can use</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ggplot2"</span>,<span class='st'>"ggformula"</span>,<span class='st'>"deSolve"</span>,<span class='st'>"phaseR"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>You only ever have to install a package once. To load these packages,
you run</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/ProjectMOSAIC/ggformula'>ggformula</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://desolve.r-forge.r-project.org/'>deSolve</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/mjg211/phaseR'>phaseR</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Packages must be loaded every time you begin a new R session.</p>
<h2 id="visualization-in-r">Visualization in R</h2>
<p>When you present your work you should use figures and plots to
clearly convey your results. As mentioned, the two packages <a
href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a> and <a
href="http://www.mosaic-web.org/ggformula/"><code>ggformula</code></a>
make it possible to create high-quality plots in R. These packages are
powerful and extensive so we will not be able to cover their full
functionality here. Hopefully what is included here is enough to get you
started, at least for the purposes of <em>Topics in Biomathematics</em>.
It should be noted that <code>ggformula</code> is built on top of
<code>ggplot2</code>.</p>
<h3 id="plotting-a-function">Plotting a Function</h3>
<p>Here are two ways to plot a simple mathematical function of the form
<span class="math inline">\(y=f(x)\)</span> in R:</p>
<p>Suppose we want to plot <span class="math inline">\(f(x) =
x\cos(x)\)</span> over <span class="math inline">\([0,4\pi]\)</span>.
Then we can do</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/ggformula/man/gf_function.html'>gf_function</a></span><span class='op'>(</span>fun <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span><span class='va'>x</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>}</span>,xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>4</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/function_plot_ggformula-1.png" width="624" /></p>
</div>
<p>or</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>4</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>)</span><span class='op'>)</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_function.html'>geom_function</a></span><span class='op'>(</span>fun <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span><span class='va'>x</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>}</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/function_plot_ggplot2-1.png" width="624" /></p>
</div>
<p>We can modify our plots in various ways. For example,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/ggformula/man/gf_function.html'>gf_function</a></span><span class='op'>(</span>fun <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span><span class='va'>x</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>}</span>,xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>4</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>)</span>,color<span class='op'>=</span><span class='st'>"blue"</span>,lwd<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/function_plot_ggformula_mod-1.png" width="624" /></p>
</div>
<p>or</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>4</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>)</span><span class='op'>)</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_function.html'>geom_function</a></span><span class='op'>(</span>fun <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span><span class='va'>x</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>}</span>,color<span class='op'>=</span><span class='st'>"blue"</span>,lwd<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/function_plot_ggplot2_mod-1.png" width="624" /></p>
</div>
<h3 id="more-on-plots">More on Plots</h3>
<p>It is possible to create a variety of different types of plots using
<a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a> and <a
href="http://www.mosaic-web.org/ggformula/"><code>ggformula</code></a>,
and plots creating using these packages can be highly customized. As we
go through the <em>Topics in Biomathematics</em> course we will learn a
little more about the utility of these packages. For now, we refer
anyone interested to learn more to this helpful video on
<code>ggplot2</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/iOosTTQwCW4" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<p><a
href="https://stat2labs.sites.grinnell.edu/Handouts/rtutorials/IntroToggformula.html">This
article</a> provides more information on <code>ggformula</code>.</p>
<h2 id="numerical-solution-of-differential-equations-in-r">Numerical
Solution of Differential Equations in R</h2>
<p>A problem that we will often encounter is to obtain a numerical
solution to an initial value problem (IVP) for an ordinary differential
equation (ODE) or a system of ordinary differential equations (ODEs). An
IVP for an ODE or ODEs typically takes the form</p>
<p><span class="math inline">\(\frac{d{\bf x}}{dt} = {\bf F}({\bf
x}(t),t)\)</span>,</p>
<p><span class="math inline">\({\bf x}(t_{0}) = {\bf
x}_{0}\)</span>.</p>
<p>Here <span class="math inline">\({\bf x}\)</span> is the unknown
function of time and <span class="math inline">\({\bf F}\)</span> is the
right hand side function. These may be scalars (in case of a single ODE)
or vectors (in case of a system of ODEs). First, we will focus on the
case of solving a single scalar ODE, then we will examine systems on
ODEs.</p>
<p>For example, we might want to obtain a numerical solution to</p>
<p><span class="math inline">\(\frac{dN}{dt} = r N\)</span>,</p>
<p><span class="math inline">\(N(0) = 10\)</span>,</p>
<p>with <span class="math inline">\(r=0.5\)</span> and over the time
interval <span class="math inline">\([0, 5]\)</span>.</p>
<p>In order to obtain a numerical solution to an IVP for ODEs we must
provide at minimum the following information to the computer:</p>
<ol type="1">
<li><p>A function that describes the right hand side <span
class="math inline">\({\bf F}({\bf x}(t),t)\)</span>. Note that <span
class="math inline">\({\bf F}\)</span> may involve parameters whose
values will also need to be specified.</p></li>
<li><p>A time interval, <span
class="math inline">\([t_{0},t_{f}]\)</span>, over which to obtain a
numerical solution.</p></li>
<li><p>Initial conditions <span class="math inline">\({\bf
x}_{0}\)</span>.</p></li>
</ol>
<p>Finally, once we have obtained numerical solutions to an IVP for ODEs
it is typically desirable to plot these solutions in one way or another.
We will also see examples of ways to plot our numerical solutions in
R.</p>
<h3 id="solving-a-single-ode">Solving a Single ODE</h3>
<p>To use the methods described in this section you must make sure that
the <code>deSolve</code> package is installed and loaded. The main
function for obtaining numerical solutions in the <code>deSolve</code>
package is the <code>ode</code> function. In order to use it, we must
write a function in R syntax that describes the right hand side of our
differential equation. Let’s do this for our example problem</p>
<p><span class="math inline">\(\frac{dN}{dt} = r N\)</span>,</p>
<p><span class="math inline">\(N(0) = 10\)</span>,</p>
<p>with <span class="math inline">\(r=0.5\)</span> and over the time
interval <span class="math inline">\([0, 5]\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>My_RHS</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>state</span>,<span class='va'>parameters</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>as.list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>state</span>,<span class='va'>parameters</span><span class='op'>)</span><span class='op'>)</span>,<span class='op'>{</span>
    <span class='va'>dN</span> <span class='op'>&lt;-</span> <span class='va'>r</span><span class='op'>*</span><span class='va'>N</span>
    
    <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>dN</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>In addition to describing the right hand side of the differential
equation, we must also specify the times at which to obtain the
numerical solution and the initial condition. This is done as
follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>state</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>N<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>
<span class='va'>times</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>5</span>,by<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Now we are ready to obtain the numerical solution:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>solN</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/deSolve/man/ode.html'>ode</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>state</span>,times<span class='op'>=</span><span class='va'>times</span>,func<span class='op'>=</span><span class='va'>My_RHS</span>,parms<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>r<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Let’s look at what has been returned by our call to the numerical
solver, the results of which are stored in the variable
<code>solN</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>solN</span>
</code></pre>
</div>
<pre><code>   time         N
1   0.0  10.00000
2   0.1  10.51272
3   0.2  11.05171
4   0.3  11.61834
5   0.4  12.21403
6   0.5  12.84026
7   0.6  13.49859
8   0.7  14.19068
9   0.8  14.91825
10  0.9  15.68313
11  1.0  16.48722
12  1.1  17.33254
13  1.2  18.22120
14  1.3  19.15542
15  1.4  20.13754
16  1.5  21.17001
17  1.6  22.25542
18  1.7  23.39648
19  1.8  24.59604
20  1.9  25.85711
21  2.0  27.18283
22  2.1  28.57652
23  2.2  30.04167
24  2.3  31.58194
25  2.4  33.20118
26  2.5  34.90344
27  2.6  36.69298
28  2.7  38.57427
29  2.8  40.55202
30  2.9  42.63116
31  3.0  44.81691
32  3.1  47.11472
33  3.2  49.53034
34  3.3  52.06982
35  3.4  54.73950
36  3.5  57.54605
37  3.6  60.49650
38  3.7  63.59822
39  3.8  66.85897
40  3.9  70.28690
41  4.0  73.89059
42  4.1  77.67904
43  4.2  81.66173
44  4.3  85.84862
45  4.4  90.25017
46  4.5  94.87740
47  4.6  99.74186
48  4.7 104.85574
49  4.8 110.23181
50  4.9 115.88351
51  5.0 121.82499</code></pre>
</div>
<p>The method from the <code>deSolve</code> package returns a
<strong>matrix</strong> where the first column contains the time values
at which we obtained numerical solution values and another column that
contains the solution values corresponding to each of the time points.
We can easily plot the solution values versus the time points as
follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>solN</span>,col<span class='op'>=</span><span class='st'>"blue"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/plot_example-1.png" width="624" /></p>
</div>
<p>A nicer plot can be obtained as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>solN</span><span class='op'>)</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>time</span>,y<span class='op'>=</span><span class='va'>N</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/plot_example_ggplot-1.png" width="624" /></p>
</div>
<p>If we want a curve instead:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>solN</span><span class='op'>)</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>time</span>,y<span class='op'>=</span><span class='va'>N</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>lwd<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/plot_example_ggplot_line-1.png" width="624" /></p>
</div>
<p>We can plot the numerical solution together with the analytical
solution <span class="math inline">\(N(t) = 10e^{0.5 t}\)</span> as
follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>solN</span><span class='op'>)</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>time</span>,y<span class='op'>=</span><span class='va'>N</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_function.html'>geom_function</a></span><span class='op'>(</span>fun<span class='op'>=</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>t</span><span class='op'>)</span> <span class='fl'>10</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fl'>0.5</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span>,color<span class='op'>=</span><span class='st'>"blue"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/example_analtiycal-1.png" width="624" /></p>
</div>
<p><strong>Exercise:</strong> Modify what we have done using the
<code>deSolve</code> package to obtain and plot a numerical solution to
the IVP</p>
<p><span class="math inline">\(\frac{dN}{dt} = r N\)</span>,</p>
<p><span class="math inline">\(N(0) = 5\)</span>,</p>
<p>with <span class="math inline">\(r=2.5\)</span> and over the time
interval <span class="math inline">\([0, 10]\)</span>.</p>
<h3 id="solving-a-system-of-odes">Solving a System of ODEs</h3>
<p>Consider the following problem:</p>
<p><span class="math inline">\(\frac{dx}{dt}=-R_{0}xy\)</span></p>
<p><span class="math inline">\(\frac{dy}{dt}=R_{0}xy - y\)</span></p>
<p>with <span class="math inline">\(R_{0} = 0.2\)</span> and <span
class="math inline">\(x_{0} = 0.95\)</span> and <span
class="math inline">\(y_{0} = 0.05\)</span>.</p>
<p>We can code this system of ODEs in R as:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>My_RHS</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>state</span>,<span class='va'>parameters</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>as.list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>state</span>,<span class='va'>parameters</span><span class='op'>)</span><span class='op'>)</span>,<span class='op'>{</span>
    <span class='va'>dx</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='va'>R0</span><span class='op'>*</span><span class='va'>x</span><span class='op'>*</span><span class='va'>y</span>
    <span class='va'>dy</span> <span class='op'>&lt;-</span> <span class='va'>R0</span><span class='op'>*</span><span class='va'>x</span><span class='op'>*</span><span class='va'>y</span> <span class='op'>-</span> <span class='va'>y</span>
    
    <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>dx</span>,<span class='va'>dy</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>We must specify our time interval and initial conditions:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>state</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fl'>0.95</span>,y<span class='op'>=</span><span class='fl'>0.05</span><span class='op'>)</span>
<span class='va'>times</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>20</span>,by<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Now, we are ready to obtain the numerical solution:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>SIR_sol</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/deSolve/man/ode.html'>ode</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>state</span>,times<span class='op'>=</span><span class='va'>times</span>,func<span class='op'>=</span><span class='va'>My_RHS</span>,parms<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>R0<span class='op'>=</span><span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Again, the method from the <code>deSolve</code> package returns a
matrix where the first column contains the time values at which we
obtained numerical solution values and another column that contains the
solution values corresponding to each of the time points. We can easily
plot the solution values versus the time points as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>SIR_sol</span>,col<span class='op'>=</span><span class='st'>"blue"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/plot_system-1.png" width="624" /></p>
</div>
<p><strong>Question:</strong> Again, what happens if we change the value
of <span class="math inline">\(R_{0}\)</span> to <span
class="math inline">\(R_{0}=1.5\)</span>?</p>
<p>Often we want to have greater control over our plots and to be able
to make high quality figures. The best way to do this in R is to use the
capabilities of the <code>ggplot2</code> package. In order to do this,
we will first convert the matrix of solutions returned by the
<code>ode</code> function from the <code>deSolve</code> package into a
data frame. This is basically like an spread sheet format for data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>SIR_sol_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>SIR_sol</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>We can get a sense of the structure of this data by viewing the first
few rows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>SIR_sol_df</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  time         x          y
1  0.0 0.9500000 0.05000000
2  0.1 0.9490877 0.04610860
3  0.2 0.9482474 0.04251971
4  0.3 0.9474732 0.03921021
5  0.4 0.9467598 0.03615738
6  0.5 0.9461024 0.03334179</code></pre>
</div>
<p>It is convenient to change the names of the columns to something more
meaningful as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>SIR_sol_df</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"time"</span>,<span class='st'>"susceptible"</span>,<span class='st'>"infected"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Let’s look at the first few rows again:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>SIR_sol_df</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  time susceptible   infected
1  0.0   0.9500000 0.05000000
2  0.1   0.9490877 0.04610860
3  0.2   0.9482474 0.04251971
4  0.3   0.9474732 0.03921021
5  0.4   0.9467598 0.03615738
6  0.5   0.9461024 0.03334179</code></pre>
</div>
<p>Now, we can obtain plots by doing commands like:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>SIR_sol_df</span>,mapping<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>time</span>,y<span class='op'>=</span><span class='va'>susceptible</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/system_plot_b-1.png" width="624" /></p>
</div>
<p>or</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>SIR_sol_df</span>,mapping<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>time</span>,y<span class='op'>=</span><span class='va'>infected</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/system_plot_c-1.png" width="624" /></p>
</div>
<p>Here are some other plotting alternatives:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"> <span class='va'>SIR_df_long</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span><span class='va'>SIR_sol_df</span>,<span class='op'>-</span><span class='va'>time</span>,names_to <span class='op'>=</span> <span class='st'>"compartment"</span>,values_to <span class='op'>=</span> <span class='st'>"population"</span><span class='op'>)</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>SIR_df_long</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>time</span>,y<span class='op'>=</span><span class='va'>population</span>,color<span class='op'>=</span><span class='va'>compartment</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>lwd<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/system_plot_d-1.png" width="624" /></p>
</div>
<p>or</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>SIR_df_long</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>time</span>,y<span class='op'>=</span><span class='va'>population</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>lwd<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>compartment</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/system_plot_e-1.png" width="624" /></p>
</div>
<p>We can also plot <span class="math inline">\(x(t)\)</span> and <span
class="math inline">\(y(t)\)</span> together as parametric curves:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>SIR_sol_df</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>susceptible</span>,y<span class='op'>=</span><span class='va'>infected</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_path</a></span><span class='op'>(</span>lwd<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/system_plot_f-1.png" width="624" /></p>
</div>
<p>Using color to indicate increasing values of time can be
interesting:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>SIR_sol_df</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>susceptible</span>,y<span class='op'>=</span><span class='va'>infected</span>,color<span class='op'>=</span><span class='va'>time</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_path</a></span><span class='op'>(</span>lwd<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/system_plot_g-1.png" width="624" /></p>
</div>
<p>This color scale may not be the best, let’s change it:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>SIR_sol_df</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>susceptible</span>,y<span class='op'>=</span><span class='va'>infected</span>,color<span class='op'>=</span><span class='va'>time</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_path</a></span><span class='op'>(</span>lwd<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_color_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/system_plot_h-1.png" width="624" /></p>
</div>
<p>The book <span class="citation"
data-cites="soetaertSolvingDEsR2012">(<a
href="#ref-soetaertSolvingDEsR2012" role="doc-biblioref">Soetaert, Cash,
and Mazzia 2012</a>)</span> covers much more on numerical computing with
differential equations in R.</p>
<h2 id="phase-plane-methods-in-r">Phase-Plane Methods in R</h2>
<p>The <code>phaseR</code> package facilitates the mix of qualitative
and quantitative methods for the analysis of 1- and 2-dimensional
autonomous systems of ODEs. We illustrate its usage.</p>
<h3 id="phaser-for-scalar-equations">PhaseR for Scalar Equations</h3>
<p>A first-order autonmous scalar ordinary differential equation is one
with the general form</p>
<p><span class="math inline">\(\frac{dx}{dt} = f(x)\)</span>,</p>
<p>where <span class="math inline">\(f(x)\)</span> is a continuous
(usually even differentiable) function that does not depend explicitly
on time <span class="math inline">\(t\)</span> (this is the reason for
the word autonomous). Most often, we are interested in the case when
<span class="math inline">\(f(x)\)</span> is a nonlinear function and we
sometimes refer to <span class="math inline">\(\frac{dx}{dt} =
f(x)\)</span> as a one-dimensional system.</p>
<p><strong>Example</strong></p>
<p>Consider as an example the equation</p>
<p><span class="math inline">\(\frac{dx}{dt} = x(1-x)\)</span>.</p>
<p>The left hand side is the derivative <span
class="math inline">\(\frac{dx}{dt}\)</span> and hence the (local) rate
of change of <span class="math inline">\(x\)</span> as a function of
time <span class="math inline">\(t\)</span>. Therefore, because of the
equal sign, <span class="math inline">\(f(x)\)</span> must also provide
information about the (local) rate of change of <span
class="math inline">\(x\)</span> but now for various “state” values,
that is, values of <span class="math inline">\(x\)</span>.</p>
<p>We can use <code>phaseR</code> to analyze this problem.</p>
<p>First we need to describe the differential equation:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>nondim_logistic</span> <span class='op'>&lt;-</span> <span class='kw'>function</span> <span class='op'>(</span><span class='va'>t</span>, <span class='va'>x</span>, <span class='va'>parameters</span><span class='op'>)</span> 
<span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Now we plot what is called the phase portrait:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>nondim_logistic_phasePortrait</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/phaseR/man/phasePortrait.html'>phasePortrait</a></span><span class='op'>(</span><span class='va'>nondim_logistic</span>,
                                        ylim   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.5</span>, <span class='fl'>1.5</span><span class='op'>)</span>,
                                        points <span class='op'>=</span> <span class='fl'>10</span>,
                                        frac   <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/phase_line-1.png" width="624" /></p>
</div>
<p>The arrows here tell us, starting from an initial state value <span
class="math inline">\(x\)</span>, whether the solution to the
differential equation will increase as a function of time or decrease as
a function of time.</p>
<p>Further, we can use <code>phaseR</code> to obtain some “trajectories”
to our ODE:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>nondim_logistic_flow</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/phaseR/man/flowField.html'>flowField</a></span><span class='op'>(</span><span class='va'>nondim_logistic</span>,
                                 xlim       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>10</span><span class='op'>)</span>,
                                 ylim       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.5</span>, <span class='fl'>1.5</span><span class='op'>)</span>,
                                 parameters <span class='op'>=</span> <span class='cn'>NULL</span>,
                                 points     <span class='op'>=</span> <span class='fl'>15</span>,
                                 system     <span class='op'>=</span> <span class='st'>"one.dim"</span>,add<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>nondim_logistic_solutions</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/phaseR/man/trajectory.html'>trajectory</a></span><span class='op'>(</span><span class='va'>nondim_logistic</span>,
                                        y0   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.5</span>,<span class='fl'>1</span>,<span class='fl'>1.5</span><span class='op'>)</span>,
                                        tlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>10</span><span class='op'>)</span>,
                                        system <span class='op'>=</span> <span class='st'>"one.dim"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/scalar_trajectories-1.png" width="624" /></p>
</div>
<p>There is an general function in <code>phaseR</code> that will carry
out a complete qualitative analysis for an autonomous system (either
one-dimensional or two-dimensional). For example, call the following
function in the R console:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/phaseR/man/phasePlaneAnalysis.html'>phasePlaneAnalysis</a></span><span class='op'>(</span><span class='va'>nondim_logistic</span>,xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>10</span><span class='op'>)</span>,ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.5</span>,<span class='fl'>1.5</span><span class='op'>)</span>,system <span class='op'>=</span> <span class='st'>"one.dim"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="phaser-for-two-dimensional-systems">PhaseR for Two-Dimensional
Systems</h3>
<p>Let’s use <code>phaseR</code> to explore the dynamics of
two-dimensional linear autonomous systems.</p>
<p>Consider for example:</p>
<p><span class="math inline">\(\frac{d{\bf x}}{dt} = A {\bf
x}\)</span>,</p>
<p>where <span class="math inline">\(A\)</span> is a <span
class="math inline">\(2\times 2\)</span> matrix of the form</p>
<p><span class="math inline">\(A = \left(\begin{array}{cc} a &amp; 0 \\
0 &amp; -1 \end{array}\right)\)</span>.</p>
<p>Let’s examine how various values of <span
class="math inline">\(a\)</span> change the dynamics (specifically the
phase portraits) of the systems. Observe that as long as <span
class="math inline">\(a\neq 0\)</span> there is a unique steady-state
<span class="math inline">\({\bf x}^{\ast}={\bf 0}\)</span>.</p>
<h4 id="phase-portraits-for-varying-a">Phase Portraits for Varying <span
class="math inline">\(a\)</span></h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>simple_linear</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>state</span>,<span class='va'>parameters</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>as.list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>state</span>,<span class='va'>parameters</span><span class='op'>)</span><span class='op'>)</span>,<span class='op'>{</span>
    <span class='va'>dx</span> <span class='op'>&lt;-</span> <span class='va'>a</span><span class='op'>*</span><span class='va'>state</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
    <span class='va'>dy</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='va'>state</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
    
    <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>dx</span>,<span class='va'>dy</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>a_val</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>2</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>simpleLinear_flowField</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/phaseR/man/flowField.html'>flowField</a></span><span class='op'>(</span><span class='va'>simple_linear</span>,
                                       xlim       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>,
                                       ylim       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>,
                                       parameters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='va'>a_val</span><span class='op'>)</span>,
                                       points     <span class='op'>=</span> <span class='fl'>19</span>,
                                       add <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/system_pp_a-1.png" width="624" /></p>
</div>
<p>Let’s add some solution curves:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>simpleLinear_flowField</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/phaseR/man/flowField.html'>flowField</a></span><span class='op'>(</span><span class='va'>simple_linear</span>,
                                       xlim       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>,
                                       ylim       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>,
                                       parameters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='va'>a_val</span><span class='op'>)</span>,
                                       points     <span class='op'>=</span> <span class='fl'>19</span>,
                                       add <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>state</span>                        <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>2</span>,<span class='fl'>0</span>,<span class='op'>-</span><span class='fl'>2</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,
                                    <span class='fl'>8</span>, <span class='fl'>2</span>, byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>simpleLinear_trajectory</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/phaseR/man/trajectory.html'>trajectory</a></span><span class='op'>(</span><span class='va'>simple_linear</span>,
                                        y0         <span class='op'>=</span> <span class='va'>state</span>,
                                        tlim       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>10</span><span class='op'>)</span>,
                                        parameters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='va'>a_val</span><span class='op'>)</span>,add<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/system_pp_b-1.png" width="624" /></p>
</div>
<p>Let’s plot the numerical solutions as a function of time for specific
initial conditions:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>state</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fl'>1</span>,y<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>times</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>10</span>,by<span class='op'>=</span><span class='fl'>0.05</span><span class='op'>)</span>
<span class='va'>simple_linear_sol</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/deSolve/man/ode.html'>ode</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>state</span>,times<span class='op'>=</span><span class='va'>times</span>,func<span class='op'>=</span><span class='va'>simple_linear</span>,parms<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='va'>a_val</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simple_linear_sol</span>,col<span class='op'>=</span><span class='st'>"blue"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/linear_system_sol-1.png" width="624" /></p>
</div>
<h4 id="two-dimensional-non-linear-autonomous-systems">Two-dimensional
Non-Linear Autonomous Systems</h4>
<p>Generally, a two-dimensional autonomous system has the form</p>
<p><span class="math display">\[
\begin{align*}
\frac{dx}{dt} &amp;= f(x,y) \\
\frac{dy}{dt} &amp;= g(x,y),
\end{align*}
\]</span> Such as system is sometimes called a vector field.</p>
<p>Let’s adapt our code to examine some phase portraits for a nonlinear
system.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>non_linear</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>state</span>,<span class='va'>parameters</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>as.list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>state</span>,<span class='va'>parameters</span><span class='op'>)</span><span class='op'>)</span>,<span class='op'>{</span>
    <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>state</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
    <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>state</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
    <span class='va'>dx</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='va'>x</span> <span class='op'>+</span> <span class='va'>x</span><span class='op'>^</span><span class='fl'>3</span>
    <span class='va'>dy</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>y</span>
    
    <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>dx</span>,<span class='va'>dy</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>First we plot the vector field:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>nonLinear_flowField</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/phaseR/man/flowField.html'>flowField</a></span><span class='op'>(</span><span class='va'>non_linear</span>,
                                       xlim       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>,
                                       ylim       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>,
                                       parameters <span class='op'>=</span> <span class='cn'>NULL</span>,
                                       points     <span class='op'>=</span> <span class='fl'>19</span>,
                                       add <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/nonlinear_pp_b-1.png" width="624" /></p>
</div>
<p>Now we can obtain a more detailed picture of the phase portrait:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>nonLinear_flowField</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/phaseR/man/flowField.html'>flowField</a></span><span class='op'>(</span><span class='va'>non_linear</span>,
                                       xlim       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>,
                                       ylim       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>,
                                       parameters <span class='op'>=</span> <span class='cn'>NULL</span>,
                                       points     <span class='op'>=</span> <span class='fl'>19</span>,
                                       add <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>nonLinear_nullclines</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/phaseR/man/nullclines.html'>nullclines</a></span><span class='op'>(</span><span class='va'>non_linear</span>,
                                        xlim       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>,
                                        ylim       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span>,
                                        parameters <span class='op'>=</span> <span class='cn'>NULL</span>,
                                        points     <span class='op'>=</span> <span class='fl'>500</span><span class='op'>)</span>
<span class='va'>state</span>                        <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.5</span>,<span class='fl'>1</span>,<span class='fl'>1.5</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>1.5</span>,<span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>1.5</span>,<span class='op'>-</span><span class='fl'>1</span>,
                                         <span class='op'>-</span><span class='fl'>0.5</span>,<span class='fl'>1</span>,<span class='fl'>0.5</span>,<span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>0.5</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>0.5</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span>,
                                    <span class='fl'>11</span>, <span class='fl'>2</span>, byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>nonLinear_trajectory</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/phaseR/man/trajectory.html'>trajectory</a></span><span class='op'>(</span><span class='va'>non_linear</span>,
                                        y0         <span class='op'>=</span> <span class='va'>state</span>,
                                        tlim       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>10</span><span class='op'>)</span>,
                                        parameters <span class='op'>=</span> <span class='cn'>NULL</span>,add<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/nonlinear_pp_c-1.png" width="624" /></p>
</div>
<p>Observe that steady-states occur where nullclines intersect.</p>
<p>Let’s look at the solution curves <span
class="math inline">\(x(t)\)</span> and <span
class="math inline">\(y(t)\)</span>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>state</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='op'>-</span><span class='fl'>0.5</span>,y<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>times</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>10</span>,by<span class='op'>=</span><span class='fl'>0.05</span><span class='op'>)</span>
<span class='va'>non_linear_sol</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/deSolve/man/ode.html'>ode</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>state</span>,times<span class='op'>=</span><span class='va'>times</span>,func<span class='op'>=</span><span class='va'>non_linear</span>,parms<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>non_linear_sol</span>,col<span class='op'>=</span><span class='st'>"blue"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="r_for_biomath_files/figure-html5/nonlinear_pp_d-1.png" width="624" /></p>
</div>
<p>You can learn more about the functionality of <code>phaseR</code> by
reading <a
href="https://www.rdocumentation.org/packages/phaseR/versions/2.1.3">this
page</a> or <a
href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.660.3048&amp;rep=rep1&amp;type=pdf">this
article</a>.</p>
<h1 id="conclusion">Conclusion</h1>
<p>We have very briefly touched on the basics of R that is useful in
<em>Topics in Biomathematics</em>. If there are specific topics that
interest you or there is a specific type of problem you want to try to
use R to solve, we recommend searching the web as there is a plethora of
tutorials, documentation, and helpful discussions to be found
online.</p>
<div class="sourceCode" id="cb68"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent"
role="doc-bibliography">
<div id="ref-soetaertSolvingDEsR2012" class="csl-entry"
role="doc-biblioentry">
Soetaert, Karline, Jeff Cash, and Francesca Mazzia. 2012. <em>Solving
Differential Equations in <span>R</span></em>. Use r! Springer, New
York. <a
href="https://doi.org/10.1007/978-3-642-28070-2">https://doi.org/10.1007/978-3-642-28070-2</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
